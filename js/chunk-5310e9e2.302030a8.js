(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5310e9e2"],{3896:function(e,t,a){"use strict";var l=a("a28b"),s=a.n(l);s.a},a28b:function(e,t,a){},d56e:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contract-template"},["main"==e.showType?a("div",{staticClass:"main"},[a("div",{staticClass:"search-list"},[a("el-row",[a("el-col",{attrs:{span:5}},[a("el-col",{attrs:{span:6}},[e._v("合同名称")]),a("el-col",{attrs:{span:18}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入合同名称",clearable:""},model:{value:e.sSearchTemplateName,callback:function(t){e.sSearchTemplateName=t},expression:"sSearchTemplateName"}})],1)],1),a("el-col",{staticClass:"disp-right pr-10",attrs:{span:19}},["-1"!=e.$authority.indexOf("ctSearch")?a("el-button",{staticClass:"el-button el-button--primary",on:{click:e.searchTemplateData}},[e._v("查询")]):e._e(),"-1"!=e.$authority.indexOf("insertCt")?a("el-button",{staticClass:"el-button el-button--primary",on:{click:e.addTemplateSub}},[e._v("添加合同模板")]):e._e()],1)],1)],1),a("div",{staticClass:"content-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"cell-click":e.getRowDatas}},[a("el-table-column",{attrs:{type:"index",align:"center",label:"序号",width:"80"}}),a("el-table-column",{attrs:{prop:"templateName",align:"center",label:"合同名称"}}),a("el-table-column",{attrs:{prop:"orgNames",align:"center",label:"关联项目"}}),a("el-table-column",{attrs:{prop:"creatorName",align:"center",label:"添加人"}}),a("el-table-column",{attrs:{prop:"createTime",align:"center",label:"添加时间"}}),a("el-table-column",{attrs:{prop:"address",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return["-1"!=e.$authority.indexOf("editCt")?a("span",{staticClass:"greenFont tabOperteBtn"},[e._v("修改")]):e._e()]}}],null,!1,2190436701)})],1)],1)]):e._e(),"addedit"==e.showType?a("div",{staticClass:"insert-temp"},[a("div",{staticClass:"eidtor-box"},[a("el-row",{}),a("div",{staticClass:"title"},[e._v("添加模板/编辑模板")]),a("Edio",{ref:"editor",staticStyle:{"background-color":"#fff"},attrs:{getValue:e.sTemplateMsg}}),a("div",{staticClass:"project-list"},[a("el-row",[a("el-col",{staticClass:"ri-10 is-required-a",staticStyle:{"text-align":"center"},attrs:{span:1}},[e._v("项 目")]),a("el-col",{attrs:{span:4}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.value5,callback:function(t){e.value5=t},expression:"value5"}},e._l(e.project,function(e){return a("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1),a("el-col",{staticClass:"ri-10 is-required-a",staticStyle:{"text-align":"center","margin-left":"30px"},attrs:{span:1}},[e._v("模板名称")]),a("el-col",{attrs:{span:4}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入合同名称",clearable:""},model:{value:e.sSearchTemplateName,callback:function(t){e.sSearchTemplateName=t},expression:"sSearchTemplateName"}})],1)],1)],1),a("div",{staticClass:"deep-bottom-box"},[a("el-button",{attrs:{type:"primary"},on:{click:e.tsTemplateData}},[e._v("暂 存")]),a("el-button",{attrs:{type:"primary"},on:{click:e.clickAddTemplate}},[e._v("添 加")]),a("el-button",{staticClass:"greenBtn",on:{click:e.leaveFromEdit}},[e._v("取 消")])],1)],1)]):e._e(),"edit"==e.showType?a("div",{staticClass:"insert-temp"},[a("div",{staticClass:"eidtor-box"},[a("el-row",{}),a("div",{staticClass:"title"},[e._v("添加模板/编辑模板")]),a("Edio",{ref:"editor",staticStyle:{"background-color":"#fff"},attrs:{getValue:e.sTemplateMsg}}),a("div",{staticClass:"project-list"},[a("el-row",[a("el-col",{staticClass:"ri-10 is-required-a",staticStyle:{"text-align":"center","margin-left":"30px"},attrs:{span:1}},[e._v("项目")]),a("el-col",{attrs:{span:4}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.value5,callback:function(t){e.value5=t},expression:"value5"}},e._l(e.project,function(e){return a("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1),a("el-col",{staticClass:"ri-10 is-required-a",staticStyle:{"text-align":"center"},attrs:{span:1}},[e._v("模板名称")]),a("el-col",{attrs:{span:4}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入合同名称",clearable:""},model:{value:e.sSearchTemplateName,callback:function(t){e.sSearchTemplateName=t},expression:"sSearchTemplateName"}})],1)],1)],1),a("div",{staticClass:"deep-bottom-box"},[a("el-button",{attrs:{type:"primary"},on:{click:e.present}},[e._v("提 交")]),a("el-button",{staticClass:"greenBtn",on:{click:e.leaveFromEdit}},[e._v("取 消")])],1)],1)]):e._e(),"main"==e.showType?a("div",{staticClass:"el-page"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,40,50],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()])},s=[],r=a("37b8"),i=a("3f88"),o=a("90b9"),n=a("729c"),c=a("591a"),d={name:"contract-template",components:{Edio:r["a"],myEditor:i["a"],"v-editor":r["a"]},data(){return{sCompactName:"",options:[{value:"选项1",label:"黄金糕"},{value:"选项2",label:"双皮奶"}],sSearchTemplateName:"",value:"",value5:[],tableData:[],currentPage:1,showType:"main",sTemplateMsg:"",myConfig:{autoHeightEnabled:!1,initialFrameHeight:480,initialFrameWidth:"100%",serverUrl:"http://35.201.165.105:8000/controller.php",UEDITOR_HOME_URL:"UEditor/"},editorInstanceKey:"",RowData:"",bs:"",pageSize:10,total:0}},created(){this.init()},computed:{...Object(c["b"])({project:"getPeojectList"})},mounted(){},methods:{tsTemplateData(){try{let t=this,a={templateContent:t.$refs.editor.editorVal,orgIds:t.value5,templateName:Object(o["m"])(t.sSearchTemplateName)};a=JSON.stringify(a),window.localStorage["tempateStore"]=a,location.reload()}catch(e){console.log(e)}},addTemplateSub(){try{let t=window.localStorage["tempateStore"],a=this;if(t){let e=JSON.parse(t);a.value5=e.orgIds,a.sTemplateMsg=e.templateContent,a.sSearchTemplateName=e.templateName,a.$nextTick(function(){a.$refs.editor.editorinit(a.$refs.editor.$refs.editor)})}this.showType="addedit",a.$nextTick(function(){a.$refs.editor.editorinit(a.$refs.editor.$refs.editor)})}catch(e){console.log(e)}},addTemplateJudge(){let e=this;return e.$refs.editor.editorVal?e.sSearchTemplateName?!(e.value5.length<=0)||(e.$message({message:"项 目不能为空",type:"warning"}),!1):(e.$message({message:"模板内容名称不能为空",type:"warning"}),!1):(e.$message({message:"模板内容不能为空",type:"warning"}),!1)},clickAddTemplate(){try{let t=this;if(!t.addTemplateJudge())return;let a={templateContent:t.$refs.editor.editorVal||"",templateName:t.sSearchTemplateName,orgIds:t.value5};Object(n["j"])(a).then(e=>{if(0===e.data.errorCode){let t=window.localStorage["tempateStore"];t&&window.localStorage.removeItem("tempateStore"),this.$message({message:e.data.message,type:"success"}),location.reload()}})}catch(e){console.log(e)}},Alertedit(){try{let t=this,a={templateId:t.RowData.contractTemplateId};Object(n["t"])(a).then(e=>{let a=JSON.parse(JSON.stringify(e.data.data));t.value5=[],t.sSearchTemplateName=a.templateName,t.sTemplateMsg=a.templateContent,t.editorInstanceKey=a.contractTemplateId,a.orgList.forEach(e=>{t.value5.push(e.orgId)})}).then(()=>{t.showType="edit",t.$nextTick(function(){t.$refs.editor.editorinit(t.$refs.editor.$refs.editor)})})}catch(e){console.log(e)}},getRowDatas(e,t,a,l){this.RowData=e,"修改"==l.target.innerHTML&&this.Alertedit()},present(){try{let t=this;if(!t.addTemplateJudge())return;let a=JSON.parse(JSON.stringify(t.value5)),l={templateContent:t.$refs.editor.editorVal||"",templateName:t.sSearchTemplateName,orgIds:a,contractTemplateId:t.editorInstanceKey};Object(n["Pb"])(l).then(e=>{e.data.result&&this.$message({message:e.data.message,type:"success"})}).then(()=>{location.reload()})}catch(e){console.log(e)}},ready(e){"add"==this.bs&&(this.editorInstanceKey=e.key),console.log(`编辑器实例${e.key}: `,e)},searchTemplateData(){this.getPages()},getPages(){let e={templateName:Object(o["m"])(this.sSearchTemplateName),currentPage:this.currentPage,pageSize:this.pageSize};Object(n["ib"])(e).then(e=>{this.tableData=JSON.parse(JSON.stringify(e.data.data.content)),this.total=e.data.data.total}).catch(e=>{console.log(e)})},getProjects(){this.$store.state.projectList.length<=0&&Object(n["mb"])().then(e=>{e.data.result&&this.$store.commit("setProject",e.data.data)})},init(){this.getPages(),this.getProjects()},handleSizeChange(e){this.pageSize=e,this.getPages(),console.log(`每页 ${e} 条`)},handleCurrentChange(e){this.currentPage=e,this.getPages(),console.log(`当前页: ${e}`)},leaveFromEdit(){location.reload()}}},p=d,m=(a("3896"),a("6691")),g=Object(m["a"])(p,l,s,!1,null,null,null);t["default"]=g.exports}}]);
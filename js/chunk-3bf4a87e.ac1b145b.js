(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3bf4a87e"],{"0b8b":function(e,t,o){},2490:function(e,t,o){},"43bf":function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"originList"},[o("el-input",{attrs:{readonly:""},nativeOn:{click:function(t){return e.changeShowMode(t)}},model:{value:e.inputVal,callback:function(t){e.inputVal=t},expression:"inputVal"}}),o("transition",{attrs:{name:"el-zoom-in-top"}},[e.isShow?o("div",{staticClass:"show-tree"},[o("div",{staticClass:"origin-list-content"},[e._l(e.roomOriginList,function(t,i){return o("div",{key:i},[o("el-checkbox",{model:{value:t.isChecked,callback:function(o){e.$set(t,"isChecked",o)},expression:"item.isChecked"}},[e._v(" "+e._s(t.info))])],1)}),0==e.roomOriginList.length?o("div",{staticStyle:{"text-align":"center"}},[e._v("\n            暂无数据\n        ")]):e._e()],2),o("div",{staticClass:"deep-content"},[o("el-button",{staticClass:"greenBtn",attrs:{size:"small"},on:{click:e.cancelChoiceOrigin}},[e._v("取消")]),o("el-button",{staticClass:"el-button el-button--primary",attrs:{size:"small"},on:{click:e.comfirmChoiceOrigin}},[e._v("确定")])],1)]):e._e()])],1)},a=[],s={name:"originList",data(){return{inputVal:"",isShow:!1,roomOriginList:[]}},props:[],created(){this.getRoomOriginList()},watch:{},methods:{changeShowMode(){this.isShow=!this.isShow},getRoomOriginList(){this.$http.get("/api/daily/order/public/findSourceTypies").then(e=>{var t=e.data;if(0==t.errorCode){for(var o=t.data||[],i=0;i<o.length;i++)o[i].isChecked=!1;this.roomOriginList=o}}).catch(function(e){console.log(e)})},comfirmChoiceOrigin(){for(var e=[],t=0;t<this.roomOriginList.length;t++)this.roomOriginList[t].isChecked&&e.push(this.roomOriginList[t].info);e.length==this.roomOriginList.length&&this.roomOriginList.length>0?this.inputVal="全部渠道来源":e.length>0?this.inputVal=e.join(","):this.inputVal="",this.isShow=!1},cancelChoiceOrigin(){for(var e=0;e<this.roomOriginList.length;e++)this.roomOriginList[e].isChecked=!1;this.inputVal="",this.isShow=!1}}},r=s,n=(o("fffe"),o("6691")),l=Object(n["a"])(r,i,a,!1,null,null,null);t["a"]=l.exports},8339:function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"orderList"},[o("div",{staticClass:"search-list"},[o("el-row",[o("el-col",{attrs:{span:24}},[o("el-col",{attrs:{span:6}},[o("el-col",{staticClass:"tr-10",attrs:{span:6}},[e._v("\n                        项目\n                    ")]),o("el-col",{attrs:{span:14}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.searchOrderListTable},model:{value:e.orderSearchInfo.projectId,callback:function(t){e.$set(e.orderSearchInfo,"projectId",t)},expression:"orderSearchInfo.projectId"}},e._l(e.projectList,function(e){return o("el-option",{key:e.dailyRentalId,attrs:{label:e.name,value:e.dailyRentalId}})}),1)],1)],1),o("el-col",{attrs:{span:5}},[o("el-col",{staticClass:"tr-10",attrs:{span:5}},[e._v("\n                        房型\n                    ")]),o("el-col",{attrs:{span:16}},[o("room-type",{ref:"roomType",attrs:{getRoomId:e.orderSearchInfo.projectId}})],1)],1),o("el-col",{attrs:{span:5}},[o("el-col",{staticClass:"tr-10",attrs:{span:6}},[e._v("\n                        渠道来源\n                    ")]),o("el-col",{attrs:{span:15}},[o("origin-list",{ref:"originList"})],1)],1),o("el-col",{attrs:{span:4}},[o("el-col",{staticClass:"tr-10",attrs:{span:8}},[e._v("\n                        订单状态\n                    ")]),o("el-col",{attrs:{span:14}},[o("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.orderSearchInfo.orderStatus,callback:function(t){e.$set(e.orderSearchInfo,"orderStatus",t)},expression:"orderSearchInfo.orderStatus"}},e._l(e.orderStatusList,function(e){return o("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1)],1),o("el-col",{attrs:{span:4}},[o("el-col",{staticClass:"tr-10",attrs:{span:8}},[e._v("\n                        支付状态\n                    ")]),o("el-col",{attrs:{span:14}},[o("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.orderSearchInfo.payStatus,callback:function(t){e.$set(e.orderSearchInfo,"payStatus",t)},expression:"orderSearchInfo.payStatus"}},e._l(e.payStatusList,function(e){return o("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1)],1)],1),o("el-col",{attrs:{span:24}},[o("el-col",{attrs:{span:6}},[o("el-col",{staticClass:"tr-10",attrs:{span:6}},[o("el-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.orderSearchInfo.timeType,callback:function(t){e.$set(e.orderSearchInfo,"timeType",t)},expression:"orderSearchInfo.timeType"}},e._l(e.searchTimeTypeList,function(e){return o("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),o("el-col",{attrs:{span:14}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},model:{value:e.orderSearchInfo.orderData,callback:function(t){e.$set(e.orderSearchInfo,"orderData",t)},expression:"orderSearchInfo.orderData"}})],1)],1),o("el-col",{attrs:{span:5}},[o("el-col",{staticClass:"tr-10",staticStyle:{height:"60px",overflow:"hidden"},attrs:{span:5}},[e._v("\n                        客户信息\n                    ")]),o("el-col",{attrs:{span:16}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入姓名、电话、房间号",clearable:""},model:{value:e.orderSearchInfo.personInfo,callback:function(t){e.$set(e.orderSearchInfo,"personInfo",t)},expression:"orderSearchInfo.personInfo"}})],1)],1),o("el-col",{attrs:{span:5}},[o("el-col",{staticClass:"tr-10",staticStyle:{height:"60px",overflow:"hidden"},attrs:{span:6}},[e._v("\n                        订单编号\n                    ")]),o("el-col",{attrs:{span:15}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入订单编号",clearable:""},model:{value:e.orderSearchInfo.orderNo,callback:function(t){e.$set(e.orderSearchInfo,"orderNo",t)},expression:"orderSearchInfo.orderNo"}})],1)],1),o("el-col",{attrs:{span:4,offset:4}},[o("el-col",{staticClass:"disp-right",attrs:{span:22}},[o("el-button",{staticClass:"el-button el-button--primary",on:{click:e.searchOrderListTable}},[e._v("查询")]),o("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("orderManageExport"),expression:"$authority.indexOf('orderManageExport') != '-1'"}],staticClass:"greenBtn",on:{click:e.exportOrderListTable}},[e._v("导出")])],1)],1)],1)],1)],1),o("div",{staticClass:"content-table"},[o("div",{staticClass:"table-info"},[e._v("\n        共找到"),o("span",{domProps:{innerHTML:e._s(e.total)}}),e._v("个记录，"),o("span",{domProps:{innerHTML:e._s(e.cancelNum)}}),e._v("个已取消\n      ")]),o("el-table",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("orderManageTable"),expression:"$authority.indexOf('orderManageTable') != '-1'"}],staticStyle:{width:"100%"},attrs:{data:e.orderListTable,border:""}},[o("el-table-column",{attrs:{prop:"first.name",align:"center",label:"客户姓名"}}),o("el-table-column",{attrs:{prop:"first.tel",align:"center",label:"电话"}}),o("el-table-column",{attrs:{prop:"orderNo",align:"center",label:"订单编号"}}),o("el-table-column",{attrs:{prop:"dailyRoomName",align:"center",label:"房间号"}}),o("el-table-column",{attrs:{prop:"dailyOrderSourceName",align:"center",label:"订单来源"}}),o("el-table-column",{attrs:{prop:"dailyRoomTypeName",align:"center",label:"房型"}}),o("el-table-column",{attrs:{prop:"orderTime",align:"center",label:"下单时间"}}),o("el-table-column",{attrs:{prop:"visitTime",align:"center",width:"190",label:"入离时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[t.row&&t.row.startDate?o("span",[e._v(e._s(t.row.startDate))]):e._e(),e._v(" 至 "),t.row&&t.row.endDate?o("span",[e._v(e._s(t.row.endDate))]):e._e()])]}}])}),o("el-table-column",{attrs:{prop:"orderAmount",align:"center",label:"订单金额"}}),o("el-table-column",{attrs:{prop:"orderStatus.text",align:"center",label:"订单状态"}}),o("el-table-column",{attrs:{prop:"orderPayStatus.text",align:"center",label:"支付状态"}}),o("el-table-column",{attrs:{prop:"orderClosedInfo",align:"center",label:"取消原因"}}),o("el-table-column",{attrs:{prop:"operator",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("orderManageRoomOrderDetail"),expression:"$authority.indexOf('orderManageRoomOrderDetail') != '-1'"}],staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.enterOrderDetail(t.row)}}},[e._v("查看")])]}}])})],1)],1),e.dialogRoomDetail?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"查看详情",visible:e.dialogRoomDetail,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"980px","before-close":function(){return e.dialogRoomDetail=!1}},on:{"update:visible":function(t){e.dialogRoomDetail=t}}},[o("div",{staticClass:"room-puple-detail"},[o("div",{staticClass:"title-font"},[e._v("住宿")]),e._l(e.orderPersonList,function(t,i){return o("div",{key:i,staticClass:"person-info"},[o("el-row",[o("el-col",{attrs:{span:12}},[t.roomStatus&&2==t.roomStatus.val?o("span",{staticClass:"order-status no-living"},[e._v("未入住")]):t.roomStatus&&3==t.roomStatus.val?o("span",{staticClass:"order-status had-leave"},[e._v("已入住")]):t.roomStatus&&4==t.roomStatus.val?o("span",{staticClass:"order-status leave-building"},[e._v("已离店")]):e._e(),e._v("\n                        "+e._s(t.first.name||"-")+" "),t.roomStatus&&1!=t.roomStatus.val?o("span",{staticClass:"send-message",on:{click:function(o){return e.sendRoomInfoMessage(i,t.roomStatus.val)}}},[e._v("发送短信")]):e._e()]),1==t.roomStatus.val?o("el-col",{attrs:{span:12}},[e._v(e._s(t.dailyRoomTypeName||"-"))]):o("el-col",{attrs:{span:12}},[e._v(e._s(t.dailyRoomName||"-")+" ("+e._s(t.dailyRoomTypeName||"-")+")")])],1),o("el-row",[1==t.roomStatus.val?o("el-col",{attrs:{span:12}},[e._v("手机号："+e._s(t.first.tel||"-"))]):o("el-col",{attrs:{span:12}},[e._v("身份证："+e._s(t.first.cardNo||"-"))]),o("el-col",{attrs:{span:12}},[e._v(e._s(t.startDate||"-")+"入住 - "+e._s(t.endDate||"-")+"离店，共"+e._s(t.nights||"0")+"晚")])],1),o("el-row",["1"==e.orderRoomDetail.personStatus.val||"2"==e.orderRoomDetail.personStatus.val?o("el-col",{attrs:{span:20}},[e._v("保留时间："+e._s(t.retentionTime||"-"))]):e._e(),o("el-col",{attrs:{span:"1"==e.orderRoomDetail.personStatus.val||"2"==e.orderRoomDetail.personStatus.val?4:24}},[e._v("房费合计：￥"),o("span",{staticClass:"green"},[e._v(e._s(t.roomAmount||"0"))])])],1)],1)}),o("div",{staticClass:"title-font"},[e._v("订单")]),o("div",{staticClass:"person-info"},[o("el-row",[o("el-col",{attrs:{span:12}},[o("span",{staticClass:"order-status",class:{"waiting-separate":"待分房"==e.orderRoomDetail.roomStatus.text||"已分房"==e.orderRoomDetail.roomStatus.text,"leave-building":"已离店"==e.orderRoomDetail.roomStatus.text||"已取消"==e.orderRoomDetail.roomStatus.text||"已退房"==e.orderRoomDetail.roomStatus.text}},[e._v(e._s(e.orderRoomDetail.roomStatus.text))]),e._v("\n                      订单号："+e._s(e.orderRoomDetail.orderNo||"-")+"\n                    ")]),o("el-col",{attrs:{span:12}},[e._v("渠道来源："+e._s(e.orderRoomDetail.dailyOrderSourceName||"-"))])],1)],1),o("div",{staticClass:"title-font"},[e._v("收支信息")]),o("div",{staticClass:"person-info"},[o("el-row",[o("el-col",{attrs:{span:8}},[e._v("订单金额：￥"),o("span",[e._v(e._s(e.orderRoomDetail.orderTotalMoney||"0"))]),e._v("（房费"),o("span",[e._v(e._s(e.orderRoomDetail.roomTotalPrice||"0"))]),e._v("）")]),o("el-col",{attrs:{span:4}},[e._v("押金: ￥"+e._s(e.orderRoomDetail.roomDepositMoney||"0"))]),o("el-col",{attrs:{span:5}},[e._v("已收款: ￥"+e._s(e.orderRoomDetail.receiveMoney||"0"))]),o("el-col",{staticClass:"green",attrs:{span:4}},[e._v(e._s(e.orderRoomDetail.needMoney>=0?"需补交":"需退回")+"：￥"+e._s(Math.abs(e.orderRoomDetail.needMoney||0)))]),"1"!=e.orderRoomDetail.personStatus.val?o("el-col",{staticClass:"green",staticStyle:{"text-align":"right",cursor:"pointer"},attrs:{span:3},nativeOn:{click:function(t){return e.insertAddtionPay("detailRoom")}}},[o("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加款项")]):e._e()],1)],1),e.orderRoomDetail.showAddtionPay?o("div",{staticClass:"person-info",staticStyle:{"margin-top":"6px"}},[o("el-row",[o("el-col",{attrs:{span:3==e.orderRoomDetail.incomeMoneyType?3:4}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"费用类型",size:"small"},on:{change:function(t){return e.changeIncomeFeeVal("detailRoom")}},model:{value:e.orderRoomDetail.incomeMoneyType,callback:function(t){e.$set(e.orderRoomDetail,"incomeMoneyType",t)},expression:"orderRoomDetail.incomeMoneyType"}},e._l(e.incomeFeeTypeList,function(e){return o("el-option",{key:e.feeTypeId,attrs:{label:e.feeTypeName,value:e.feeTypeId}})}),1)],1),3==e.orderRoomDetail.incomeMoneyType?o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"其它费用",size:"small"},model:{value:e.orderRoomDetail.incomeAddtionMoneyType,callback:function(t){e.$set(e.orderRoomDetail,"incomeAddtionMoneyType",t)},expression:"orderRoomDetail.incomeAddtionMoneyType"}},e._l(e.incomeAddtionFeeList,function(e){return o("el-option",{key:e.detailFeeTypeId,attrs:{label:e.feeName,value:e.detailFeeTypeId}})}),1)],1):e._e(),o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"收/支",size:"small"},on:{change:function(t){return e.changeIncomePayType("detailRoom")}},model:{value:e.orderRoomDetail.incomeReceiveType,callback:function(t){e.$set(e.orderRoomDetail,"incomeReceiveType",t)},expression:"orderRoomDetail.incomeReceiveType"}},e._l(e.incomeOrPayList,function(e){return o("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),o("el-col",{attrs:{span:3==e.orderRoomDetail.incomeMoneyType?3:4}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(t){return e.getMoneyDayList("detailRoom")}},model:{value:e.orderRoomDetail.incomeChoiceRoom,callback:function(t){e.$set(e.orderRoomDetail,"incomeChoiceRoom",t)},expression:"orderRoomDetail.incomeChoiceRoom"}},e._l(e.roomLimitTypeList,function(e,t){return o("el-option",{key:t,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),o("el-col",{attrs:{span:3==e.orderRoomDetail.incomeMoneyType?4:5}},[o("el-col",{attrs:{span:1==e.orderRoomDetail.incomeMoneyType?5:7}},[e._v("金额")]),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==e.orderRoomDetail.incomeMoneyType,expression:"orderRoomDetail.incomeMoneyType == 1"}],attrs:{span:9}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"天数",size:"small"},on:{change:function(t){return e.changeMoneyDayVal("detailRoom")}},model:{value:e.orderRoomDetail.rentMoneyDay,callback:function(t){e.$set(e.orderRoomDetail,"rentMoneyDay",t)},expression:"orderRoomDetail.rentMoneyDay"}},e._l(e.moneyChoiceDayList,function(e,t){return o("el-option",{key:t,attrs:{label:e.text,value:e.val}})}),1)],1),o("el-col",{attrs:{span:1==e.orderRoomDetail.incomeMoneyType?9:15}},[o("el-input-number",{staticStyle:{width:"100%"},attrs:{disabled:1==e.orderRoomDetail.incomeMoneyType&&!e.orderRoomDetail.moneyCanEidt,controls:!1,min:0,size:"small"},model:{value:e.orderRoomDetail.incomeMoney,callback:function(t){e.$set(e.orderRoomDetail,"incomeMoney",t)},expression:"orderRoomDetail.incomeMoney"}})],1)],1),o("el-col",{attrs:{span:e.orderRoomDetail.showPayNo?3:4}},[o("el-col",{attrs:{span:22}},[o("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.orderRoomDetail.showPayType,placeholder:"支付方式",size:"small"},on:{change:function(t){return e.changeAddtionPayType("orderDetail")}},model:{value:e.orderRoomDetail.incomePayType,callback:function(t){e.$set(e.orderRoomDetail,"incomePayType",t)},expression:"orderRoomDetail.incomePayType"}},e._l(e.incomePayTypeList,function(e){return o("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),o("el-col",{attrs:{span:e.orderRoomDetail.showPayNo?5:4}},[e.orderRoomDetail.showPayNo&&e.orderRoomDetail.showPayType?o("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogSettleAccounts}},[e._v("单号 \n                        "),!e.dialogReserveSettleAccounts&&e.settleAccount.newVal.length>0?o("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]):e._e(),o("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogReserveLabel}},[e._v("备注 \n                        "),!e.dialogReserveLabel&&e.reserveLabel.isInsert&&e.reserveLabel.newVal.length>0?o("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.saveOrderIncome("orderDetail")}}},[e._v("保存")])],1)],1)],1):e._e(),o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderReserveTable,border:""}},[o("el-table-column",{attrs:{prop:"moneyTypeName",align:"center",label:"费用类型"}}),o("el-table-column",{attrs:{prop:"incomeName",align:"center",label:"收/支"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.income?o("span",{staticStyle:{color:"#24b0fc"}},[e._v("+"+e._s(t.row.money)+e._s(t.row.incomeName||"-"))]):o("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(t.row.money)+e._s(t.row.incomeName||"-"))])]}}],null,!1,18178844)}),o("el-table-column",{attrs:{prop:"payTypeName",align:"center",label:"支付方式"}}),o("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房间"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.roomName))]),o("span",[e._v(e._s(t.row.roomDailyTypeName))])]}}],null,!1,3653808405)}),o("el-table-column",{attrs:{prop:"operatorTime",align:"center",label:"操作时间"}}),o("el-table-column",{attrs:{prop:"payNo",align:"center",label:"挂账单号"}}),o("el-table-column",{attrs:{prop:"operatorName",align:"center",label:"操作人"}}),o("el-table-column",{attrs:{prop:"operate",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.income?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.deleteOrderRoom(t.row)}}},[e._v("删除")]):e._e(),1==t.row.income?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.getReceiveMoney(t.row)}}},[e._v("收款")]):e._e(),2==t.row.income&&t.row.refundAmount&&t.row.refundAmount>0?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.getBackMoney(t.row)}}},[e._v("退款")]):e._e(),o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.showTableReserveLabel(t.row,"orderDetail")}}},[e._v("备注")])]}}],null,!1,3348484841)})],1)],1),o("div",{staticClass:"mt-10"},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"订单备注..."},model:{value:e.orderRoomDetail.label,callback:function(t){e.$set(e.orderRoomDetail,"label",t)},expression:"orderRoomDetail.label"}})],1)],2),o("span",{staticClass:"room-info-footer mt-10",attrs:{slot:"footer"},slot:"footer"},[o("span",["1"==e.orderRoomDetail.personStatus.val?o("span",{staticStyle:{"padding-right":"10px"}},[o("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("orderManageCancel"),expression:"$authority.indexOf('orderManageCancel') != '-1'"}],attrs:{type:"primary"},on:{click:e.cancelRoomOrder}},[e._v("取消订单")]),o("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("orderManageDistributeRoom"),expression:"$authority.indexOf('orderManageDistributeRoom') != '-1'"}],attrs:{type:"primary"},on:{click:e.enterDistributeRoom}},[e._v("立即分房")])],1):e._e(),"2"!=e.orderRoomDetail.personStatus.val||e.orderRoomDetail.personStatus.hasBigger?e._e():o("span",{staticStyle:{"padding-right":"10px"}},[o("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("orderManageCancelRoom"),expression:"$authority.indexOf('orderManageCancelRoom') != '-1'"}],attrs:{type:"primary"},on:{click:function(t){e.dialogCancelDistribute=!0}}},[e._v("取消分房")]),o("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("orderManageCancel"),expression:"$authority.indexOf('orderManageCancel') != '-1'"}],attrs:{type:"primary"},on:{click:e.cancelRoomOrder}},[e._v("取消订单")])],1),"2"==e.orderRoomDetail.personStatus.val||"3"==e.orderRoomDetail.personStatus.val?o("span",[o("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("orderManageRoomOrderEdit"),expression:"$authority.indexOf('orderManageRoomOrderEdit') != '-1'"}],attrs:{type:"primary"},on:{click:e.editRoomOrder}},[e._v("修改订单")])],1):e._e()]),o("span",["2"==e.orderRoomDetail.personStatus.val&&"-1"!=e.$authority.indexOf("orderManageRoomLiveIn")?o("el-button",{attrs:{type:"primary"},on:{click:e.enterLiveRoomOrder}},[e._v("办理入住")]):e._e(),"2"==e.orderRoomDetail.personStatus.val&&e.orderRoomDetail.personStatus.hasBigger&&"-1"!=e.$authority.indexOf("orderManageRoomExitRoom")?o("el-button",{attrs:{type:"primary"},on:{click:e.exitRoomOrder}},[e._v("办理退房")]):e._e(),"3"==e.orderRoomDetail.personStatus.val&&"-1"!=e.$authority.indexOf("orderManageRoomExitRoom")?o("el-button",{attrs:{type:"primary"},on:{click:e.exitRoomOrder}},[e._v("办理退房")]):e._e()],1)])])],1):e._e(),e.dialogCancelDistribute?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"取消分房",visible:e.dialogCancelDistribute,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"460px","before-close":function(){return e.dialogCancelDistribute=!1}},on:{"update:visible":function(t){e.dialogCancelDistribute=t}}},[o("div",{staticClass:"room-puple-detail"},[o("p",[e._v("\n                  确定取消分房吗？\n                ")]),o("p",[e._v("\n                  取消分房的订单，在“订单-待分房”列表中，并支持重新分房\n                ")]),o("div",{staticClass:"right-space-btn"},[o("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitCancelDistribute}},[e._v("确定")])],1)])])],1):e._e(),e.dialogCancelOrder?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"取消订单",visible:e.dialogCancelOrder,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"660px","before-close":function(){return e.dialogCancelOrder=!1}},on:{"update:visible":function(t){e.dialogCancelOrder=t}}},[o("div",{staticClass:"room-puple-detail"},[o("p",{staticStyle:{"text-align":"center"}},[e._v("\n                  该订单已收款"),o("span",{staticStyle:{color:"#ff0000"}},[e._v("￥"+e._s(e.orderRoomDetail.receiveMoney||"0"))]),e._v("，是否确认取消订单？\n                ")]),o("div",[o("el-row",[o("el-col",{attrs:{span:6}},[e._v("是否需要退款：")]),o("el-col",{attrs:{span:18}},[o("el-radio",{attrs:{label:"1"},model:{value:e.cancelOrder.backMoney,callback:function(t){e.$set(e.cancelOrder,"backMoney",t)},expression:"cancelOrder.backMoney"}},[e._v("不需要")]),o("el-radio",{attrs:{label:"2"},model:{value:e.cancelOrder.backMoney,callback:function(t){e.$set(e.cancelOrder,"backMoney",t)},expression:"cancelOrder.backMoney"}},[e._v("需要")])],1)],1),2==e.cancelOrder.backMoney?o("el-row",{staticClass:"mt-10"},[o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderBackMoneyTable,border:""}},[o("el-table-column",{attrs:{prop:"moneyTypeName",align:"center",label:"费用类型"}}),o("el-table-column",{attrs:{prop:"incomeName",align:"center",label:"收/支"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.income?o("span",{staticStyle:{color:"#24b0fc"}},[e._v("+"+e._s(t.row.money)+e._s(t.row.incomeName||"-"))]):o("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(t.row.money)+e._s(t.row.incomeName||"-"))])]}}],null,!1,18178844)}),o("el-table-column",{attrs:{prop:"payTypeName",align:"center",label:"支付方式"}}),o("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房间"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.roomName))]),o("span",[e._v(e._s(t.row.roomDailyTypeName))])]}}],null,!1,3653808405)}),o("el-table-column",{attrs:{prop:"operatorTime",align:"center",label:"操作时间"}}),o("el-table-column",{attrs:{prop:"operatorName",align:"center",label:"操作人"}}),o("el-table-column",{attrs:{prop:"operate",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.income?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.deleteOrderRoom(t.row)}}},[e._v("删除")]):e._e(),1==t.row.income?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.getReceiveMoney(t.row)}}},[e._v("收款")]):e._e(),2==t.row.income&&t.row.refundAmount&&t.row.refundAmount>0?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.getBackMoney(t.row)}}},[e._v("退款")]):e._e(),o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.showTableReserveLabel(t.row,"cancelOrder")}}},[e._v("备注")])]}}],null,!1,3301775518)})],1)],1)]):e._e(),o("el-row",{staticClass:"mt-10"},[o("el-col",{attrs:{span:24}},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:5,maxRows:8},placeholder:"备注"},model:{value:e.cancelOrder.label,callback:function(t){e.$set(e.cancelOrder,"label",t)},expression:"cancelOrder.label"}})],1)],1),o("el-row",{staticClass:"mt-10"},[o("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("选择取消订单原因：")]),o("el-col",{attrs:{span:18}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择取消原因",size:"small"},model:{value:e.cancelOrder.reason,callback:function(t){e.$set(e.cancelOrder,"reason",t)},expression:"cancelOrder.reason"}},e._l(e.cancelOrderReasonList,function(e,t){return o("el-option",{key:t,attrs:{label:e.info,value:e.dailyOrderClosedId}})}),1)],1)],1)],1),o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitCancelOrder}},[e._v("确定")])],1)])])],1):e._e(),e.dialogInsertLive?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:e.roomManageInfo.manageTypeName,visible:e.dialogInsertLive,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"1100px","before-close":function(){e.roomManageInfo.manageType="",e.dialogInsertLive=!1}},on:{"update:visible":function(t){e.dialogInsertLive=t}}},[o("div",{staticClass:"room-puple-detail"},[o("div",{staticClass:"title-font"},[e._v("住客")]),o("div",{staticClass:"person-info"},[e._l(e.livePersonList,function(t,i){return o("el-row",{key:i,staticClass:"person-info-ceil"},[o("el-col",{attrs:{span:22}},[o("el-row",[o("el-col",{attrs:{span:7}},[o("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("姓名")]),o("el-col",{attrs:{span:16}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:t.persons[0].name,callback:function(o){e.$set(t.persons[0],"name",o)},expression:"item.persons[0].name"}})],1)],1),o("el-col",{attrs:{span:6}},[o("el-col",{attrs:{span:5}},[e._v("手机")]),o("el-col",{attrs:{span:17}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.persons[0].phone,callback:function(o){e.$set(t.persons[0],"phone",o)},expression:"item.persons[0].phone"}})],1)],1),o("el-col",{attrs:{span:11}},[o("el-col",{attrs:{span:10}},[o("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"证件类型",size:"small"},model:{value:t.persons[0].cardType,callback:function(o){e.$set(t.persons[0],"cardType",o)},expression:"item.persons[0].cardType"}},e._l(e.cardTypeList,function(e){return o("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),o("el-col",{attrs:{span:14}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.persons[0].cardNo,callback:function(o){e.$set(t.persons[0],"cardNo",o)},expression:"item.persons[0].cardNo"}})],1)],1)],1),o("el-row",{staticClass:"mt-10"},[o("el-col",{attrs:{span:7}},[o("el-col",{attrs:{span:6}},[e._v("入住")]),o("el-col",{attrs:{span:"立即分房"==e.roomManageInfo.manageTypeName?12:16}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",clearable:!1,size:"small","value-format":"yyyy-MM-dd"},on:{change:function(t){return e.changeReserveEnterData(i)}},model:{value:t.startData,callback:function(o){e.$set(t,"startData",o)},expression:"item.startData"}})],1),"立即分房"==e.roomManageInfo.manageTypeName?o("el-col",{staticStyle:{"padding-left":"6px"},attrs:{span:5}},[o("el-button",{staticClass:"greenBtn has-remain-font",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:function(t){return e.openDialogRemainTime("distributeDetail",i)}}},[e._v("保留到\n                                "),e.dialogRoomRemainTime||""==t.retentionTime||null==t.retentionTime?e._e():o("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px",right:"-2px"}})])],1):e._e()],1),o("el-col",{attrs:{span:6}},[o("el-col",{attrs:{span:5}},[e._v("离店")]),o("el-col",{attrs:{span:17}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",clearable:!1,size:"small","value-format":"yyyy-MM-dd"},on:{change:function(t){return e.changeReserveLeaveData(i)}},model:{value:t.leaveData,callback:function(o){e.$set(t,"leaveData",o)},expression:"item.leaveData"}})],1)],1),o("el-col",{attrs:{span:3}},[o("el-input-number",{staticStyle:{width:"92%"},attrs:{min:1,size:"small"},on:{change:function(t){return e.changeRoomNigihtVal(i)}},model:{value:t.night,callback:function(o){e.$set(t,"night",o)},expression:"item.night"}})],1),o("el-col",{attrs:{span:2}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(t){return e.changeRoomTypeVal(i,"editRoom")}},model:{value:t.roomType,callback:function(o){e.$set(t,"roomType",o)},expression:"item.roomType"}},e._l(t.optionRooms,function(e,t){return o("el-option",{key:t,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房费规格",size:"small"},on:{change:function(t){return e.changeDayRoomPriceVal("editRoom",i)}},model:{value:t.priceSpecs,callback:function(o){e.$set(t,"priceSpecs",o)},expression:"item.priceSpecs"}},e._l(t.priceSpecsList,function(e,t){return o("el-option",{key:t,attrs:{label:e.chanelName,value:e.dailySalesChanelId}})}),1)],1),o("el-col",{attrs:{span:3}},[o("el-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[e._v("￥")]),o("el-col",{attrs:{span:19}},[t.priceSpecs&&"handle"!=t.priceSpecs?o("el-tag",{staticStyle:{width:"100%"},attrs:{type:"info"}},[e._v(e._s(Number(t.price).toFixed(2)))]):o("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1,min:0,size:"small"},on:{change:function(t){return e.calculateRoomPrice(i)}},model:{value:t.price,callback:function(o){e.$set(t,"price",o)},expression:"item.price"}})],1)],1)],1)],1),o("el-col",{attrs:{span:1}},[o("div",[t.persons&&t.persons.length<=1?o("span",{staticClass:"add-person-icon",on:{click:function(o){return e.dialogShowRoomPerson("dialogInsertLive",t.persons,i)}}}):o("el-badge",{staticClass:"add-person-item",attrs:{value:t.persons.length,max:99}},[o("span",{staticClass:"add-person-icon",on:{click:function(o){return e.dialogShowRoomPerson("dialogInsertLive",t.persons,i)}}})])],1),"CheckLive"==e.roomManageInfo.manageType?o("div",{staticStyle:{"margin-top":"10px"}},[o("span",{staticStyle:{"padding-left":"6px"}},[o("el-checkbox",{model:{value:t.checked,callback:function(o){e.$set(t,"checked",o)},expression:"item.checked"}})],1)]):e._e()]),"CheckLive"!=e.roomManageInfo.manageType?o("el-col",{attrs:{span:1}},[o("el-row",[e._v(" ")]),o("el-row",[o("i",{staticClass:"el-icon-remove add-margin",on:{click:function(t){return e.removeNewRoomList(i)}}})])],1):e._e(),e._e()],1)}),"CheckLive"!=e.roomManageInfo.manageType?o("div",{staticClass:"insert-room"},[o("span",{staticClass:"green",staticStyle:{cursor:"pointer"},on:{click:e.insertNewRoomList}},[o("i",{staticClass:"el-icon-circle-plus"}),e._v("添加房间")]),o("span",[e._v("房费合计：￥"),o("span",{staticClass:"green"},[e._v(e._s(e.roomLiveInfo.roomTotalPrice||"0"))])])]):e._e()],2),o("el-row",[o("el-col",{attrs:{span:6}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"线下客人"},model:{value:e.roomLiveInfo.origin,callback:function(t){e.$set(e.roomLiveInfo,"origin",t)},expression:"roomLiveInfo.origin"}},e._l(e.roomOriginList,function(e,t){return o("el-option",{key:t,attrs:{label:e.info,value:e.dailyOrderSourceId}})}),1)],1)],1),o("div",{staticClass:"title-font mt-10"},[e._v("收支信息")]),o("el-row",[o("el-col",{attrs:{span:8}},[e._v("订单金额：￥"),o("span",[e._v(e._s(e.roomLiveInfo.orderTotalMoney||"0"))]),e._v("（房费"),o("span",[e._v(e._s(e.roomLiveInfo.roomTotalPrice||"0"))]),e._v("）")]),o("el-col",{attrs:{span:4}},[e._v("押金: ￥"+e._s(e.roomLiveInfo.roomDepositMoney||"0"))]),o("el-col",{attrs:{span:5}},[e._v("已收款: ￥"+e._s(e.roomLiveInfo.receiveMoney||"0"))]),o("el-col",{staticClass:"green",attrs:{span:4}},[e._v(e._s(e.roomLiveInfo.needMoney>=0?"需补交":"需退回")+"：￥"+e._s(Math.abs(e.roomLiveInfo.needMoney||"0")))]),o("el-col",{staticClass:"green",staticStyle:{"text-align":"right",cursor:"pointer"},attrs:{span:3},nativeOn:{click:function(t){return e.insertAddtionPay("editRoom")}}},[o("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加款项")])],1),e.roomLiveInfo.showAddtionPay?o("div",{staticClass:"person-info",staticStyle:{"margin-top":"0px"}},[o("el-row",[o("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?3:4}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"费用类型",size:"small"},on:{change:function(t){return e.changeIncomeFeeVal("editRoom")}},model:{value:e.roomLiveInfo.incomeMoneyType,callback:function(t){e.$set(e.roomLiveInfo,"incomeMoneyType",t)},expression:"roomLiveInfo.incomeMoneyType"}},e._l(e.incomeFeeTypeList,function(e){return o("el-option",{key:e.feeTypeId,attrs:{label:e.feeTypeName,value:e.feeTypeId}})}),1)],1),3==e.roomLiveInfo.incomeMoneyType?o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"其它费用",size:"small"},model:{value:e.roomLiveInfo.incomeAddtionMoneyType,callback:function(t){e.$set(e.roomLiveInfo,"incomeAddtionMoneyType",t)},expression:"roomLiveInfo.incomeAddtionMoneyType"}},e._l(e.incomeAddtionFeeList,function(e){return o("el-option",{key:e.detailFeeTypeId,attrs:{label:e.feeName,value:e.detailFeeTypeId}})}),1)],1):e._e(),o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"收/支",size:"small"},on:{change:function(t){return e.changeIncomePayType("editRoom")}},model:{value:e.roomLiveInfo.incomeReceiveType,callback:function(t){e.$set(e.roomLiveInfo,"incomeReceiveType",t)},expression:"roomLiveInfo.incomeReceiveType"}},e._l(e.incomeOrPayList,function(e){return o("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),o("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?3:4}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(t){return e.getMoneyDayList("editRoom")}},model:{value:e.roomLiveInfo.incomeChoiceRoom,callback:function(t){e.$set(e.roomLiveInfo,"incomeChoiceRoom",t)},expression:"roomLiveInfo.incomeChoiceRoom"}},e._l(e.roomLimitTypeList,function(e,t){return o("el-option",{key:t,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),o("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?4:5}},[o("el-col",{attrs:{span:1==e.roomLiveInfo.incomeMoneyType?5:7}},[e._v("金额")]),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==e.roomLiveInfo.incomeMoneyType,expression:"roomLiveInfo.incomeMoneyType == 1"}],attrs:{span:9}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"天数",size:"small"},on:{change:function(t){return e.changeMoneyDayVal("editRoom")}},model:{value:e.roomLiveInfo.rentMoneyDay,callback:function(t){e.$set(e.roomLiveInfo,"rentMoneyDay",t)},expression:"roomLiveInfo.rentMoneyDay"}},e._l(e.moneyChoiceDayList,function(e,t){return o("el-option",{key:t,attrs:{label:e.text,value:e.val}})}),1)],1),o("el-col",{attrs:{span:1==e.roomLiveInfo.incomeMoneyType?9:15}},[o("el-input-number",{staticStyle:{width:"100%"},attrs:{disabled:1==e.roomLiveInfo.incomeMoneyType&&!e.roomLiveInfo.moneyCanEidt,controls:!1,min:0,size:"small"},model:{value:e.roomLiveInfo.incomeMoney,callback:function(t){e.$set(e.roomLiveInfo,"incomeMoney",t)},expression:"roomLiveInfo.incomeMoney"}})],1)],1),o("el-col",{attrs:{span:e.roomLiveInfo.showPayNo?3:4}},[o("el-col",{attrs:{span:22}},[o("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.roomLiveInfo.showPayType,placeholder:"支付方式",size:"small"},on:{change:function(t){return e.changeAddtionPayType("liveRoom")}},model:{value:e.roomLiveInfo.incomePayType,callback:function(t){e.$set(e.roomLiveInfo,"incomePayType",t)},expression:"roomLiveInfo.incomePayType"}},e._l(e.incomePayTypeList,function(e){return o("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),o("el-col",{attrs:{span:e.roomLiveInfo.showPayNo?5:4}},[e.roomLiveInfo.showPayNo&&e.roomLiveInfo.showPayType?o("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogSettleAccounts}},[e._v("单号 \n                        "),!e.dialogReserveSettleAccounts&&e.settleAccount.newVal.length>0?o("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]):e._e(),o("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogReserveLabel}},[e._v("备注 \n                        "),!e.dialogReserveLabel&&e.reserveLabel.isInsert&&e.reserveLabel.newVal.length>0?o("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.saveOrderIncome("liveRoom")}}},[e._v("保存")])],1)],1)],1):e._e(),o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderReserveTable,border:""}},[o("el-table-column",{attrs:{prop:"moneyTypeName",align:"center",label:"费用类型"}}),o("el-table-column",{attrs:{prop:"incomeName",align:"center",label:"收/支"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.income?o("span",{staticStyle:{color:"#24b0fc"}},[e._v("+"+e._s(t.row.money)+e._s(t.row.incomeName||"-"))]):o("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(t.row.money)+e._s(t.row.incomeName||"-"))])]}}],null,!1,18178844)}),o("el-table-column",{attrs:{prop:"payTypeName",align:"center",label:"支付方式"}}),o("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房间"}}),o("el-table-column",{attrs:{prop:"operatorTime",align:"center",label:"操作时间"}}),o("el-table-column",{attrs:{prop:"payNo",align:"center",label:"挂账单号"}}),o("el-table-column",{attrs:{prop:"operatorName",align:"center",label:"操作人"}}),o("el-table-column",{attrs:{prop:"operate",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.income?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.deleteOrderRoom(t.row)}}},[e._v("删除")]):e._e(),1==t.row.income?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.getReceiveMoney(t.row)}}},[e._v("收款")]):e._e(),2==t.row.income&&t.row.refundAmount&&t.row.refundAmount>0?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.getBackMoney(t.row)}}},[e._v("退款")]):e._e()]}}],null,!1,4125500932)})],1)],1),o("div",{staticClass:"mt-10"},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"订单备注..."},model:{value:e.roomLiveInfo.label,callback:function(t){e.$set(e.roomLiveInfo,"label",t)},expression:"roomLiveInfo.label"}})],1),o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitDirectLive}},[e._v("保存")])],1)],1)])],1):e._e(),e.dialogExitRoom?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"办理退房",visible:e.dialogExitRoom,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"980px","before-close":function(){e.roomManageInfo.manageType="",e.dialogExitRoom=!1}},on:{"update:visible":function(t){e.dialogExitRoom=t}}},[o("div",{staticClass:"room-puple-detail"},[o("div",{staticClass:"person-info",staticStyle:{"margin-top":"0px"}},e._l(e.exitPersonList,function(t,i){return o("el-row",{key:i},[o("el-col",{attrs:{span:6}},[o("el-checkbox",{on:{change:function(t){return e.changeExitPersonChoice(i)}},model:{value:t.isChecked,callback:function(o){e.$set(t,"isChecked",o)},expression:"item.isChecked"}},[e._v(e._s(t.dailyRoomName||"-")+" ("+e._s(t.dailyRoomTypeName||"-")+")")])],1),o("el-col",{attrs:{span:12}},[o("span",{staticStyle:{"font-size":"14px"}},[e._v("入离："+e._s(t.startDate||"-")+" 至 "+e._s(t.endDate||"-")+" 入住"+e._s(t.nights||"0")+"晚")])]),o("el-col",{attrs:{span:4}},[o("span",{staticStyle:{"font-size":"14px"}},[e._v("房费：￥"+e._s(t.roomAmount||"0"))])])],1)}),1),o("div",{staticClass:"title-font mt-10"},[e._v("收支信息")]),o("el-row",[o("el-col",{attrs:{span:8}},[e._v("订单金额：￥"),o("span",[e._v(e._s(e.roomLiveInfo.orderTotalMoney||"0"))]),e._v("（房费"),o("span",[e._v(e._s(e.roomLiveInfo.roomTotalPrice||"0"))]),e._v("）")]),o("el-col",{attrs:{span:4}},[e._v("押金: ￥"+e._s(e.roomLiveInfo.roomDepositMoney||"0"))]),o("el-col",{attrs:{span:5}},[e._v("已收款: ￥"+e._s(e.roomExitInfo.depositDeduct?e.roomLiveInfo.receiveMoney+e.roomLiveInfo.roomDepositMoney:e.roomLiveInfo.receiveMoney))]),e.roomExitInfo.depositDeduct?o("el-col",{staticClass:"green",attrs:{span:4}},[e._v(e._s(e.roomLiveInfo.needMoney-e.roomLiveInfo.roomDepositMoney>=0?"需补交":"需退回")+"：￥"+e._s(Math.abs(e.roomLiveInfo.needMoney-e.roomLiveInfo.roomDepositMoney||"0")))]):o("el-col",{staticClass:"green",attrs:{span:4}},[e._v(e._s(e.roomLiveInfo.needMoney>=0?"需补交":"需退回")+"：￥"+e._s(Math.abs(e.roomLiveInfo.needMoney||"0")))]),o("el-col",{staticClass:"green",staticStyle:{"text-align":"right",cursor:"pointer"},attrs:{span:3},nativeOn:{click:function(t){return e.insertAddtionPay("exitRoom")}}},[o("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加款项")])],1),e.roomExitInfo.showAddtionPay?o("div",{staticClass:"person-info",staticStyle:{"margin-top":"0px"}},[o("el-row",[o("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?3:4}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"费用类型",size:"small"},on:{change:function(t){return e.changeIncomeFeeVal("editRoom")}},model:{value:e.roomLiveInfo.incomeMoneyType,callback:function(t){e.$set(e.roomLiveInfo,"incomeMoneyType",t)},expression:"roomLiveInfo.incomeMoneyType"}},e._l(e.incomeFeeTypeList,function(e){return o("el-option",{key:e.feeTypeId,attrs:{label:e.feeTypeName,value:e.feeTypeId}})}),1)],1),3==e.roomLiveInfo.incomeMoneyType?o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"其它费用",size:"small"},model:{value:e.roomLiveInfo.incomeAddtionMoneyType,callback:function(t){e.$set(e.roomLiveInfo,"incomeAddtionMoneyType",t)},expression:"roomLiveInfo.incomeAddtionMoneyType"}},e._l(e.incomeAddtionFeeList,function(e){return o("el-option",{key:e.detailFeeTypeId,attrs:{label:e.feeName,value:e.detailFeeTypeId}})}),1)],1):e._e(),o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"收/支",size:"small"},on:{change:function(t){return e.changeIncomePayType("editRoom")}},model:{value:e.roomLiveInfo.incomeReceiveType,callback:function(t){e.$set(e.roomLiveInfo,"incomeReceiveType",t)},expression:"roomLiveInfo.incomeReceiveType"}},e._l(e.incomeOrPayList,function(e){return o("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),o("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?3:4}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(t){return e.getMoneyDayList("editRoom")}},model:{value:e.roomLiveInfo.incomeChoiceRoom,callback:function(t){e.$set(e.roomLiveInfo,"incomeChoiceRoom",t)},expression:"roomLiveInfo.incomeChoiceRoom"}},e._l(e.roomLimitTypeList,function(e,t){return o("el-option",{key:t,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),o("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?4:5}},[o("el-col",{attrs:{span:1==e.roomLiveInfo.incomeMoneyType?5:7}},[e._v("金额")]),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==e.roomLiveInfo.incomeMoneyType,expression:"roomLiveInfo.incomeMoneyType == 1"}],attrs:{span:9}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"天数",size:"small"},on:{change:function(t){return e.changeMoneyDayVal("editRoom")}},model:{value:e.roomLiveInfo.rentMoneyDay,callback:function(t){e.$set(e.roomLiveInfo,"rentMoneyDay",t)},expression:"roomLiveInfo.rentMoneyDay"}},e._l(e.moneyChoiceDayList,function(e,t){return o("el-option",{key:t,attrs:{label:e.text,value:e.val}})}),1)],1),o("el-col",{attrs:{span:1==e.roomLiveInfo.incomeMoneyType?9:15}},[o("el-input-number",{staticStyle:{width:"100%"},attrs:{disabled:1==e.roomLiveInfo.incomeMoneyType&&!e.roomLiveInfo.moneyCanEidt,controls:!1,min:0,size:"small"},model:{value:e.roomLiveInfo.incomeMoney,callback:function(t){e.$set(e.roomLiveInfo,"incomeMoney",t)},expression:"roomLiveInfo.incomeMoney"}})],1)],1),o("el-col",{attrs:{span:e.roomLiveInfo.showPayNo?3:4}},[o("el-col",{attrs:{span:22}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"支付方式",size:"small"},on:{change:function(t){return e.changeAddtionPayType("liveRoom")}},model:{value:e.roomLiveInfo.incomePayType,callback:function(t){e.$set(e.roomLiveInfo,"incomePayType",t)},expression:"roomLiveInfo.incomePayType"}},e._l(e.incomePayTypeList,function(e){return o("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),o("el-col",{attrs:{span:e.roomLiveInfo.showPayNo?5:4}},[e.roomLiveInfo.showPayNo&&e.roomLiveInfo.showPayType?o("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogSettleAccounts}},[e._v("单号 \n                        "),!e.dialogReserveSettleAccounts&&e.settleAccount.newVal.length>0?o("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]):e._e(),o("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogReserveLabel}},[e._v("备注 \n                        "),!e.dialogReserveLabel&&e.reserveLabel.isInsert&&e.reserveLabel.newVal.length>0?o("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.saveOrderIncome("exitRoom")}}},[e._v("保存")])],1)],1)],1):e._e(),o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderReserveTable,border:""}},[o("el-table-column",{attrs:{prop:"moneyTypeName",align:"center",label:"费用类型"}}),o("el-table-column",{attrs:{prop:"incomeName",align:"center",label:"收/支"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.income?o("span",{staticStyle:{color:"#24b0fc"}},[e._v("+"+e._s(t.row.money)+e._s(t.row.incomeName||"-"))]):o("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(t.row.money)+e._s(t.row.incomeName||"-"))])]}}],null,!1,18178844)}),o("el-table-column",{attrs:{prop:"payTypeName",align:"center",label:"支付方式"}}),o("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房间"}}),o("el-table-column",{attrs:{prop:"operatorTime",align:"center",label:"操作时间"}}),o("el-table-column",{attrs:{prop:"payNo",align:"center",label:"挂账单号"}}),o("el-table-column",{attrs:{prop:"operatorName",align:"center",label:"操作人"}}),o("el-table-column",{attrs:{prop:"operate",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.income?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.deleteOrderRoom(t.row)}}},[e._v("删除")]):e._e(),1==t.row.income?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.getReceiveMoney(t.row)}}},[e._v("收款")]):e._e(),2==t.row.income&&t.row.refundAmount&&t.row.refundAmount>0?o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(o){return e.getBackMoney(t.row)}}},[e._v("退款")]):e._e()]}}],null,!1,4125500932)})],1)],1),o("div",{staticClass:"mt-10"},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"订单备注..."},model:{value:e.roomLiveInfo.label,callback:function(t){e.$set(e.roomLiveInfo,"label",t)},expression:"roomLiveInfo.label"}})],1),o("div",{staticClass:"right-space-btn mt-10"},[o("el-checkbox",{model:{value:e.roomExitInfo.depositDeduct,callback:function(t){e.$set(e.roomExitInfo,"depositDeduct",t)},expression:"roomExitInfo.depositDeduct"}},[e._v("押金抵扣")]),o("el-button",{attrs:{type:"primary"},on:{click:e.comfirmClearAndExitRoom}},[e._v("结账退房")])],1)],1)])],1):e._e(),e.dialogEditOrder?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"修改订单",visible:e.dialogEditOrder,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"860px","before-close":function(){return e.dialogEditOrder=!1}},on:{"update:visible":function(t){e.dialogEditOrder=t}}},[o("div",{staticClass:"room-puple-detail"},[o("div",{staticClass:"title-font"},[e._v("住客")]),o("div",{staticClass:"person-info"},[o("el-row",{staticClass:"person-info-ceil"},[o("el-col",{attrs:{span:22}},[o("el-row",[o("el-col",{attrs:{span:7}},[o("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("姓名")]),o("el-col",{attrs:{span:16}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),o("el-col",{attrs:{span:7}},[o("el-col",{attrs:{span:5}},[e._v("手机")]),o("el-col",{attrs:{span:17}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),o("el-col",{attrs:{span:10}},[o("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("身份证号")]),o("el-col",{attrs:{span:18}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1)],1),o("el-row",{staticClass:"mt-10"},[o("el-col",{attrs:{span:7}},[o("el-col",{attrs:{span:6}},[e._v("入住")]),o("el-col",{attrs:{span:16}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),o("el-col",{attrs:{span:7}},[o("el-col",{attrs:{span:5}},[e._v("离店")]),o("el-col",{attrs:{span:17}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),o("el-col",{attrs:{span:4}},[o("el-input-number",{staticStyle:{width:"92%"},attrs:{min:1,size:"small"},model:{value:e.num,callback:function(t){e.num=t},expression:"num"}})],1),o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.projectList,function(e){return o("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1),o("el-col",{attrs:{span:3}},[o("el-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[e._v("￥")]),o("el-col",{attrs:{span:19}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1)],1)],1),o("el-col",{attrs:{span:1}},[o("el-badge",{staticClass:"add-person-item",attrs:{value:20,max:99}},[o("span",{staticClass:"add-person-icon",on:{click:function(t){e.dialogAddPerson=!0}}})])],1),o("el-col",{attrs:{span:1}},[o("el-row",[e._v(" ")]),o("el-row",[o("i",{staticClass:"el-icon-remove add-margin"})])],1)],1),o("el-row",{staticClass:"person-info-ceil"},[o("el-col",{attrs:{span:22}},[o("el-row",[o("el-col",{attrs:{span:7}},[o("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("姓名")]),o("el-col",{attrs:{span:16}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),o("el-col",{attrs:{span:7}},[o("el-col",{attrs:{span:5}},[e._v("手机")]),o("el-col",{attrs:{span:17}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),o("el-col",{attrs:{span:10}},[o("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("身份证号")]),o("el-col",{attrs:{span:18}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1)],1),o("el-row",{staticClass:"mt-10"},[o("el-col",{attrs:{span:7}},[o("el-col",{attrs:{span:6}},[e._v("入住")]),o("el-col",{attrs:{span:16}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),o("el-col",{attrs:{span:7}},[o("el-col",{attrs:{span:5}},[e._v("离店")]),o("el-col",{attrs:{span:17}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),o("el-col",{attrs:{span:4}},[o("el-input-number",{staticStyle:{width:"92%"},attrs:{min:1,size:"small"},model:{value:e.num,callback:function(t){e.num=t},expression:"num"}})],1),o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.projectList,function(e){return o("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1),o("el-col",{attrs:{span:3}},[o("el-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[e._v("￥")]),o("el-col",{attrs:{span:19}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1)],1)],1),o("el-col",{attrs:{span:1}},[o("span",{staticClass:"add-person-icon",on:{click:function(t){e.dialogAddPerson=!0}}})]),o("el-col",{attrs:{span:1}},[o("el-row",[e._v(" ")]),o("el-row",[o("i",{staticClass:"el-icon-remove add-margin"})])],1)],1),o("div",{staticClass:"insert-room"},[o("span",{staticClass:"green",staticStyle:{cursor:"pointer"}},[o("i",{staticClass:"el-icon-circle-plus"}),e._v("添加房间")]),o("span",[e._v("房费合计：￥"),o("span",{staticClass:"green"},[e._v("1000")])])])],1),o("el-row",[o("el-col",{attrs:{span:6}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.projectList,function(e){return o("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1)],1),o("div",{staticClass:"title-font mt-10"},[e._v("收支信息")]),o("el-row",[o("el-col",{attrs:{span:10}},[e._v("订单金额：￥"),o("span",[e._v("1000")]),e._v("（房费"),o("span",[e._v("1000")]),e._v("）")]),o("el-col",{attrs:{span:5}},[e._v("已收款: ￥0")]),o("el-col",{staticClass:"green",attrs:{span:6}},[e._v("需补交：￥1000")]),o("el-col",{staticClass:"green",staticStyle:{"text-align":"right",cursor:"pointer"},attrs:{span:3}},[o("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加款项")])],1),o("div",{staticClass:"person-info",staticStyle:{"margin-top":"0px"}},[o("el-row",[o("el-col",{attrs:{span:4}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"费用类型",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.projectList,function(e){return o("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1),o("el-col",{attrs:{span:3}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"收/支",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.projectList,function(e){return o("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1),o("el-col",{attrs:{span:4}},[o("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.projectList,function(e){return o("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1),o("el-col",{attrs:{span:4}},[o("el-col",{attrs:{span:7}},[e._v("金额")]),o("el-col",{attrs:{span:15}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),o("el-col",{attrs:{span:5}},[o("el-col",{attrs:{span:6}},[e._v("现金")]),o("el-col",{attrs:{span:16}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"支付方式",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.projectList,function(e){return o("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1)],1),o("el-col",{attrs:{span:4}},[o("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"}},[e._v("备注 \n                        "),o("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}})]),o("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("保存")])],1)],1)],1),o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderListTable,border:""}},[o("el-table-column",{attrs:{prop:"cityName",align:"center",label:"费用类型"}}),o("el-table-column",{attrs:{prop:"orgName",align:"center",label:"收/支"}}),o("el-table-column",{attrs:{prop:"roomName",align:"center",label:"支付方式"}}),o("el-table-column",{attrs:{prop:"houseType",align:"center",label:"房间"}}),o("el-table-column",{attrs:{prop:"visitorName",align:"center",label:"操作时间"}}),o("el-table-column",{attrs:{prop:"visitorPhone",align:"center",label:"操作人"}}),o("el-table-column",{attrs:{prop:"operator",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{staticClass:"greenFont tabOperteBtn"},[e._v("删除")]),o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){e.dialogIncomeMoney=!0}}},[e._v("收款")]),o("span",{staticClass:"greenFont tabOperteBtn"},[e._v("备注")]),o("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){e.dialogExitMoney=!0}}},[e._v("退款")])]}}],null,!1,2220410890)})],1)],1),o("div",{staticClass:"mt-10"},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"订单备注..."},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),o("el-row",{staticClass:"mt-10"},[o("el-col",{staticClass:"is-required-b",attrs:{span:4}},[e._v("\n                    收/付款企业账号\n                  ")]),o("el-col",{attrs:{span:5}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"企业默认账号",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.projectList,function(e){return o("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1)],1),o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{attrs:{type:"primary"}},[e._v("保存")])],1)],1)])],1):e._e(),e.dialogAddRoomPerson?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"入住人信息",visible:e.dialogAddRoomPerson,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"760px","before-close":function(){return e.dialogAddRoomPerson=!1}},on:{"update:visible":function(t){e.dialogAddRoomPerson=t}}},[o("div",{staticClass:"room-puple-detail"},[o("div",e._l(e.personShow.List,function(t,i){return o("el-row",{key:i,staticClass:"mb-10"},[o("el-col",{attrs:{span:6}},[o("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("姓名")]),o("el-col",{attrs:{span:16}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:t.name,callback:function(o){e.$set(t,"name",o)},expression:"item.name"}})],1)],1),o("el-col",{attrs:{span:6}},[o("el-col",{attrs:{span:5}},[e._v("手机")]),o("el-col",{attrs:{span:17}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.phone,callback:function(o){e.$set(t,"phone",o)},expression:"item.phone"}})],1)],1),o("el-col",{attrs:{span:10}},[o("el-col",{attrs:{span:10}},[o("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"证件类型",size:"small"},model:{value:t.cardType,callback:function(o){e.$set(t,"cardType",o)},expression:"item.cardType"}},e._l(e.cardTypeList,function(e){return o("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),o("el-col",{attrs:{span:14}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.cardNo,callback:function(o){e.$set(t,"cardNo",o)},expression:"item.cardNo"}})],1)],1),o("el-col",{attrs:{span:2}},[o("i",{staticClass:"el-icon-remove add-margin",staticStyle:{margin:"0 6px"},on:{click:function(t){return e.deletePersonDialog(i)}}}),i==e.personShow.List.length-1?o("i",{staticClass:"el-icon-circle-plus add-margin",staticStyle:{color:"#f3893b",cursor:"pointer","font-size":"18px"},on:{click:e.insertPersonDialog}}):e._e()])],1)}),1),o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{attrs:{type:"primary"},on:{click:e.dialogHideRoomPerson}},[e._v("保存")])],1)])])],1):e._e(),e.dialogExitMoney?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"退款",visible:e.dialogExitMoney,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px","before-close":function(){return e.dialogExitMoney=!1}},on:{"update:visible":function(t){e.dialogExitMoney=t}}},[o("div",{staticClass:"room-puple-detail"},[o("el-row",{staticClass:"mb-10"},[o("el-col",{staticClass:"is-required-b",attrs:{span:4}},[e._v("退款方式")]),o("el-col",{attrs:{span:18}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:e.exitMoneyInfo.payType,callback:function(t){e.$set(e.exitMoneyInfo,"payType",t)},expression:"exitMoneyInfo.payType"}},e._l(e.incomePayTypeList,function(e){return o("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),o("el-row",{staticClass:"mb-10"},[o("el-col",{attrs:{span:12}},[o("el-col",{staticClass:"is-required-b",attrs:{span:8}},[e._v("退款金额：")]),o("el-col",{attrs:{span:12}},[o("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.exitMoneyInfo.money,callback:function(t){e.$set(e.exitMoneyInfo,"money",t)},expression:"exitMoneyInfo.money"}})],1),o("el-col",{attrs:{span:2}},[e._v("元")])],1),e._e()],1),e._e(),e._e(),e._e(),o("el-row",{staticClass:"mb-10"},[o("el-col",{attrs:{span:4}},[e._v("备注：")]),o("el-col",{attrs:{span:18}},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"备注"},model:{value:e.exitMoneyInfo.label,callback:function(t){e.$set(e.exitMoneyInfo,"label",t)},expression:"exitMoneyInfo.label"}})],1)],1),o("el-row",[o("el-col",{attrs:{span:22}},[o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitExitMoney}},[e._v("确定")])],1)])],1)],1)])],1):e._e(),e.dialogIncomeMoney?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"收款",visible:e.dialogIncomeMoney,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px","before-close":function(){return e.dialogIncomeMoney=!1}},on:{"update:visible":function(t){e.dialogIncomeMoney=t}}},[o("div",{staticClass:"room-puple-detail"},[o("el-row",{staticClass:"mb-10"},[o("el-col",{attrs:{span:12}},[o("el-col",{staticClass:"is-required-b",attrs:{span:8}},[e._v("收款途径：")]),o("el-col",{attrs:{span:12}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:e.receiveMoneyInfo.payType,callback:function(t){e.$set(e.receiveMoneyInfo,"payType",t)},expression:"receiveMoneyInfo.payType"}},e._l(e.incomePayTypeList,function(e){return o("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),o("el-col",{attrs:{span:12}},[o("el-col",{staticClass:"is-required-b",attrs:{span:8}},[e._v("收款金额：")]),o("el-col",{attrs:{span:12}},[o("el-input",{staticStyle:{width:"100%"},attrs:{disabled:"",size:"small"},model:{value:e.receiveMoneyInfo.money,callback:function(t){e.$set(e.receiveMoneyInfo,"money",t)},expression:"receiveMoneyInfo.money"}})],1)],1)],1),o("el-row",{staticClass:"mb-10"},[o("el-col",{attrs:{span:4}},[e._v("备注：")]),o("el-col",{attrs:{span:18}},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"备注"},model:{value:e.receiveMoneyInfo.label,callback:function(t){e.$set(e.receiveMoneyInfo,"label",t)},expression:"receiveMoneyInfo.label"}})],1)],1),o("el-row",[o("el-col",{attrs:{span:22}},[o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitReceiveMoney}},[e._v("确定")])],1)])],1)],1)])],1):e._e(),e.dialogReserveLabel?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"备注",visible:e.dialogReserveLabel,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"460px","before-close":e.closeDialogReserveLabel},on:{"update:visible":function(t){e.dialogReserveLabel=t}}},[o("div",{staticClass:"room-puple-detail"},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:8},placeholder:"请添加备注内容"},model:{value:e.reserveLabel.newVal,callback:function(t){e.$set(e.reserveLabel,"newVal",t)},expression:"reserveLabel.newVal"}}),o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{attrs:{type:"primary"},on:{click:e.saveDialogReserveLabel}},[e._v("保存")])],1)],1)])],1):e._e(),e.dialogSendMessage?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"发送短信",visible:e.dialogSendMessage,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"460px","before-close":function(){return e.dialogSendMessage=!1}},on:{"update:visible":function(t){e.dialogSendMessage=t}}},[o("div",{staticClass:"mb-10"},[e._v("\n              收件人："+e._s(e.sendMessageInfo.name||"-")+"("+e._s(e.sendMessageInfo.phone||"-")+")\n            ")]),o("div",{staticClass:"mb-10"},[o("el-radio-group",{on:{change:e.changeSendMessageType},model:{value:e.sendMessageInfo.type,callback:function(t){e.$set(e.sendMessageInfo,"type",t)},expression:"sendMessageInfo.type"}},[o("el-radio",{attrs:{label:1}},[e._v("欢迎预定")]),o("el-radio",{attrs:{label:2}},[e._v("欢迎入住")]),o("el-radio",{attrs:{label:3}},[e._v("门锁密码")]),o("el-radio",{attrs:{label:4}},[e._v("再次光临")])],1)],1),o("div",{staticClass:"room-puple-detail"},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:8},placeholder:"请输入发送短信内容"},model:{value:e.sendMessageInfo.message,callback:function(t){e.$set(e.sendMessageInfo,"message",t)},expression:"sendMessageInfo.message"}}),o("div",{staticClass:"mb-10"}),o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitSendMessage}},[e._v("立刻发送")])],1)],1)])],1):e._e(),e.dialogReserveSettleAccounts?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"挂账单号",visible:e.dialogReserveSettleAccounts,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"460px","before-close":e.closeDialogSettleAccounts},on:{"update:visible":function(t){e.dialogReserveSettleAccounts=t}}},[o("div",{staticClass:"room-puple-detail"},[o("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:8},placeholder:"请输入挂账单号"},model:{value:e.settleAccount.newVal,callback:function(t){e.$set(e.settleAccount,"newVal",t)},expression:"settleAccount.newVal"}}),o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{staticClass:"greenBtn",on:{click:e.closeDialogSettleAccounts}},[e._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.saveDialogSettleAccounts}},[e._v("保存")])],1)],1)])],1):e._e(),e.dialogRoomRemainTime?o("div",{staticClass:"my-puple"},[o("el-dialog",{attrs:{title:"房间保留时间",visible:e.dialogRoomRemainTime,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"360px","before-close":e.closeDialogRemainTime},on:{"update:visible":function(t){e.dialogRoomRemainTime=t}}},[o("div",{staticClass:"room-puple-detail"},[o("div",{staticStyle:{"margin-bottom":"20px"}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择房间保留时间"},model:{value:e.remainTime.newVal,callback:function(t){e.$set(e.remainTime,"newVal",t)},expression:"remainTime.newVal"}})],1),o("div",{staticClass:"right-space-btn mt-10"},[o("el-button",{attrs:{type:"primary"},on:{click:e.comfirmChoiceRemainTime}},[e._v("保存")])],1)])])],1):e._e(),o("div",{staticClass:"el-page"},[o("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},a=[],s=o("e7ba"),r=o("43bf"),n=o("90b9"),l={name:"orderList",components:{roomType:s["a"],originList:r["a"]},data(){return{value:"",num:1,checked:!0,projectList:[],roomList:[],orderStatusList:[],payStatusList:[],searchTimeTypeList:[],orderSearchInfo:{projectId:"",roomType:"",origin:"",orderStatus:"",payStatus:"",timeType:"",orderData:[],personInfo:"",orderNo:""},orderListTable:[],dialogRoomDetail:!1,dialogCancelDistribute:!1,dialogCancelOrder:!1,dialogEditOrder:!1,dialogAddRoomPerson:!1,dialogExitMoney:!1,dialogIncomeMoney:!1,dialogExitRoom:!1,dialogRoomDistribute:!1,dialogCheckIn:!1,dialogReserveLabel:!1,dialogInsertLive:!1,dialogSendMessage:!1,dialogReserveSettleAccounts:!1,dialogRoomRemainTime:!1,orderDetailInfo:{},orderReserveTable:[],orderRoomDetail:{dailyOrderId:"",orderNo:"",orderTime:"",dailyOrderSourceId:"",dailyOrderSourceName:"",dailyRoomTypeId:"",roomStatus:{},personStatus:{},roomDepositMoney:"",roomTotalPrice:"",orderTotalMoney:"",receiveMoney:"",needMoney:"",incomeMoneyType:"",incomeAddtionMoneyType:"",incomeReceiveType:"",incomeChoiceRoom:"",incomeMoney:"",incomePayType:"",rentMoneyDay:"",moneyCanEidt:!0,payNo:"",showPayNo:!1,showAddtionPay:!1,closedId:"",label:""},orderPersonList:[],cardTypeList:[],incomeFeeTypeList:[],incomeAddtionFeeList:[],incomeOrPayList:[],incomePayTypeList:[],roomTypeList:[],roomLimitTypeList:[],noRoomNumTypeList:[],reserveLabel:{index:0,isInsert:!1,originVal:"",newVal:"",dailyOrderDetailId:"",type:""},exitMoneyInfo:{refundDetailId:"",money:"",payType:"",status:"",label:""},receiveMoneyInfo:{dailyOrderDetailId:"",payType:"",money:"",label:"",payType:"",status:""},orderBackMoneyTable:[],cancelOrderReasonList:[],cancelOrder:{backMoney:"1",money:"",payType:"",label:"",reason:""},livePersonList:[{persons:[{name:"",phone:"",cardType:"",cardNo:""}],startData:"",leaveData:"",night:"",roomType:"",optionRooms:[],priceSpecs:"",priceSpecsList:[],roomTypeId:"",price:"",priceDataList:[]}],personShow:{index:0,from:"",List:[]},roomLiveInfo:{origin:"",roomTotalPrice:"",roomDepositMoney:"",orderTotalMoney:"",receiveMoney:"",needMoney:"",incomeMoneyType:"",incomeAddtionMoneyType:"",incomeReceiveType:"",incomeChoiceRoom:"",incomeMoney:"",incomePayType:"",rentMoneyDay:"",moneyCanEidt:!0,payNo:"",showPayNo:!1,showAddtionPay:!1,label:"",roomStatus:{},personStatus:{}},roomManageInfo:{manageType:"",manageTypeName:""},roomOriginList:[],roomExitInfo:{showAddtionPay:!1,depositDeduct:!0},exitPersonList:[],sendMessageInfo:{name:"",type:1,phone:"",message:"",personList:[],dailyOrderRoomId:""},settleAccount:{type:"",originVal:"",newVal:""},remainTime:{type:"",index:0,originVal:"",newVal:""},moneyChoiceDayList:[],moneyDayInfo:{startData:"",endData:"",roomPrice:0,dayCount:0},roomPriceTypeList:[],currentPage:1,pageSize:10,cancelNum:0,total:10,currentData:"",otherFeeTypeVal:3}},created(){this.getCurrentData(),this.getProjectList(),this.getOrderStatusList(),this.getPayStatusList(),this.getRoomPriceTypeList(),this.getSearchTimeTypeList()},computed:{},mounted(){},methods:{handleSizeChange(e){this.currentPage=1,this.pageSize=e,this.searchOrderListTable()},handleCurrentChange(e){this.currentPage=e,this.searchOrderListTable()},getCurrentData(){var e=(new Date).valueOf()/1e3;this.currentData=Object(n["l"])(e)},getProjectList(){this.$http.get("/api/daily/order/getRentalListForFindOrders").then(e=>{var t=e.data;if(0==t.errorCode){if(this.projectList=t.data||[],!(this.projectList.length>0))return;this.orderSearchInfo.projectId=this.projectList[0].dailyRentalId,this.searchOrderListTable()}}).catch(function(e){console.log(e)})},searchOrderListTable(){this.getOrderListTable()},exportOrderListTable(){var e=[],t=[];if(this.$refs.roomType.roomTypeList&&this.$refs.roomType.roomTypeList.length>0)for(var o=0;o<this.$refs.roomType.roomTypeList.length;o++)this.$refs.roomType.roomTypeList[o].isChecked&&e.push(this.$refs.roomType.roomTypeList[o].dailyRoomTypeId);if(this.$refs.originList.roomOriginList&&this.$refs.originList.roomOriginList.length>0)for(o=0;o<this.$refs.originList.roomOriginList.length;o++)this.$refs.originList.roomOriginList[o].isChecked&&t.push(this.$refs.originList.roomOriginList[o].dailyOrderSourceId);var i=t.length>0?t.join(","):"",a=e.length>0?e.join(","):"",s=this.orderSearchInfo.orderData&&2==this.orderSearchInfo.orderData.length?this.orderSearchInfo.orderData[0]:"",r=this.orderSearchInfo.orderData&&2==this.orderSearchInfo.orderData.length?this.orderSearchInfo.orderData[1]:"",n=`./api/daily/order/findOrdersExport?dailyRentalId=${this.orderSearchInfo.projectId}&dateType=${this.orderSearchInfo.timeType}&startDate=${s}&endDate=${r}&dailyOrderSourceIds=${i||""}&dailyRoomTypeIds=${a||""}&orderStatus=${this.orderSearchInfo.orderStatus}&orderPayStatus=${this.orderSearchInfo.payStatus}&otherInfo=${this.orderSearchInfo.personInfo}&orderNo=${this.orderSearchInfo.orderNo}&currentPage=${this.currentPage}&pageSize=${this.pageSize}`;window.open(n)},sendRoomInfoMessage(e,t){this.dialogSendMessage=!0,this.sendMessageInfo.name=this.orderPersonList[e].first.name,this.sendMessageInfo.phone=this.orderPersonList[e].first.tel,this.sendMessageInfo.message="",this.sendMessageInfo.dailyOrderRoomId=this.orderPersonList[e].dailyOrderRoomId,this.sendMessageInfo.personList=this.orderPersonList[e].customers||[],this.sendMessageInfo.type=3==t?3:4==t?4:1,this.getMessageInfo()},getMessageInfo(){this.$http.get("/api/daily/order/getMessage",{params:{type:this.sendMessageInfo.type,dailyOrderRoomId:this.sendMessageInfo.dailyOrderRoomId}}).then(e=>{var t=e.data;0==t.errorCode&&(this.sendMessageInfo.message=t.message||"",this.dialogSendMessage=!0)}).catch(function(e){console.log(e)})},changeSendMessageType(){this.getMessageInfo()},getRoomPriceTypeList(){this.$http.get("/api/daily/sales_chanel/list").then(e=>{var t=e.data;0==t.errorCode&&(this.roomPriceTypeList=t.data||[],this.roomPriceTypeList.push({chanelName:"手动",dailySalesChanelId:"handle"}))}).catch(function(e){console.log(e)})},comfirmSubmitSendMessage(){for(var e=[],t=0;t<this.sendMessageInfo.personList.length;t++)e.push(this.sendMessageInfo.personList[t].tel);this.$http.post("/api/daily/order/sendMessage",{dailyOrderRoomId:this.sendMessageInfo.dailyOrderRoomId,content:this.sendMessageInfo.message,phones:e}).then(e=>{var t=e.data;0==t.errorCode&&(this.$message({message:"短信发送成功!",type:"success"}),this.dialogSendMessage=!1)}).catch(function(e){console.log(e)})},getOrderListTable(){if(0!=this.projectList.length){var e=[],t=[];if(this.$refs.roomType.roomTypeList&&this.$refs.roomType.roomTypeList.length>0)for(var o=0;o<this.$refs.roomType.roomTypeList.length;o++)this.$refs.roomType.roomTypeList[o].isChecked&&e.push(this.$refs.roomType.roomTypeList[o].dailyRoomTypeId);if(this.$refs.originList.roomOriginList&&this.$refs.originList.roomOriginList.length>0)for(o=0;o<this.$refs.originList.roomOriginList.length;o++)this.$refs.originList.roomOriginList[o].isChecked&&t.push(this.$refs.originList.roomOriginList[o].dailyOrderSourceId);var i={dailyRentalId:this.orderSearchInfo.projectId,dateType:this.orderSearchInfo.timeType,startDate:this.orderSearchInfo.orderData&&2==this.orderSearchInfo.orderData.length?this.orderSearchInfo.orderData[0]:"",endDate:this.orderSearchInfo.orderData&&2==this.orderSearchInfo.orderData.length?this.orderSearchInfo.orderData[1]:"",dailyOrderSourceIds:t.length>0?t.join(","):"",dailyRoomTypeIds:e.length>0?e.join(","):"",orderStatus:this.orderSearchInfo.orderStatus,orderPayStatus:this.orderSearchInfo.payStatus,orderRoomStatus:"",otherInfo:this.orderSearchInfo.personInfo,orderNo:this.orderSearchInfo.orderNo,currentPage:this.currentPage,pageSize:this.pageSize};this.$http.get("/api/daily/order/findOrders",{params:i}).then(e=>{var t=e.data;0==t.errorCode&&(this.orderListTable=t.data.content||[],this.total=t.data.total||0,this.cancelNum=t.data.cancelNum||0)}).catch(function(e){console.log(e)})}},getOrderStatusList(){this.$http.get("/api/daily/order/public/orderstatus").then(e=>{var t=e.data;0==t.errorCode&&(this.orderStatusList=t.data||[])}).catch(function(e){console.log(e)})},getPayStatusList(){this.payStatusList=[{text:"未支付",val:"1"},{text:"已支付",val:"2"}]},getSearchTimeTypeList(){this.$http.get("/api/daily/order/public/findOrderDateTypies").then(e=>{var t=e.data;0==t.errorCode&&(this.searchTimeTypeList=t.data||[],this.searchTimeTypeList.length>0?(this.orderSearchInfo.timeType=this.searchTimeTypeList[0].val,this.orderListTable.length>0&&this.searchOrderListTable()):this.orderSearchInfo.timeType="")}).catch(function(e){console.log(e)})},enterOrderDetail(e){this.orderDetailInfo=e||{},this.enterOrderDetailMode(e.dailyOrderId)},enterOrderDetailMode(e){this.$http.get("/api/daily/order/findOrder",{params:{dailyOrderId:e}}).then(t=>{var o=t.data;if(0==o.errorCode){this.orderReserveTable=[],this.roomLimitTypeList=[],this.orderRoomDetail.dailyOrderId=e,this.orderRoomDetail.dailyRoomTypeId="",this.orderRoomDetail.orderNo=o.data.orderNo,this.orderRoomDetail.dailyOrderSourceId=o.data.dailyOrderSourceId,this.orderRoomDetail.dailyOrderSourceName=o.data.dailyOrderSourceName||"-",this.orderRoomDetail.label=o.data.info,this.orderRoomDetail.roomStatus=o.data.status&&""!=o.data.status?o.data.status:{},this.orderRoomDetail.personStatus=o.data.beginRoomStatus&&""!=o.data.beginRoomStatus?o.data.beginRoomStatus:{},this.orderRoomDetail.personStatus.hasBigger=!1,this.orderRoomDetail.showAddtionPay=!1,this.orderRoomDetail.closedId=o.data.closedId,this.orderRoomDetail.roomTotalPrice=o.data.roomAmount,this.orderRoomDetail.orderTotalMoney=o.data.amount,this.orderRoomDetail.receiveMoney=o.data.paidAmount,this.orderRoomDetail.needMoney=o.data.nonPayAmount,this.orderPersonList=o.data.roomAndCustomersCmsVoList||[];for(var i=0;i<this.orderPersonList.length;i++){this.orderPersonList[i].priceSpecs&&"-1"==this.orderPersonList[i].priceSpecs&&(this.orderPersonList[i].priceSpecs="handle"),this.orderPersonList[i].roomStatus&&""!=this.orderPersonList[i].roomStatus&&this.orderRoomDetail.personStatus.val<this.orderPersonList[i].roomStatus.val&&(this.orderRoomDetail.personStatus.hasBigger=!0);for(var a=!1,s=0;s<this.roomLimitTypeList.length;s++)this.roomLimitTypeList[s].dailyRoomId==this.orderPersonList[i].dailyRoomId&&(a=!0);a||this.roomLimitTypeList.push({dailyRoomName:this.orderPersonList[i].dailyRoomName,dailyRoomId:this.orderPersonList[i].dailyRoomId})}var r=o.data.details||[];for(s=0;s<r.length;s++)this.orderReserveTable.push({indexNum:s,moneyType:"收押金"==r[s].name?"2":"",moneyTypeName:r[s].name,income:1==r[s].status.val?r[s].status.val:1==r[s].income.val?2:3,incomeName:r[s].status.text,payType:r[s].payType,payTypeName:r[s].payName,money:r[s].amount,roomName:r[s].dailyRoomName,roomDailyTypeName:r[s].dailyRoomTypeName,roomDailyRoomId:r[s].dailyRoomId,roomDailyRentalId:r[s].dailyRentalId,roomDailyDetailTypeId:r[s].dailyDetailTypeId,operatorTime:r[s].updateTime&&""!=r[s].updateTime?r[s].updateTime.substring(0,10):"-",operatorName:r[s].createrName||"-",operate:"",refundAmount:r[s].refundAmount,payNo:r[s].payNo,dailyDetailId:r[s].dailyDetailId,label:r[s].info});var n=0,l=0,c=0,d=0,m=0,p=0;if("exitRoom"==this.roomManageInfo.manageType||"liveRoom"==this.roomManageInfo.manageType||"editRoom"==this.roomManageInfo.manageType){for(s=0;s<this.orderReserveTable.length;s++)2==this.orderReserveTable[s].income?("收押金"!=this.orderReserveTable[s].moneyTypeName&&(n+=this.orderReserveTable[s].money),"收房费"==this.orderReserveTable[s].moneyTypeName?m+=this.orderReserveTable[s].money:"收押金"==this.orderReserveTable[s].moneyTypeName&&(d+=this.orderReserveTable[s].money)):1==this.orderReserveTable[s].income?p+=this.orderReserveTable[s].money:("退押金"!=this.orderReserveTable[s].moneyTypeName&&(l+=this.orderReserveTable[s].money),"退房费"!=this.orderReserveTable[s].moneyTypeName&&"退押金"!=this.orderReserveTable[s].moneyTypeName&&(c+=this.orderReserveTable[s].money),"退押金"==this.orderReserveTable[s].moneyTypeName&&(d-=this.orderReserveTable[s].money));this.roomLiveInfo.orderTotalMoney=this.roomLiveInfo.roomTotalPrice+n+p-m-c,this.roomLiveInfo.receiveMoney=n-l,this.roomLiveInfo.roomDepositMoney=d,this.roomLiveInfo.needMoney=this.roomLiveInfo.orderTotalMoney-this.roomLiveInfo.receiveMoney,this.dialogRoomDetail&&(this.orderRoomDetail.orderTotalMoney=this.roomLiveInfo.orderTotalMoney,this.orderRoomDetail.receiveMoney=this.roomLiveInfo.receiveMoney,this.orderRoomDetail.roomDepositMoney=this.roomLiveInfo.roomDepositMoney,this.orderRoomDetail.needMoney=this.roomLiveInfo.needMoney)}else{for(s=0;s<this.orderReserveTable.length;s++)2==this.orderReserveTable[s].income?("收押金"!=this.orderReserveTable[s].moneyTypeName&&(n+=this.orderReserveTable[s].money),"收房费"==this.orderReserveTable[s].moneyTypeName?m+=this.orderReserveTable[s].money:"收押金"==this.orderReserveTable[s].moneyTypeName&&(d+=this.orderReserveTable[s].money)):1==this.orderReserveTable[s].income?p+=this.orderReserveTable[s].money:("退押金"!=this.orderReserveTable[s].moneyTypeName&&(l+=this.orderReserveTable[s].money),"退房费"!=this.orderReserveTable[s].moneyTypeName&&"退押金"!=this.orderReserveTable[s].moneyTypeName&&(c+=this.orderReserveTable[s].money),"退押金"==this.orderReserveTable[s].moneyTypeName&&(d-=this.orderReserveTable[s].money));this.orderRoomDetail.orderTotalMoney=this.orderRoomDetail.roomTotalPrice+n+p-m-c,this.orderRoomDetail.receiveMoney=n-l,this.orderRoomDetail.roomDepositMoney=d,this.orderRoomDetail.needMoney=this.orderRoomDetail.orderTotalMoney-this.orderRoomDetail.receiveMoney}this.dialogRoomDetail=!0,this.getCardTypeList(),this.getIncomeFeeTypeList(),this.getIncomePayTypeList()}}).catch(function(e){console.log(e)})},showTableReserveLabel(e,t){this.reserveLabel.dailyOrderDetailId=e.dailyDetailId,this.reserveLabel.type=t,this.reserveLabel.isInsert=!1,this.reserveLabel.index=e.indexNum||0,this.reserveLabel.newVal=e.label,this.dialogReserveLabel=!0},insertAddtionPay(e){if("-1"==this.$authority.indexOf("orderManageCancelRoom"))return this.$message({type:"error",message:"权限不足，暂时无法操作该项!"});"detailRoom"==e?(this.orderRoomDetail.showAddtionPay||(this.reserveLabel.newVal="",this.orderRoomDetail.incomeMoneyType=this.incomeFeeTypeList.length>0?this.incomeFeeTypeList[0].feeTypeId:"",this.orderRoomDetail.incomeReceiveType=this.incomeOrPayList.length>0?this.incomeOrPayList[0].val:"",this.orderRoomDetail.incomeChoiceRoom=this.roomLimitTypeList.length>0?this.roomLimitTypeList[0].dailyRoomId:"",this.orderRoomDetail.incomePayType=this.incomePayTypeList.length>0?this.incomePayTypeList[0].dailyDetailPayTypeId:""),this.orderRoomDetail.showAddtionPay=!this.orderRoomDetail.showAddtionPay):"editRoom"==e?(this.roomLiveInfo.showAddtionPay||(this.roomLiveInfo.incomeMoney="",this.reserveLabel.newVal="",this.roomLiveInfo.incomeMoneyType=this.incomeFeeTypeList.length>0?this.incomeFeeTypeList[0].feeTypeId:"",this.roomLiveInfo.incomeReceiveType=this.incomeOrPayList.length>0?this.incomeOrPayList[0].val:"",this.roomLiveInfo.incomeChoiceRoom=this.roomLimitTypeList.length>0?this.roomLimitTypeList[0].dailyRoomId:"",this.roomLiveInfo.incomePayType=this.incomePayTypeList.length>0?this.incomePayTypeList[0].dailyDetailPayTypeId:""),this.roomLiveInfo.showAddtionPay=!this.roomLiveInfo.showAddtionPay,this.changeRoomTypeVal(0,"editRoom")):"exitRoom"==e&&(this.roomExitInfo.showAddtionPay||(this.roomLiveInfo.incomeMoney="",this.reserveLabel.newVal="",this.roomLiveInfo.incomeMoneyType=this.incomeFeeTypeList.length>0?this.incomeFeeTypeList[0].feeTypeId:"",this.roomLiveInfo.incomeReceiveType=this.incomeOrPayList.length>0?this.incomeOrPayList[0].val:"",this.roomLiveInfo.incomeChoiceRoom=this.roomLimitTypeList.length>0?this.roomLimitTypeList[0].dailyRoomId:"",this.roomLiveInfo.incomePayType=this.incomePayTypeList.length>0?this.incomePayTypeList[0].dailyDetailPayTypeId:""),this.roomExitInfo.showAddtionPay=!this.roomExitInfo.showAddtionPay,this.changeRoomTypeVal(0,"exitRoom")),this.getMoneyDayList(e)},openDialogReserveLabel(){this.reserveLabel.type="",this.reserveLabel.originVal=this.reserveLabel.newVal,this.reserveLabel.isInsert=!0,this.dialogReserveLabel=!0},closeDialogReserveLabel(){this.reserveLabel.newVal=this.reserveLabel.originVal,this.dialogReserveLabel=!1},getCardTypeList(){this.$http.get("/api/contract/card_types").then(e=>{var t=e.data;0==t.errorCode&&(this.cardTypeList=t.data||[])}).catch(function(e){console.log(e)})},getIncomeFeeTypeList(){this.$http.get("/api/daily/setting/getFeeTypeList").then(e=>{var t=e.data;0==t.errorCode&&(this.incomeFeeTypeList=t.data||[],this.getIncomeOrPayList("detailRoom",this.incomeFeeTypeList[0].feeTypeId))}).catch(function(e){console.log(e)})},changeIncomeFeeVal(e){this.getIncomeAddtionFeeList(e);var t="";switch(e){case"editRoom":t=this.roomLiveInfo.incomeMoneyType;break;case"detailRoom":t=this.orderRoomDetail.incomeMoneyType;break;default:}this.getIncomeOrPayList(e,t)},changeIncomePayType(e){switch(e){case"editRoom":this.roomLiveInfo.showPayType=1!==this.roomLiveInfo.incomeMoneyType&&2!=this.roomLiveInfo.incomeMoneyType||1!=this.roomLiveInfo.incomeReceiveType,this.roomLiveInfo.showPayType?(this.roomLiveInfo.incomePayType=this.roomLiveInfo.oldPayType||this.incomePayTypeList[0].dailyDetailPayTypeId,this.roomLiveInfo.oldPayType="",this.changeAddtionPayType(e)):(this.roomLiveInfo.oldPayType=this.roomLiveInfo.incomePayType,this.roomLiveInfo.incomePayType="",this.roomLiveInfo.showPayNo=!1);break;case"detailRoom":this.orderRoomDetail.showPayType=1!==this.orderRoomDetail.incomeMoneyType&&2!=this.orderRoomDetail.incomeMoneyType||1!=this.orderRoomDetail.incomeReceiveType,this.orderRoomDetail.showPayType?(this.orderRoomDetail.incomePayType=this.orderRoomDetail.oldPayType||this.incomePayTypeList[0].dailyDetailPayTypeId,this.orderRoomDetail.oldPayType="",this.changeAddtionPayType(e)):(this.orderRoomDetail.oldPayType=this.orderRoomDetail.incomePayType,this.orderRoomDetail.incomePayType="",this.orderRoomDetail.showPayNo=!1);break;default:}},getIncomeAddtionFeeList(e){this.$http.get("/api/daily/setting/getConsumptionFeeTypeList").then(t=>{var o=t.data;if(0==o.errorCode&&(this.incomeAddtionFeeList=o.data||[],this.incomeAddtionFeeList.length>0))switch(e){case"editRoom":this.roomLiveInfo.incomeAddtionMoneyType=this.incomeAddtionFeeList[0].detailFeeTypeId;break;case"detailRoom":this.orderRoomDetail.incomeAddtionMoneyType=this.incomeAddtionFeeList[0].detailFeeTypeId;break;default:}}).catch(function(e){console.log(e)})},getIncomeOrPayList(e,t){this.$http.get("/api/daily/order/public/findDetailStatus",{params:{dailyDetailParentTypeId:t}}).then(o=>{var i=o.data;if(0==i.errorCode&&(this.incomeOrPayList=i.data||[],this.incomeOrPayList.length>0))switch(e){case"editRoom":this.roomLiveInfo.incomeReceiveType=this.incomeOrPayList[0].val,this.roomLiveInfo.showPayType=1!==t&&2!=t||1!=this.incomeOrPayList[0].val,this.roomLiveInfo.showPayType?this.roomLiveInfo.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId:this.roomLiveInfo.incomePayType="",this.roomLiveInfo.showPayNo=!1;break;case"detailRoom":this.orderRoomDetail.incomeReceiveType=this.incomeOrPayList[0].val,this.orderRoomDetail.showPayType=1!==t&&2!=t||1!=this.incomeOrPayList[0].val,this.orderRoomDetail.showPayType?this.orderRoomDetail.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId:this.orderRoomDetail.incomePayType="",this.orderRoomDetail.showPayNo=!1;break;default:}}).catch(function(e){console.log(e)})},getIncomePayTypeList(){this.$http.get("/api/daily/order/public/findPayTypies").then(e=>{var t=e.data;0==t.errorCode&&(this.incomePayTypeList=t.data||[])}).catch(function(e){console.log(e)})},getNoRoomTypeList(){this.$http.get("/api/daily/room_type/list",{params:{dailyRentalId:this.orderSearchInfo.projectId}}).then(e=>{var t=e.data;0==t.errorCode&&(this.roomTypeList=t.data||[])}).catch(function(e){console.log(e)})},getLiveRoomTypeList(e,t,o,i){this.$http.get("/api/daily/room_type/room_list",{params:{dailyRentalId:this.orderSearchInfo.projectId,dailyRoomTypeId:this.orderDetailInfo.dailyRoomTypeId,dailyOrderRoomId:"",startDate:t,endDate:o,type:i}}).then(t=>{var o=t.data;if(0==o.errorCode){var i=o.data||[];this.roomLimitTypeList=[];for(var a="",s=0;s<i.length;s++)i[s].dailyRoomId==this.roomManageInfo.dailyRoomId&&(a=i[s].dailyRoomTypeId);this.livePersonList[e].optionRooms=i||[],this.livePersonList[e].roomTypeId=a;for(s=0;s<this.livePersonList.length;s++)for(var r=0;r<this.livePersonList[s].optionRooms.length;r++)if(this.livePersonList[s].optionRooms[r].dailyRoomId==this.livePersonList[s].roomType){var n=this.livePersonList[s].optionRooms[r];this.roomLimitTypeList.push(n)}if(this.roomLimitTypeList.length>0&&(this.roomLiveInfo.incomeChoiceRoom=this.roomLimitTypeList[0].dailyRoomId),"distributeRoom"==this.roomManageInfo.manageType){for(s=0;s<this.livePersonList.length;s++)this.livePersonList[s].optionRooms=i||[];this.livePersonList[0].roomType=this.livePersonList[0].optionRooms[0].dailyRoomId}}}).catch(function(e){console.log(e)})},getRoomTypeList(e){this.$http.get("/api/daily/room_type/room_list",{params:{dailyRoomTypeId:this.orderDetailInfo.dailyRoomTypeId}}).then(t=>{var o=t.data;if(0==o.errorCode){this.roomTypeList=o.data||[],this.roomLimitTypeList=[];for(var i="",a=0;a<this.roomTypeList.length;a++)this.roomTypeList[a].dailyRoomId==this.orderRoomDetail.dailyRoomId&&(i=this.roomTypeList[a].dailyRoomTypeId);switch(e){case"reserve":for(a=0;a<this.roomOrderList.length;a++)for(var s=0;s<this.roomTypeList.length;s++)if(this.roomTypeList[s].dailyRoomId==this.roomOrderList[a].roomType){var r=this.roomTypeList[s];this.roomLimitTypeList.push(r),this.roomReserveInfo.incomeChoiceRoom=r.dailyRoomId}this.roomOrderList[0].roomTypeId=i;break;case"liveRoom":for(a=0;a<this.roomTypeList.length;a++)if(this.roomTypeList[a].dailyRoomId==this.orderRoomDetail.dailyRoomId){r=this.roomTypeList[a];this.roomLimitTypeList.push(r),this.roomLiveInfo.incomeChoiceRoom=r.dailyRoomId}this.livePersonList[0].roomTypeId=i;break;case"exitRoom":for(a=0;a<this.roomTypeList.length;a++)if(this.roomTypeList[a].dailyRoomId==this.orderRoomDetail.dailyRoomId){r=this.roomTypeList[a];this.roomLimitTypeList.push(r),this.roomLiveInfo.incomeChoiceRoom=r.dailyRoomId}this.livePersonList[0].roomTypeId=i;break;case"orderDetail":break;default:}}}).catch(function(e){console.log(e)})},saveDialogReserveLabel(){this.reserveLabel.originVal!=this.reserveLabel.newVal&&("orderDetail"==this.reserveLabel.type||"cancelOrder"==this.reserveLabel.type||"editRoom"==this.reserveLabel.type||"exitRoom"==this.reserveLabel.type)?this.$http.post("/api/daily/order/detailInfo",{dailyOrderDetailId:this.reserveLabel.dailyOrderDetailId,info:this.reserveLabel.newVal}).then(e=>{var t=e.data;0==t.errorCode&&(this.$message({type:"success",message:"备注修改成功!"}),this.dialogReserveLabel=!1,this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId),this.reserveLabel.type="")}).catch(function(e){console.log(e)}):this.dialogReserveLabel=!1},saveOrderIncome(e){var t={};switch(e){case"orderDetail":if(0==this.orderRoomDetail.incomeMoney)return this.$message({message:"请输入金额!",type:"error"});t.dailyRentalId=this.orderSearchInfo.projectId,t.dailyOrderId=this.orderRoomDetail.dailyOrderId,t.dailyRoomId=this.orderRoomDetail.incomeChoiceRoom,t.info=this.reserveLabel.newVal,t.dailyDetailTypeId=this.orderRoomDetail.incomeMoneyType==this.otherFeeTypeVal?this.orderRoomDetail.incomeAddtionMoneyType:"",t.dailyDetailParentTypeId=this.orderRoomDetail.incomeMoneyType,t.amount=this.orderRoomDetail.incomeMoney,t.payType=this.orderRoomDetail.incomePayType,t.payNo=this.orderRoomDetail.payNo,t.status=this.orderRoomDetail.incomeReceiveType,this.$http.post("/api/daily/order/income",t).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"添加成功!",type:"success"}),this.orderRoomDetail.showAddtionPay=!1,this.orderRoomDetail.payNo="",this.enterOrderDetailMode(t.dailyOrderId))}).catch(function(e){console.log(e)});break;case"liveRoom":case"exitRoom":if(0==this.roomLiveInfo.incomeMoney)return this.$message({message:"请输入金额!",type:"error"});t.dailyRentalId=this.orderSearchInfo.projectId,t.dailyOrderId=this.roomLiveInfo.dailyOrderId,t.dailyRoomId=this.roomLiveInfo.incomeChoiceRoom,t.info=this.reserveLabel.newVal,t.dailyDetailTypeId=this.roomLiveInfo.incomeMoneyType==this.otherFeeTypeVal?this.roomLiveInfo.incomeAddtionMoneyType:"",t.dailyDetailParentTypeId=this.roomLiveInfo.incomeMoneyType,t.amount=this.roomLiveInfo.incomeMoney,t.payType=this.roomLiveInfo.incomePayType,t.payNo=this.roomLiveInfo.payNo,t.status=this.roomLiveInfo.incomeReceiveType,this.$http.post("/api/daily/order/income",t).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"添加成功!",type:"success"}),this.roomLiveInfo.payNo="",this.roomExitInfo.showAddtionPay=!1,this.enterOrderDetailMode(t.dailyOrderId))}).catch(function(e){console.log(e)});break;default:}},deleteOrderRoom(e){this.$confirm("是否删除该数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$http.post("/api/daily/order/detailDelete",{dailyOrderDetailId:e.dailyDetailId,info:e.label}).then(e=>{var t=e.data;0==t.errorCode&&(this.$message({type:"success",message:"删除成功!"}),this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId),"exitRoom"==this.roomManageInfo.manageType&&this.exitRoomOrder())}).catch(function(e){console.log(e)})}).catch(()=>{})},getReceiveMoney(e){this.receiveMoneyInfo.dailyOrderDetailId=e.dailyDetailId,this.receiveMoneyInfo.payType=e.payType||(this.incomePayTypeList.length>0?this.incomePayTypeList[0].dailyDetailPayTypeId:""),this.receiveMoneyInfo.money=e.money||0,this.receiveMoneyInfo.label="",this.dialogIncomeMoney=!0},comfirmSubmitReceiveMoney(){this.$http.post("/api/daily/order/paid",{dailyOrderDetailId:this.receiveMoneyInfo.dailyOrderDetailId,info:this.receiveMoneyInfo.label,payType:this.receiveMoneyInfo.payType}).then(e=>{var t=e.data;0==t.errorCode&&(this.$message({type:"success",message:"收款成功!"}),this.dialogIncomeMoney=!1,this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId))}).catch(function(e){console.log(e)})},getBackMoney(e){this.exitMoneyInfo.refundDetailId=e.dailyDetailId,this.exitMoneyInfo.money=e.money||0,this.exitMoneyInfo.payType=e.payType||(this.incomePayTypeList.length>0?this.incomePayTypeList[0].dailyDetailPayTypeId:""),this.exitMoneyInfo.status="2",this.exitMoneyInfo.label="",this.dialogExitMoney=!0},comfirmSubmitExitMoney(){this.$http.post("/api/daily/order/refund",{refundDetailId:this.exitMoneyInfo.refundDetailId,info:this.exitMoneyInfo.label,amount:this.exitMoneyInfo.money,payType:this.exitMoneyInfo.payType,status:this.exitMoneyInfo.status}).then(e=>{var t=e.data;0==t.errorCode&&(this.$message({type:"success",message:"退款成功!"}),this.dialogExitMoney=!1,this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId))}).catch(function(e){console.log(e)})},cancelRoomOrder(){this.dialogCancelOrder=!0,this.orderBackMoneyTable=[],this.cancelOrder.money="",this.cancelOrder.payType="",this.cancelOrder.label="",this.cancelOrder.reason="";for(var e=0;e<this.orderReserveTable.length;e++)2==this.orderReserveTable[e].income&&this.orderBackMoneyTable.push(this.orderReserveTable[e]);this.getCancelOrderReasonList()},getCancelOrderReasonList(){this.$http.get("/api/daily/order/public/findClosedTypies").then(e=>{var t=e.data;0==t.errorCode&&(this.cancelOrderReasonList=t.data||[],this.cancelOrderReasonList.length>0&&(this.cancelOrder.reason=this.cancelOrderReasonList[0].dailyOrderClosedId))}).catch(function(e){console.log(e)})},comfirmSubmitCancelOrder(){this.$http.post("/api/daily/order/close",{dailyOrderId:this.orderRoomDetail.dailyOrderId,info:this.cancelOrder.label,closedId:this.cancelOrder.reason}).then(e=>{var t=e.data;0==t.errorCode&&(this.$message({message:"取消成功!",type:"success"}),this.dialogCancelOrder=!1,this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId),this.searchOrderListTable())})},comfirmSubmitCancelDistribute(){this.$http.post("/api/daily/order/unassigned",{dailyOrderId:this.orderRoomDetail.dailyOrderId}).then(e=>{var t=e.data;0==t.errorCode&&(this.$message({message:"取消成功!",type:"success"}),this.dialogCancelDistribute=!1,this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId),this.searchOrderListTable())}).catch(function(e){console.log(e)})},enterDistributeRoom(){this.roomManageInfo.manageTypeName="立即分房",this.roomManageInfo.manageType="distributeRoom",this.roomOriginList=this.$refs.originList.roomOriginList||[],this.enterRoomManage()},enterRoomManage(){this.livePersonList=[],this.roomLiveInfo.dailyOrderId=this.orderRoomDetail.dailyOrderId,this.roomLiveInfo.orderNo=this.orderRoomDetail.orderNo,this.roomLiveInfo.dailyOrderSourceId=this.orderRoomDetail.dailyOrderSourceId,this.roomLiveInfo.label=this.orderRoomDetail.label,this.roomLiveInfo.roomTotalPrice=this.orderRoomDetail.roomTotalPrice,this.roomLiveInfo.orderTotalMoney=this.orderRoomDetail.orderTotalMoney,this.roomLiveInfo.receiveMoney=this.orderRoomDetail.receiveMoney,this.roomLiveInfo.needMoney=this.orderRoomDetail.needMoney,this.roomLiveInfo.origin=this.orderRoomDetail.dailyOrderSourceId,this.roomLiveInfo.showAddtionPay=!1,this.roomLiveInfo.roomStatus=this.orderRoomDetail.roomStatus||{},this.roomLiveInfo.personStatus=this.orderRoomDetail.personStatus||{};var e=[];e=JSON.parse(JSON.stringify(this.roomPriceTypeList));for(var t=0;t<this.orderPersonList.length;t++){for(var o=[],i=0;i<this.orderPersonList[t].customers.length;i++)o.push({name:this.orderPersonList[t].customers[i].name,phone:this.orderPersonList[t].customers[i].tel,cardType:this.orderPersonList[t].customers[i].cardType,cardNo:this.orderPersonList[t].customers[i].cardNo});var a=[];for(i=0;i<this.orderPersonList[t].prices.length;i++)a.push({date:this.orderPersonList[t].prices[i].time,price:this.orderPersonList[t].prices[i].price});this.livePersonList.push({persons:o,startData:this.orderPersonList[t].startDate,retentionTime:this.orderPersonList[t].retentionTime,leaveData:this.orderPersonList[t].endDate,night:this.orderPersonList[t].nights,roomType:this.orderPersonList[t].dailyRoomId,optionRooms:this.orderPersonList[t].optionRooms,priceSpecs:this.orderPersonList[t].priceSpecs||e[0].dailySalesChanelId,priceSpecsList:e,roomTypeId:this.orderPersonList[t].dailyRoomTypeId,price:this.orderPersonList[t].roomAmount/this.orderPersonList[t].nights,priceDataList:a,roomStatus:this.orderPersonList[t].roomStatus&&""!=this.orderPersonList[t].roomStatus.val?this.orderPersonList[t].roomStatus.val:""})}"distributeRoom"==this.roomManageInfo.manageType&&this.getLiveRoomTypeList(0,this.livePersonList[0].startData,this.livePersonList[0].leaveData,"2"),this.calculateRoomPrice("-1"),this.dialogInsertLive=!0},insertNewRoomList(){for(var e=0;e<this.roomTypeList.length;e++)this.roomTypeList[e].dailyRoomId==this.orderDetailInfo.dailyRoomId&&this.roomTypeList[e].dailyRoomTypeId;this.livePersonList.push({persons:[{name:"",phone:"",cardType:this.livePersonList[0].persons[0].cardType,cardNo:""}],startData:this.livePersonList[this.livePersonList.length-1].startData,retentionTime:"",leaveData:this.livePersonList[this.livePersonList.length-1].leaveData,night:this.livePersonList[this.livePersonList.length-1].night,roomType:this.livePersonList[this.livePersonList.length-1].roomType,optionRooms:this.livePersonList[this.livePersonList.length-1].optionRooms,priceSpecs:this.livePersonList[this.livePersonList.length-1].priceSpecs,priceSpecsList:this.livePersonList[this.livePersonList.length-1].priceSpecsList,roomTypeId:this.livePersonList[this.livePersonList.length-1].roomTypeId,roomStatus:this.livePersonList[this.livePersonList.length-1].roomStatus,price:this.livePersonList[this.livePersonList.length-1].price,priceDataList:this.livePersonList[this.livePersonList.length-1].priceDataList}),this.changeRoomTypeVal(0,"editRoom"),this.calculateRoomPrice(-1)},removeNewRoomList(e){this.livePersonList.length>1&&(this.livePersonList.splice(e,1),this.changeRoomTypeVal(0,"editRoom"))},calculateRoomPrice(e=-1){if(-1!=e){var t=this.livePersonList[e];t.leaveData=Object(n["h"])("next",t.startData,t.night),this.$set(this.livePersonList,e,t),this.getLiveRoomTypeList(e,t.startData,t.leaveData,"distributeRoom"==this.roomManageInfo.manageType?1:2)}for(var o=0,i=0;i<this.livePersonList.length;i++)o+=this.livePersonList[i].night*this.livePersonList[i].price;this.roomLiveInfo.roomTotalPrice=Math.round(100*Number(o))/100,this.roomLiveInfo.orderTotalMoney=this.roomLiveInfo.roomTotalPrice,this.calculatePayAndNeedMoney()},changeRoomNigihtVal(e){var t=this.livePersonList[e];t.leaveData=Object(n["h"])("next",t.startData,t.night),this.livePersonList[e]=t,this.changeDayRoomPriceVal("editRoom",e)},calculatePayAndNeedMoney(){for(var e=0,t=0,o=0,i=0,a=0,s=0,r=0;r<this.orderReserveTable.length;r++)2==this.orderReserveTable[r].income?("收押金"!=this.orderReserveTable[r].moneyTypeName&&(e+=this.orderReserveTable[r].money),"收房费"==this.orderReserveTable[r].moneyTypeName?o+=this.orderReserveTable[r].money:"收押金"==this.orderReserveTable[r].moneyTypeName&&(t+=this.orderReserveTable[r].money)):1==this.orderReserveTable[r].income?i+=this.orderReserveTable[r].money:("退押金"!=this.orderReserveTable[r].moneyTypeName&&(a+=this.orderReserveTable[r].money),"退房费"!=this.orderReserveTable[r].moneyTypeName&&"退押金"!=this.orderReserveTable[r].moneyTypeName&&(s+=this.orderReserveTable[r].money),"退押金"==this.orderReserveTable[r].moneyTypeName&&(t-=this.orderReserveTable[r].money));this.roomLiveInfo.orderTotalMoney=this.roomLiveInfo.roomTotalPrice+e+i-o-s,this.roomLiveInfo.receiveMoney=e-a,this.roomLiveInfo.roomDepositMoney=t,this.roomLiveInfo.needMoney=this.roomLiveInfo.orderTotalMoney-this.roomLiveInfo.receiveMoney,this.getMoneyDayList("editRoom")},comfirmSubmitDirectLive(){for(var e=[],t=[],o=0;o<this.livePersonList.length;o++){for(var i=[],a=[],s=0;s<this.livePersonList[o].priceDataList.length;s++)i.push({time:this.livePersonList[o].priceDataList[s].date,price:"handle"==this.livePersonList[o].priceSpecs?this.livePersonList[o].price:this.livePersonList[o].priceDataList[s].price});for(s=0;s<this.livePersonList[o].persons.length;s++){if(""==this.livePersonList[o].persons[s].name||void 0==this.livePersonList[o].persons[s].name)return this.$message({type:"error",message:"姓名不能为空!"});if(""==this.livePersonList[o].persons[s].phone||void 0==this.livePersonList[o].persons[s].phone)return this.$message({type:"error",message:"手机号码不能为空!"});if(""==this.livePersonList[o].persons[s].cardNo||void 0==this.livePersonList[o].persons[s].cardNo)return this.$message({type:"error",message:"证件号码不能为空!"});a.push({name:this.livePersonList[o].persons[s].name,tel:this.livePersonList[o].persons[s].phone,cardType:this.livePersonList[o].persons[s].cardType,cardNo:this.livePersonList[o].persons[s].cardNo})}var r="";for(s=0;s<this.roomPriceTypeList.length;s++)this.roomPriceTypeList[s].dailySalesChanelId==this.livePersonList[o].priceSpecs&&(r=this.roomPriceTypeList[s].chanelName);if("distributeRoom"==this.roomManageInfo.manageType||"liveRoom"==this.roomManageInfo.manageType||"editRoom"==this.roomManageInfo.manageType){var n="";"distributeRoom"==this.roomManageInfo.manageType?(n=2,e.push({startDate:this.livePersonList[o].startData,retentionTime:this.livePersonList[o].retentionTime,endDate:this.livePersonList[o].leaveData,dailyRoomTypeId:this.livePersonList[o].roomTypeId,dailyRoomId:this.livePersonList[o].roomType,roomNum:this.livePersonList[o].night,customers:a,roomStatus:n||this.livePersonList[o].roomStatus,priceSpecs:"handle"==this.livePersonList[o].priceSpecs?"-1":this.livePersonList[o].priceSpecs,priceSpecsName:r,prices:i})):"liveRoom"==this.roomManageInfo.manageType?(n=3,e.push({startDate:this.livePersonList[o].startData,endDate:this.livePersonList[o].leaveData,dailyRoomTypeId:this.livePersonList[o].roomTypeId,dailyRoomId:this.livePersonList[o].roomType,roomNum:this.livePersonList[o].night,customers:a,roomStatus:n||this.livePersonList[o].roomStatus,priceSpecs:"handle"==this.livePersonList[o].priceSpecs?"-1":this.livePersonList[o].priceSpecs,priceSpecsName:r,prices:i})):e.push({startDate:this.livePersonList[o].startData,endDate:this.livePersonList[o].leaveData,dailyRoomTypeId:this.livePersonList[o].roomTypeId,dailyRoomId:this.livePersonList[o].roomType,roomNum:this.livePersonList[o].night,customers:a,roomStatus:n||this.livePersonList[o].roomStatus,priceSpecs:"handle"==this.livePersonList[o].priceSpecs?"-1":this.livePersonList[o].priceSpecs,priceSpecsName:r,prices:i})}}for(o=0;o<this.orderReserveTable.length;o++)t.push({dailyRentalId:this.orderReserveTable[o].roomDailyRentalId,dailyRoomId:this.orderReserveTable[o].roomDailyRoomId,dailyDetailTypeId:this.orderReserveTable[o].roomDailyDetailTypeId,amount:this.orderReserveTable[o].money,payType:this.orderReserveTable[o].payType,info:this.orderReserveTable[o].label,status:this.orderReserveTable[o].income});var l={dailyRentalId:this.orderSearchInfo.projectId,sourceId:this.roomLiveInfo.origin,info:this.roomLiveInfo.label,rooms:e,incomes:t},c="",d="";"distributeRoom"==this.roomManageInfo.manageType||"liveRoom"==this.roomManageInfo.manageType?(c="/api/daily/order/create",d="入住成功!"):"editRoom"==this.roomManageInfo.manageType&&(c="/api/daily/order/update",l.dailyOrderId=this.roomLiveInfo.dailyOrderId,d="修改成功!"),this.$http.post(c,l).then(e=>{var t=e.data;0==t.errorCode&&(this.$message({message:d,type:"success"}),this.dialogInsertLive=!1,this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId),this.searchOrderListTable())}).catch(function(e){console.log(e)})},dialogShowRoomPerson(e,t,o){this.personShow.List=t,this.personShow.from=e,this.personShow.index=o,this.dialogAddRoomPerson=!0},insertPersonDialog(){this.personShow.List.push({name:"",phone:"",cardType:this.personShow.List[0].cardType,cardNo:""})},dialogHideRoomPerson(){for(var e=0;e<this.personShow.List.length;e++){if(""==this.personShow.List[e].name||void 0==this.personShow.List[e].name)return this.$message({type:"error",message:"入住人姓名不能为空!"});if(""==this.personShow.List[e].phone||void 0==this.personShow.List[e].phone)return this.$message({type:"error",message:"入住人手机号码不能为空!"});if(""==this.personShow.List[e].cardNo||void 0==this.personShow.List[e].cardNo)return this.$message({type:"error",message:"入住人证件号码不能为空!"})}switch(this.personShow.from){case"dialogInsertLive":this.livePersonList[this.personShow.index].persons=this.personShow.List;break;default:}this.dialogAddRoomPerson=!1},deletePersonDialog(e){this.personShow.List.length>1&&this.personShow.List.splice(e,1)},enterLiveRoomOrder(){this.roomManageInfo.manageTypeName="办理入住",this.roomManageInfo.manageType="liveRoom",this.roomOriginList=this.$refs.originList.roomOriginList||[],this.enterRoomManage()},changeReserveEnterData(e){switch(this.roomManageInfo.manageType){case"distributeRoom":var t=this.livePersonList[e];Object(n["i"])(t.startData,t.leaveData)<0?t.leaveData=Object(n["h"])("next",t.startData,t.night):t.night=Object(n["i"])(t.startData,t.leaveData);var o=t.retentionTime.substring(11);t.retentionTime=t.startData+" "+o,this.$set(this.livePersonList,e,t);break;case"reserve":case"editRoom":case"liveRoom":t=this.livePersonList[e];Object(n["i"])(t.startData,t.leaveData)<0?t.leaveData=Object(n["h"])("next",t.startData,t.night):t.night=Object(n["i"])(t.startData,t.leaveData),this.$set(this.livePersonList,e,t);break;default:}this.changeDayRoomPriceVal("editRoom",e)},changeReserveLeaveData(e){switch(this.roomManageInfo.manageType){case"distributeRoom":var t=this.livePersonList[e];Object(n["i"])(t.startData,t.leaveData)<0?t.leaveData=Object(n["h"])("next",t.startData,t.night):t.night=Object(n["i"])(t.startData,t.leaveData),this.$set(this.livePersonList,e,t);break;case"editRoom":case"liveRoom":t=this.livePersonList[e];Object(n["i"])(t.startData,t.leaveData)<0?t.leaveData=Object(n["h"])("next",t.startData,t.night):t.night=Object(n["i"])(t.startData,t.leaveData),this.$set(this.livePersonList,e,t);break;default:}this.changeDayRoomPriceVal("editRoom",e)},changeRoomTypeVal(e=0,t){switch(t){case"editRoom":for(var o="",i=0;i<this.livePersonList[e].optionRooms.length;i++)this.livePersonList[e].optionRooms[i].dailyRoomId==this.livePersonList[e].roomType&&(o=this.livePersonList[e].optionRooms[i].dailyRoomTypeId);this.livePersonList[e].roomTypeId=o,this.roomTypeTransform(this.livePersonList),this.roomLiveInfo.incomeChoiceRoom=this.roomLimitTypeList.length>0?this.roomLimitTypeList[0].dailyRoomId:"";break;default:}this.getMoneyDayList(t)},roomTypeTransform(e){this.roomLimitTypeList=[];for(var t=0;t<e.length;t++)for(var o=0;o<e[t].optionRooms.length;o++)if(e[t].optionRooms[o].dailyRoomId==e[t].roomType){for(var i=!0,a=0;a<this.roomLimitTypeList.length;a++)e[t].optionRooms[o].dailyRoomId==this.roomLimitTypeList[a].dailyRoomId&&(i=!1);if(i){var s=e[t].optionRooms[o];this.roomLimitTypeList.push(s)}}},editRoomOrder(){this.roomManageInfo.manageTypeName="修改订单",this.roomManageInfo.manageType="editRoom",this.roomOriginList=this.$refs.originList.roomOriginList||[],this.enterRoomManage()},exitRoomOrder(){this.roomManageInfo.manageTypeName="办理退房",this.roomManageInfo.manageType="exitRoom",this.exitPersonList=[],this.roomLiveInfo.dailyOrderId=this.orderRoomDetail.dailyOrderId,this.roomLiveInfo.orderNo=this.orderRoomDetail.orderNo,this.roomLiveInfo.dailyOrderSourceId=this.orderRoomDetail.dailyOrderSourceId,this.roomLiveInfo.label=this.orderRoomDetail.label,this.roomLiveInfo.roomTotalPrice=this.orderRoomDetail.roomTotalPrice,this.roomLiveInfo.orderTotalMoney=this.orderRoomDetail.orderTotalMoney,this.roomLiveInfo.roomDepositMoney=this.orderRoomDetail.roomDepositMoney,this.roomLiveInfo.receiveMoney=this.orderRoomDetail.receiveMoney,this.roomLiveInfo.needMoney=this.orderRoomDetail.needMoney,this.roomLiveInfo.origin=this.orderRoomDetail.dailyOrderSourceId,this.roomExitInfo.showAddtionPay=!1,this.roomLiveInfo.roomStatus=this.orderRoomDetail.roomStatus||{},this.roomLiveInfo.personStatus=this.orderRoomDetail.personStatus||{};for(var e=0;e<this.orderPersonList.length;e++){var t=this.orderPersonList[e];t.roomStatus&&3==t.roomStatus.val&&(t.isChecked=!0,this.exitPersonList.push(t))}this.roomLimitTypeList=[];var o=[];for(e=0;e<this.orderPersonList.length;e++)-1==o.indexOf(this.orderPersonList[e].dailyRoomId)&&(o.push(this.orderPersonList[e].dailyRoomId),this.roomLimitTypeList.push({dailyRoomName:this.orderPersonList[e].dailyRoomName,dailyRoomId:this.orderPersonList[e].dailyRoomId,dailyRoomTypeId:this.orderPersonList[e].dailyRoomTypeId}));this.roomExitInfo.depositDeduct=!0,this.dialogExitRoom=!0},changeExitPersonChoice(e){var t=this.exitPersonList[e];this.$set(this.exitPersonList,e,t)},comfirmClearAndExitRoom(){for(var e=[],t=0;t<this.exitPersonList.length;t++)this.exitPersonList[t].isChecked&&e.push(this.exitPersonList[t].dailyOrderRoomId);if(0==e.length)return this.$message({message:"请选择要退的房间!",type:"error"});var o=this.roomExitInfo.depositDeduct?this.roomLiveInfo.needMoney-this.roomLiveInfo.roomDepositMoney>=0?"需补交":"需退回":this.roomLiveInfo.needMoney>=0?"需补交":"需退回",i=this.roomExitInfo.depositDeduct?Math.abs(this.roomLiveInfo.needMoney-this.roomLiveInfo.roomDepositMoney||"0"):Math.abs(this.roomLiveInfo.needMoney||"0");this.$confirm(`当前订单<span style="color: #ff0000;">${o}${i}元</span>，是否结账退房`,"提示",{dangerouslyUseHTMLString:!0,distinguishCancelAndClose:!0,confirmButtonText:"结账退房",cancelButtonText:"取消"}).then(()=>{this.$http.post("/api/daily/order/checkout",{dailyOrderId:this.roomLiveInfo.dailyOrderId,sourceId:this.roomLiveInfo.origin,info:this.roomLiveInfo.label,orderRoomIds:e,depositDeduct:this.roomExitInfo.depositDeduct?"1":"2"}).then(e=>{var t=e.data;0==t.errorCode&&(this.$message({message:"退房成功!",type:"success"}),this.dialogExitRoom=!1,this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId),this.searchOrderListTable())})}).catch(e=>{})},openDialogSettleAccounts(){this.settleAccount.originVal=this.settleAccount.newVal,this.dialogReserveSettleAccounts=!0},closeDialogSettleAccounts(){this.settleAccount.newVal=this.settleAccount.originVal,this.dialogReserveSettleAccounts=!1},changeAddtionPayType(e){var t=!0;switch(this.settleAccount.type=e,e){case"liveRoom":for(var o=0;o<this.incomePayTypeList.length;o++)this.roomLiveInfo.incomePayType==this.incomePayTypeList[o].dailyDetailPayTypeId&&(t=!1,this.roomLiveInfo.showPayNo=!(!this.incomePayTypeList[o].type||2!=this.incomePayTypeList[o].type.val));t||(this.roomLiveInfo.payNo="");break;case"orderDetail":for(o=0;o<this.incomePayTypeList.length;o++)this.orderRoomDetail.incomePayType==this.incomePayTypeList[o].dailyDetailPayTypeId&&(t=!1,this.orderRoomDetail.showPayNo=!(!this.incomePayTypeList[o].type||2!=this.incomePayTypeList[o].type.val));t||(this.orderRoomDetail.payNo="");break;default:}},saveDialogSettleAccounts(){switch(this.settleAccount.type){case"liveRoom":this.roomLiveInfo.payNo=this.settleAccount.newVal;break;case"orderDetail":this.orderRoomDetail.payNo=this.settleAccount.newVal;break;default:}this.dialogReserveSettleAccounts=!1},openDialogRemainTime(e,t){this.dialogRoomRemainTime=!0,this.remainTime.type=e,this.remainTime.index=t,this.remainTime.originVal=this.remainTime.newVal="distributeDetail"==e&&this.livePersonList[t].retentionTime||this.currentData+" 12:00:00"},closeDialogRemainTime(){this.dialogRoomRemainTime=!1,this.remainTime.newVal=this.remainTime.originVal},comfirmChoiceRemainTime(){"distributeDetail"==this.remainTime.type&&(this.livePersonList[this.remainTime.index].retentionTime=this.remainTime.newVal),this.dialogRoomRemainTime=!1},getMoneyDayList(e){var t=!1;switch(this.moneyChoiceDayList=[],e){case"reserve":this.roomReserveInfo.rentMoneyDay="";for(var o=0;o<this.roomOrderList.length;o++)this.roomReserveInfo.incomeChoiceRoom==this.roomOrderList[o].roomType&&(this.moneyDayInfo.startData=this.roomOrderList[o].startData,this.moneyDayInfo.endData=this.roomOrderList[o].leaveData,this.moneyDayInfo.roomPrice=this.roomOrderList[o].price,this.moneyDayInfo.dayCount=this.roomOrderList[o].night,t=!0);if(t){for(o=1;o<=this.moneyDayInfo.dayCount;o++)this.moneyChoiceDayList.push({text:o+"天",val:o});this.moneyChoiceDayList.push({text:"手动",val:"handle"}),this.roomReserveInfo.rentMoneyDay=this.moneyChoiceDayList[0].val,this.roomReserveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.moneyChoiceDayList[0].val,this.roomReserveInfo.moneyCanEidt=!1}break;case"editRoom":if(this.roomLiveInfo.rentMoneyDay="",this.dialogExitRoom)for(o=0;o<this.exitPersonList.length;o++)this.roomLiveInfo.incomeChoiceRoom==this.exitPersonList[o].dailyRoomId&&(this.moneyDayInfo.startData=this.exitPersonList[o].startDate,this.moneyDayInfo.endData=this.exitPersonList[o].endDate,this.moneyDayInfo.roomPrice=this.exitPersonList[o].roomAmount/this.exitPersonList[o].nights,this.moneyDayInfo.dayCount=this.exitPersonList[o].nights,t=!0);else for(var o=0;o<this.livePersonList.length;o++)this.roomLiveInfo.incomeChoiceRoom==this.livePersonList[o].roomType&&(this.moneyDayInfo.startData=this.livePersonList[o].startData,this.moneyDayInfo.endData=this.livePersonList[o].leaveData,this.moneyDayInfo.roomPrice=this.livePersonList[o].price,this.moneyDayInfo.dayCount=this.livePersonList[o].night,t=!0);if(t){for(o=1;o<=this.moneyDayInfo.dayCount;o++)this.moneyChoiceDayList.push({text:o+"天",val:o});this.moneyChoiceDayList.push({text:"手动",val:"handle"}),this.roomLiveInfo.rentMoneyDay=this.moneyChoiceDayList[0].val,this.roomLiveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.moneyChoiceDayList[0].val,this.roomLiveInfo.moneyCanEidt=!1}break;case"exitRoom":this.roomLiveInfo.rentMoneyDay="";for(o=0;o<this.exitPersonList.length;o++)this.roomLiveInfo.incomeChoiceRoom==this.exitPersonList[o].dailyRoomId&&(this.moneyDayInfo.startData=this.exitPersonList[o].startDate,this.moneyDayInfo.endData=this.exitPersonList[o].endDate,this.moneyDayInfo.roomPrice=this.exitPersonList[o].roomAmount/this.exitPersonList[o].nights,this.moneyDayInfo.dayCount=this.exitPersonList[o].nights,t=!0);if(t){for(o=1;o<=this.moneyDayInfo.dayCount;o++)this.moneyChoiceDayList.push({text:o+"天",val:o});this.moneyChoiceDayList.push({text:"手动",val:"handle"}),this.roomLiveInfo.rentMoneyDay=this.moneyChoiceDayList[0].val,this.roomLiveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.moneyChoiceDayList[0].val,this.roomLiveInfo.moneyCanEidt=!1}break;case"detailRoom":this.orderRoomDetail.rentMoneyDay="";for(o=0;o<this.orderPersonList.length;o++)this.orderRoomDetail.incomeChoiceRoom==this.orderPersonList[o].dailyRoomId&&(this.moneyDayInfo.startData=this.orderPersonList[o].startDate,this.moneyDayInfo.endData=this.orderPersonList[o].endDate,this.moneyDayInfo.roomPrice=this.orderPersonList[o].roomAmount/this.orderPersonList[o].nights,this.moneyDayInfo.dayCount=this.orderPersonList[o].nights,t=!0);if(t){for(o=1;o<=this.moneyDayInfo.dayCount;o++)this.moneyChoiceDayList.push({text:o+"天",val:o});this.moneyChoiceDayList.push({text:"手动",val:"handle"}),this.orderRoomDetail.rentMoneyDay=this.moneyChoiceDayList[0].val,this.orderRoomDetail.incomeMoney=this.moneyDayInfo.roomPrice*this.moneyChoiceDayList[0].val,this.orderRoomDetail.moneyCanEidt=!1}break;default:}},changeMoneyDayVal(e){switch(e){case"reserve":this.roomReserveInfo.rentMoneyDay&&"handle"!=this.roomReserveInfo.rentMoneyDay?(this.roomReserveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.roomReserveInfo.rentMoneyDay,this.roomReserveInfo.moneyCanEidt=!1):this.roomReserveInfo.moneyCanEidt=!0;break;case"editRoom":this.roomLiveInfo.rentMoneyDay&&"handle"!=this.roomLiveInfo.rentMoneyDay?(this.roomLiveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.roomLiveInfo.rentMoneyDay,this.roomLiveInfo.moneyCanEidt=!1):this.roomLiveInfo.moneyCanEidt=!0;break;case"exitRoom":this.roomLiveInfo.rentMoneyDay&&"handle"!=this.roomLiveInfo.rentMoneyDay?(this.roomLiveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.roomLiveInfo.rentMoneyDay,this.roomLiveInfo.moneyCanEidt=!1):this.roomLiveInfo.moneyCanEidt=!0;break;case"detailRoom":this.orderRoomDetail.rentMoneyDay&&"handle"!=this.orderRoomDetail.rentMoneyDay?(this.orderRoomDetail.incomeMoney=this.moneyDayInfo.roomPrice*this.orderRoomDetail.rentMoneyDay,this.orderRoomDetail.moneyCanEidt=!1):this.orderRoomDetail.moneyCanEidt=!0;break;default:}},changeDayRoomPriceVal(e,t){var o={};switch(e){case"editRoom":o.start=this.livePersonList[t].startData,o.end=this.livePersonList[t].leaveData,o.dailyRoomId=this.livePersonList[t].roomType,o.night=this.livePersonList[t].night,o.priceSpecs=this.livePersonList[t].priceSpecs;break;default:}this.getDayRoomPriceList(e,t,o)},getDayRoomPriceList(e,t,o){this.$http.get("/api/daily/room_type/room/prices",{params:{start:o.start,end:o.end,dailyRoomId:o.dailyRoomId,dailySalesChanelId:"handle"==o.priceSpecs?"":o.priceSpecs}}).then(o=>{var i=o.data;if(0==i.errorCode){for(var a=i.data||[],s=0,r=0;r<a.length;r++)s+=Number(a[r].price)||0;switch(e){case"editRoom":this.livePersonList[t].price=s/a.length;break;default:}this.livePersonList[t].priceDataList=a,this.calculateRoomPrice(t)}}).catch(function(e){console.log(e)})}}},c=l,d=(o("add1"),o("6691")),m=Object(d["a"])(c,i,a,!1,null,null,null);t["default"]=m.exports},9556:function(e,t,o){},add1:function(e,t,o){"use strict";var i=o("2490"),a=o.n(i);a.a},e7ba:function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"roomType"},[o("el-input",{attrs:{readonly:""},nativeOn:{click:function(t){return e.changeShowMode(t)}},model:{value:e.inputVal,callback:function(t){e.inputVal=t},expression:"inputVal"}}),o("transition",{attrs:{name:"el-zoom-in-top"}},[e.isShow?o("div",{staticClass:"show-tree"},[o("div",{staticClass:"origin-list-content"},[e._l(e.roomTypeList,function(t,i){return o("div",{key:i},[o("el-checkbox",{model:{value:t.isChecked,callback:function(o){e.$set(t,"isChecked",o)},expression:"item.isChecked"}},[e._v(" "+e._s(t.name))])],1)}),0==e.roomTypeList.length?o("div",{staticStyle:{"text-align":"center"}},[e._v("\n            暂无数据\n        ")]):e._e()],2),o("div",{staticClass:"deep-content"},[o("el-button",{staticClass:"greenBtn",attrs:{size:"small"},on:{click:e.cancelChoiceOrigin}},[e._v("取消")]),o("el-button",{staticClass:"el-button el-button--primary",attrs:{size:"small"},on:{click:e.comfirmChoiceOrigin}},[e._v("确定")])],1)]):e._e()])],1)},a=[],s={name:"roomType",data(){return{inputVal:"",isShow:!1,roomTypeList:[]}},props:["getRoomId","url"],created(){},watch:{getRoomId(){this.inputVal="",this.getRoomTypeList()}},mounted(){console.log(this.url),console.log(this.getRoomId)},methods:{changeShowMode(){this.isShow=!this.isShow},getRoomTypeList(){this.$http.get("/api/daily/room_type/list",{params:{dailyRentalId:this.getRoomId}}).then(e=>{var t=e.data;if(0==t.errorCode){for(var o=t.data||[],i=0;i<o.length;i++)o[i].isChecked=!1;this.roomTypeList=o}}).catch(function(e){console.log(e)})},comfirmChoiceOrigin(){for(var e=[],t=0;t<this.roomTypeList.length;t++)this.roomTypeList[t].isChecked&&e.push(this.roomTypeList[t].name);e.length==this.roomTypeList.length&&this.roomTypeList.length>0?this.inputVal="全部房型":e.length>0?this.inputVal=e.join(","):this.inputVal="",this.isShow=!1},cancelChoiceOrigin(){for(var e=0;e<this.roomTypeList.length;e++)this.roomTypeList[e].isChecked=!1;this.inputVal="",this.isShow=!1}}},r=s,n=(o("f1b6"),o("6691")),l=Object(n["a"])(r,i,a,!1,null,null,null);t["a"]=l.exports},f1b6:function(e,t,o){"use strict";var i=o("9556"),a=o.n(i);a.a},fffe:function(e,t,o){"use strict";var i=o("0b8b"),a=o.n(i);a.a}}]);
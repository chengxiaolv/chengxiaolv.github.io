(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32921417"],{4492:function(t,e,a){},"4c85":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"device-management"},[a("div",{staticClass:"header-condition"},[a("span",{directives:[{name:"show",rawName:"v-show",value:"-1"!=t.$authority.indexOf("electronicTable"),expression:"$authority.indexOf('electronicTable') != '-1'"}],class:{"is-active":"electronic"==t.deviceMode},on:{click:function(e){return t.changeTabMode("electronic")}}},[t._v("电表")]),a("span",{directives:[{name:"show",rawName:"v-show",value:"-1"!=t.$authority.indexOf("waterTable"),expression:"$authority.indexOf('waterTable') != '-1'"}],class:{"is-active":"water"==t.deviceMode},on:{click:function(e){return t.changeTabMode("water")}}},[t._v("水表")]),a("span",{directives:[{name:"show",rawName:"v-show",value:"-1"!=t.$authority.indexOf("doorTable"),expression:"$authority.indexOf('doorTable') != '-1'"}],class:{"is-active":"door"==t.deviceMode},on:{click:function(e){return t.changeTabMode("door")}}},[t._v("门禁")])]),"electronic"==t.deviceMode&&"-1"!=t.$authority.indexOf("electronicTable")?a("div",{staticClass:"search-list"},[a("el-row",[a("el-col",{attrs:{span:21}},[a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    项目\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:function(){t.searchChangeProject(),t.getElectronicTable()}},model:{value:t.electronicInfo.project,callback:function(e){t.$set(t.electronicInfo,"project",e)},expression:"electronicInfo.project"}},t._l(t.projectList,function(t){return a("el-option",{key:t.orgId,attrs:{label:t.orgName,value:t.orgId}})}),1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    房号\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.electronicInfo.roomNum,callback:function(e){t.$set(t.electronicInfo,"roomNum",e)},expression:"electronicInfo.roomNum"}},t._l(t.roomList,function(t){return a("el-option",{key:t.roomId,attrs:{label:t.roomName,value:t.roomId}})}),1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    户型\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.electronicInfo.doorType,callback:function(e){t.$set(t.electronicInfo,"doorType",e)},expression:"electronicInfo.doorType"}},t._l(t.apartmentList,function(t){return a("el-option",{key:t.val,attrs:{label:t.text,value:t.val}})}),1)],1)],1),a("el-col",{staticClass:"disp-right",attrs:{span:3}},[a("el-button",{staticClass:"el-button el-button--primary",on:{click:t.getElectronicTable}},[t._v("查询")]),"-1"!=t.$authority.indexOf("electronicExport")?a("el-button",{staticClass:"greenBtn",on:{click:function(e){return t.exportSearchList("electronic")}}},[t._v("导出")]):t._e()],1)],1)],1):"water"==t.deviceMode&&"-1"!=t.$authority.indexOf("waterTable")?a("div",{staticClass:"search-list"},[a("el-row",[a("el-col",{attrs:{span:21}},[t._e(),t._e(),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    项目\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:function(){t.searchChangeProject(),t.getWaterTable()}},model:{value:t.waterInfo.project,callback:function(e){t.$set(t.waterInfo,"project",e)},expression:"waterInfo.project"}},t._l(t.projectList,function(t){return a("el-option",{key:t.orgId,attrs:{label:t.orgName,value:t.orgId}})}),1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    房号\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.waterInfo.roomNum,callback:function(e){t.$set(t.waterInfo,"roomNum",e)},expression:"waterInfo.roomNum"}},t._l(t.roomList,function(t){return a("el-option",{key:t.roomId,attrs:{label:t.roomName,value:t.roomId}})}),1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    户型\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.waterInfo.doorType,callback:function(e){t.$set(t.waterInfo,"doorType",e)},expression:"waterInfo.doorType"}},t._l(t.apartmentList,function(t){return a("el-option",{key:t.val,attrs:{label:t.text,value:t.val}})}),1)],1),t._e(),t._e()],1),a("el-col",{staticClass:"disp-right",attrs:{span:3}},["-1"!=t.$authority.indexOf("waterTable")?a("el-button",{staticClass:"el-button el-button--primary",on:{click:t.getWaterTable}},[t._v("查询")]):t._e(),"-1"!=t.$authority.indexOf("waterExport")?a("el-button",{staticClass:"greenBtn",on:{click:function(e){return t.exportSearchList("water")}}},[t._v("导出")]):t._e()],1)],1)],1):a("div",{staticClass:"search-list"},["-1"!=t.$authority.indexOf("doorTable")?a("el-row",[a("el-col",{attrs:{span:21}},[t._e(),t._e(),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    项目\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:function(){t.searchChangeProject(),t.getDoorTable()}},model:{value:t.doorInfo.project,callback:function(e){t.$set(t.doorInfo,"project",e)},expression:"doorInfo.project"}},t._l(t.projectList,function(t){return a("el-option",{key:t.orgId,attrs:{label:t.orgName,value:t.orgId}})}),1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    房号\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.doorInfo.roomNum,callback:function(e){t.$set(t.doorInfo,"roomNum",e)},expression:"doorInfo.roomNum"}},t._l(t.roomList,function(t){return a("el-option",{key:t.roomId,attrs:{label:t.roomName,value:t.roomId}})}),1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    户型\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.doorInfo.doorType,callback:function(e){t.$set(t.doorInfo,"doorType",e)},expression:"doorInfo.doorType"}},t._l(t.apartmentList,function(t){return a("el-option",{key:t.val,attrs:{label:t.text,value:t.val}})}),1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("\n                    状态\n                ")]),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.doorInfo.status,callback:function(e){t.$set(t.doorInfo,"status",e)},expression:"doorInfo.status"}},t._l(t.doorStatusList,function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})}),1)],1)],1),a("el-col",{staticClass:"disp-right",attrs:{span:3}},["-1"!=t.$authority.indexOf("doorTable")?a("el-button",{staticClass:"el-button el-button--primary",on:{click:t.getDoorTable}},[t._v("查询")]):t._e(),"-1"!=t.$authority.indexOf("doorExport")?a("el-button",{staticClass:"greenBtn",on:{click:function(e){return t.exportSearchList("door")}}},[t._v("导出")]):t._e()],1)],1):t._e()],1),"electronic"==t.deviceMode&&"-1"!=t.$authority.indexOf("electronicTable")?a("div",{staticClass:"electronic"},[a("div",{staticClass:"content-table"},[a("el-table",{key:"electronic",staticStyle:{width:"100%"},attrs:{data:t.electronicTableData,border:""}},[a("el-table-column",{attrs:{prop:"indexNum",align:"center",label:"序号",width:"80"}}),a("el-table-column",{attrs:{prop:"address",align:"center",label:"地址"}}),a("el-table-column",{attrs:{prop:"personName",align:"center",label:"承租人名称"}}),a("el-table-column",{attrs:{prop:"customerNames",align:"center",width:"160",label:"租户/居住姓名"}}),a("el-table-column",{attrs:{prop:"customerPhones",align:"center",label:"租户/居住电话"}}),a("el-table-column",{attrs:{prop:"deviceName",align:"center",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"statusName",align:"center",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return"-1"!=t.$authority.indexOf("electronicStatus")?[a("el-tooltip",{attrs:{placement:"right",manual:!e.row.showTooltip}},[a("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                                房间号："+t._s(e.row.statusInfo.room||"-")),a("br"),t._v("\n                                在线状态："+t._s(e.row.statusInfo.name||"-")+"\n                            ")]),a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.watchRoomStatus("electronic",e.row)}}},[t._v("查看")])])]:void 0}}],null,!0)}),a("el-table-column",{attrs:{prop:"deviceNo",align:"center",label:"序列号"}}),a("el-table-column",{attrs:{prop:"rates",align:"center",label:"费率（元/千瓦.时）"}}),a("el-table-column",{attrs:{prop:"firstDeviceNum",align:"center",label:"签约起始表数(千瓦.时)"}}),a("el-table-column",{attrs:{prop:"operator",align:"center",width:"140",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return["-1"!=t.$authority.indexOf("electronicWatchMore")?a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.showMoreTableInfo(e.row,"1")}}},[t._v("更多")]):t._e(),"-1"!=t.$authority.indexOf("electronicHandle")?a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.handleTableData(e.row)}}},[t._v("手动抄表")]):t._e()]}}],null,!1,425852028)})],1)],1)]):"water"==t.deviceMode&&"-1"!=t.$authority.indexOf("waterTable")?a("div",{staticClass:"water"},[a("div",{staticClass:"content-table"},[a("el-table",{key:"water",staticStyle:{width:"100%"},attrs:{data:t.waterTableData,border:""}},[a("el-table-column",{attrs:{prop:"indexNum",align:"center",label:"序号",width:"80"}}),a("el-table-column",{attrs:{prop:"address",align:"center",label:"地址"}}),a("el-table-column",{attrs:{prop:"personName",align:"center",label:"承租人名称"}}),a("el-table-column",{attrs:{prop:"customerNames",align:"center",label:"租户/居住姓名"}}),a("el-table-column",{attrs:{prop:"customerPhones",align:"center",label:"租户/居住电话"}}),a("el-table-column",{attrs:{prop:"deviceName",align:"center",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"statusName",align:"center",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return"-1"!=t.$authority.indexOf("waterStatus")?[a("el-tooltip",{attrs:{placement:"right",manual:!e.row.showTooltip}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                                    房间号："+t._s(e.row.statusInfo.room||"-")),a("br"),t._v("\n                                    在线状态："+t._s(e.row.statusInfo.name||"-")+"\n                                ")])]),a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.watchRoomStatus("water",e.row)}}},[t._v("查看")])])]:void 0}}],null,!0)}),a("el-table-column",{attrs:{prop:"deviceNo",align:"center",label:"序列号"}}),a("el-table-column",{attrs:{prop:"rates",align:"center",label:"费率（元/m³）"}}),a("el-table-column",{attrs:{prop:"firstDeviceNum",align:"center",label:"签约起始表数(千瓦.时)"}}),a("el-table-column",{attrs:{prop:"operator",align:"center",width:"140",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return["-1"!=t.$authority.indexOf("waterWatchMore")?a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.showMoreTableInfo(e.row,"2")}}},[t._v("更多")]):t._e(),"-1"!=t.$authority.indexOf("waterHandle")?a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.handleTableData(e.row)}}},[t._v("手动抄表")]):t._e()]}}])})],1)],1)]):a("div",{staticClass:"water"},["-1"!=t.$authority.indexOf("doorTable")?a("div",{staticClass:"content-table"},[a("el-table",{key:"door",staticStyle:{width:"100%"},attrs:{data:t.doorTableData,border:""}},[a("el-table-column",{attrs:{prop:"indexNum",align:"center",label:"序号",width:"80"}}),a("el-table-column",{attrs:{prop:"address",align:"center",label:"地址"}}),a("el-table-column",{attrs:{prop:"personName",align:"center",label:"承租人名称"}}),a("el-table-column",{attrs:{prop:"customerNames",align:"center",label:"租户/居住姓名"}}),a("el-table-column",{attrs:{prop:"customerPhones",align:"center",label:"租户/居住电话"}}),a("el-table-column",{attrs:{prop:"deviceName",align:"center",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"statusName",align:"center",label:"状态"}}),a("el-table-column",{attrs:{prop:"pwdList",align:"center",label:"租户密码",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.pwdList&&e.row.pwdList.length>0?a("div",t._l(e.row.pwdList,function(e,o){return a("div",{key:o},[t._v("\n                                "+t._s(e.pwdUserName||"-")+" : "+t._s(e.pwd||"-")+"\n                            ")])}),0):a("div",[t._v("-")])]}}],null,!1,2087166520)}),a("el-table-column",{attrs:{prop:"deviceNo",align:"center",label:"序列号"}}),a("el-table-column",{attrs:{prop:"livePerson",align:"center",label:"居住人数"}}),a("el-table-column",{attrs:{prop:"address",align:"center",width:"140",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return["正常"==e.row.statusName&&"-1"!=t.$authority.indexOf("doorLock")?a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.changeDoorTableStatus("0",e.row)}}},[t._v("锁定")]):"锁定"==e.row.statusName&&"-1"!=t.$authority.indexOf("doorOpen")?a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.changeDoorTableStatus("1",e.row)}}},[t._v("开启")]):t._e()]}}],null,!1,475279849)})],1)],1):t._e()]),a("div",{staticClass:"el-page"},[a("el-pagination",{attrs:{background:"","current-page":t.mainPage.currentPage,"page-sizes":[10,20,30,40,50],"page-size":t.mainPage.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.mainPage.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t.dialogVisible?a("div",{staticClass:"my-puple"},[a("el-dialog",{attrs:{title:"更多",visible:t.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"1200px","before-close":function(){return t.dialogVisible=!1}},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"padding: 20px 30px;"},[a("el-table",{key:"look-puple",staticStyle:{width:"100%"},attrs:{data:t.moreTableList,border:""}},[a("el-table-column",{attrs:{type:"index",align:"center",label:"序号",width:"80"}}),a("el-table-column",{attrs:{prop:"address",align:"center",label:"地址"}}),a("el-table-column",{attrs:{prop:"personName",align:"center",label:"承租人名称"}}),a("el-table-column",{attrs:{prop:"housemateName",align:"center",label:"租户/居住姓名"}}),a("el-table-column",{attrs:{prop:"housematePhone",align:"center",label:"租户/居住电话"}}),a("el-table-column",{attrs:{prop:"surplus",align:"center",label:"表余数"}}),a("el-table-column",{attrs:{prop:"history",align:"center",label:"历史表数"}}),a("el-table-column",{attrs:{prop:"amountMoney",align:"center",label:"总金额"}}),a("el-table-column",{attrs:{prop:"meterTime",align:"center",label:"抄表时间"}}),a("el-table-column",{attrs:{prop:"meterReader",align:"center",label:"抄表人"}}),a("el-table-column",{attrs:{prop:"info",align:"center",label:"备注内容"}}),a("el-table-column",{attrs:{prop:"img",align:"center",label:"附件"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.imgUrl?a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.showBigImgFunc(e.row)}}},[t._v("查看")]):t._e()]}}],null,!1,3400083081)}),a("el-table-column",{attrs:{prop:"operator",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[1!=e.row.autoRecord?a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(a){return t.deleteDeviceRecord(e.row)}}},[t._v("删除")]):t._e()]}}],null,!1,885540787)})],1)],1),a("div",{staticClass:"el-page"},[a("el-pagination",{attrs:{background:"","current-page":t.moreInfoPage.currentPage,"page-sizes":[10,20,30,40,50],"page-size":t.moreInfoPage.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.moreInfoPage.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("确定")]),a("el-button",{staticClass:"greenBtn",on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")])],1)])],1):t._e(),t.dialogVisibleHandle?a("div",{staticClass:"my-puple"},[a("el-dialog",{attrs:{title:"手动抄表",visible:t.dialogVisibleHandle,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"660px","before-close":function(){return t.dialogVisibleHandle=!1}},on:{"update:visible":function(e){t.dialogVisibleHandle=e}}},[a("div",{staticClass:"my-puple-contract"},[a("p",[t._v("房源地址："+t._s(t.handleTableInfo.address))]),a("el-row",{staticStyle:{"font-size":"14px"}},[a("el-col",{attrs:{span:3}},[t._v("表余数")]),"1"==t.handleTableInfo.deviceType?a("el-col",{attrs:{span:20}},[a("el-col",{attrs:{span:21}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入表余数",clearable:""},model:{value:t.handleTableInfo.surplus,callback:function(e){t.$set(t.handleTableInfo,"surplus",e)},expression:"handleTableInfo.surplus"}})],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[t._v("\n                            千瓦.时\n                        ")])],1):a("el-col",{attrs:{span:20}},[a("el-col",{attrs:{span:22}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入表余数",clearable:""},model:{value:t.handleTableInfo.surplus,callback:function(e){t.$set(t.handleTableInfo,"surplus",e)},expression:"handleTableInfo.surplus"}})],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:2}},[t._v("\n                            m"),a("sup",[t._v("3")])])],1)],1),a("el-row",{staticClass:"mt-10",staticStyle:{"font-size":"14px"}},[a("el-col",{attrs:{span:3}},[t._v("抄表时间")]),a("el-col",{attrs:{span:20}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":t.pickerOptionsLimit},model:{value:t.handleTableInfo.meterTime,callback:function(e){t.$set(t.handleTableInfo,"meterTime",e)},expression:"handleTableInfo.meterTime"}})],1)],1),"-1"!=t.$authority.indexOf("waterHandle")&&"-1"!=t.$authority.indexOf("waterChangeDevice")||"-1"!=t.$authority.indexOf("electronicHandle")&&"-1"!=t.$authority.indexOf("waterChangeDevice")?a("el-row",{staticClass:"mt-10",staticStyle:{"font-size":"14px"}},[a("el-col",{attrs:{span:3}},[t._v("是否换表")]),a("el-col",{attrs:{span:20}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:t.handleTableInfo.isFirst,callback:function(e){t.$set(t.handleTableInfo,"isFirst",e)},expression:"handleTableInfo.isFirst"}})],1)],1):t._e(),t.handleTableInfo.isFirst?a("el-row",{staticClass:"mt-10",staticStyle:{"font-size":"14px"}},[a("el-col",{attrs:{span:3}},[t._v("旧表余数")]),a("el-col",{attrs:{span:20}},[a("el-col",{attrs:{span:21}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入旧表余数",clearable:""},model:{value:t.handleTableInfo.oldSurplus,callback:function(e){t.$set(t.handleTableInfo,"oldSurplus",e)},expression:"handleTableInfo.oldSurplus"}})],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[t._v("\n                            千瓦.时\n                        ")])],1)],1):t._e(),a("el-row",{staticClass:"mt-10",staticStyle:{"font-size":"14px"}},[a("el-col",{attrs:{span:3}},[t._v("备注")]),a("el-col",{attrs:{span:20}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"请输入备注",clearable:""},model:{value:t.handleTableInfo.info,callback:function(e){t.$set(t.handleTableInfo,"info",e)},expression:"handleTableInfo.info"}})],1)],1),a("el-row",{staticClass:"mt-10"},[a("el-col",{attrs:{span:6}},[a("el-upload",{attrs:{action:"",multiple:!1,"before-upload":t.houseUploadImgPreview}},[a("div",{staticClass:"input-pic-box"},[a("i",{staticClass:"el-icon-picture-outline"}),a("span",[t._v("点击添加附件")])])])],1),t.houseUploadImgList.length>0?a("el-col",{staticStyle:{color:"#F3893B",height:"40px",overflow:"hidden"},attrs:{span:16}},[t._v(t._s(t.houseUploadImgList[0].name||"-"))]):t._e(),t.houseUploadImgList.length>0?a("el-col",{attrs:{span:2}},[a("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer",color:"#F3893B"},on:{click:t.removeUploadFile}})]):t._e()],1)],1),a("span",{staticClass:"dialog-footer mt-10",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.comfirmHandleTable}},[t._v("确定")]),a("el-button",{staticClass:"greenBtn",on:{click:function(e){t.dialogVisibleHandle=!1}}},[t._v("取消")])],1)])],1):t._e(),t.bigImg.isShow?a("div",{staticClass:"show-big-img"},[a("i",{staticClass:"el-icon-close",on:{click:function(e){t.bigImg.isShow=!1}}}),a("div",{staticClass:"big-img-content"})]):t._e()])},r=[],s=a("90b9"),i={name:"device-management",data(){return{deviceMode:"electronic",currentPage:1,dialogVisible:!1,dialogVisibleHandle:!1,electronicInfo:{city:"",project:"",roomNum:"",doorType:""},waterInfo:{city:"",project:"",roomNum:"",doorType:"",data:""},doorInfo:{city:"",project:"",roomNum:"",doorType:"",status:""},moreTableInfo:{roomId:"",contractNo:"",deviceId:""},handleTableInfo:{deviceId:"",contractNo:"",roomId:"",deviceType:"",address:"",surplus:"",meterTime:"",info:"",imgId:"",isFirst:!1,oldSurplus:""},paramsData:{pageSize:10,currentPage:1},cityList:[],projectList:[],roomList:[],apartmentList:[],doorStatusList:[{name:"正常",value:"0"},{name:"无租客承租",value:"1"},{name:"锁定",value:"2"}],mainPage:{currentPage:1,pageSize:10,total:10},moreInfoPage:{currentPage:1,pageSize:10,total:10},electronicTableData:[],waterTableData:[],doorTableData:[],moreTableList:[],houseUploadImgList:[],pickerOptionsLimit:{disabledDate(t){return t.getTime()>=Date.now()}},bigImg:{isShow:!1,url:""}}},created(){this.getStoreDataList(),this.getPeojectList(this.deviceMode)},watch:{"$store.getters.getRoomNumList"(){this.roomList=this.$store.getters.getRoomNumList||[]},"$store.getters.gettaCity"(){this.cityList=this.$store.getters.gettaCity||[]},"$store.getters.getApartmentLis"(){this.apartmentList=this.$store.getters.getApartmentList||[]},"$store.getters.getStoreEdit.count"(){"project"==this.$store.getters.getStoreEdit.which&&this.changeCityChoice()}},mounted(){},methods:{getStoreDataList(){this.apartmentList=this.$store.getters.getApartmentList||[]},changeTabMode(t){switch(this.deviceMode=t,this.paramsData.currentPage=1,this.mainPage.currentPage=1,this.paramsData.pageSize=this.mainPage.pageSize,t){case"electronic":this.paramsData.orgId=this.electronicInfo.project,this.paramsData.roomId=this.electronicInfo.roomNum,this.paramsData.roomStructure=this.electronicInfo.doorType,this.paramsData.status="",this.waterInfo.project="",this.waterInfo.roomNum="",this.waterInfo.doorType="",this.waterInfo.data="",this.doorInfo.project="",this.doorInfo.roomNum="",this.doorInfo.doorType="",this.doorInfo.status="";break;case"water":this.paramsData.orgId=this.waterInfo.project,this.paramsData.roomId=this.waterInfo.roomNum,this.paramsData.roomStructure=this.waterInfo.doorType,this.paramsData.status="",this.electronicInfo.project="",this.electronicInfo.roomNum="",this.electronicInfo.doorType="",this.doorInfo.project="",this.doorInfo.roomNum="",this.doorInfo.doorType="",this.doorInfo.status="";break;case"door":this.paramsData.orgId=this.doorInfo.project,this.paramsData.roomId=this.doorInfo.roomNum,this.paramsData.roomStructure=this.doorInfo.doorType,this.paramsData.status=this.doorInfo.status,this.electronicInfo.project="",this.electronicInfo.roomNum="",this.electronicInfo.doorType="",this.waterInfo.project="",this.waterInfo.roomNum="",this.waterInfo.doorType="",this.waterInfo.data="";break;default:this.paramsData.orgId=this.electronicInfo.project,this.paramsData.roomId=this.electronicInfo.roomNum,this.paramsData.roomStructure=this.electronicInfo.doorType,this.waterInfo.project="",this.waterInfo.roomNum="",this.waterInfo.doorType="",this.waterInfo.data="",this.doorInfo.project="",this.doorInfo.roomNum="",this.doorInfo.doorType="",this.doorInfo.status="";break}this.projectList=[],this.roomList=[],this.getPeojectList(t)},changeCityChoice(t){"electronic"==this.deviceMode?(this.electronicInfo.project="",this.electronicInfo.roomNum="",""!=this.electronicInfo.city?this.getPeojectList("electronic"):this.projectList=[]):"water"==this.deviceMode?(this.waterInfo.project="",this.waterInfo.roomNum="",""!=this.waterInfo.city?this.getPeojectList("water"):this.projectList=[]):(this.doorInfo.project="",this.doorInfo.roomNum="",""!=this.doorInfo.city?this.getPeojectList("door"):this.projectList=[]),this.roomList=[]},getPeojectList(t){var e="";e="electronic"==t?"/api/deviceManage/getOrgListForElectricity":"water"==t?"/api/deviceManage/getOrgListForWater":"/api/deviceManage/getOrgListForLock",this.$http.get(e).then(t=>{var e=t.data;if(0==e.errorCode){this.projectList=e.data||[];var a="";switch(this.projectList.length>0&&(this.projectList.unshift({orgName:"全部",orgId:""}),a=this.projectList[0].orgId),this.deviceMode){case"electronic":this.electronicInfo.project=a,this.paramsData.orgId=this.electronicInfo.project,this.paramsData.roomId=this.electronicInfo.roomNum,this.paramsData.roomStructure=this.electronicInfo.doorType,this.paramsData.status="",this.getTableData("electronic");break;case"water":this.waterInfo.project=a,this.paramsData.orgId=this.waterInfo.project,this.paramsData.roomId=this.waterInfo.roomNum,this.paramsData.roomStructure=this.waterInfo.doorType,this.paramsData.status="",this.getTableData("water");break;case"door":this.doorInfo.project=a,this.paramsData.orgId=this.doorInfo.project,this.paramsData.roomId=this.doorInfo.roomNum,this.paramsData.roomStructure=this.doorInfo.doorType,this.paramsData.status=this.doorInfo.status,this.getTableData("door");break;default:this.electronicInfo.project=a,this.paramsData.orgId=this.electronicInfo.project,this.paramsData.roomId=this.electronicInfo.roomNum,this.paramsData.roomStructure=this.electronicInfo.doorType,this.paramsData.status="",this.getTableData("electronic");break}this.projectList.length>0&&this.searchChangeProject()}}).catch(function(t){console.log(t)})},searchChangeProject(){"electronic"==this.deviceMode&&this.projectList.length>0?(this.electronicInfo.roomNum="",this.$store.dispatch("getRoomNum",`orgId=${this.electronicInfo.project}&orgType=1`)):"water"==this.deviceMode&&this.projectList.length>0?(this.waterInfo.roomNum="",this.$store.dispatch("getRoomNum",`orgId=${this.waterInfo.project}&orgType=1`)):"door"==this.deviceMode&&this.projectList.length>0?(this.doorInfo.roomNum="",this.$store.dispatch("getRoomNum",`orgId=${this.doorInfo.project}&orgType=1`)):(this.electronicInfo.roomNum="",this.waterInfo.roomNum="",this.doorInfo.roomNum="",this.roomList=[])},handleSizeChange(t){this.dialogVisible?(this.moreInfoPage.pageSize=t,this.moreInfoPage.currentPage=1,this.getMoreInfoTable()):(this.mainPage.pageSize=t,this.mainPage.currentPage=1,"electronic"==this.deviceMode?this.getElectronicTable():"water"==this.deviceMode?this.getWaterTable():this.getDoorTable())},handleCurrentChange(t){this.dialogVisible?(this.moreInfoPage.currentPage=t,this.getMoreInfoTable()):(this.mainPage.currentPage=t,"electronic"==this.deviceMode?this.getElectronicTable():"water"==this.deviceMode?this.getWaterTable():this.getDoorTable())},getSerarchTableList(){switch(this.paramsData.currentPage=this.mainPage.currentPage,this.paramsData.pageSize=this.mainPage.pageSize,this.deviceMode){case"electronic":this.paramsData.orgId=this.electronicInfo.project,this.paramsData.roomId=this.electronicInfo.roomNum,this.paramsData.roomStructure=this.electronicInfo.doorType,this.paramsData.status="",this.getTableData("electronic");break;case"water":this.paramsData.orgId=this.waterInfo.project,this.paramsData.roomId=this.waterInfo.roomNum,this.paramsData.roomStructure=this.waterInfo.doorType,this.paramsData.status="",this.getTableData("water");break;case"door":this.paramsData.orgId=this.doorInfo.project,this.paramsData.roomId=this.doorInfo.roomNum,this.paramsData.roomStructure=this.doorInfo.doorType,this.paramsData.status=this.doorInfo.status,this.getTableData("door");break;default:this.paramsData.orgId=this.electronicInfo.project,this.paramsData.roomId=this.electronicInfo.roomNum,this.paramsData.roomStructure=this.electronicInfo.doorType,this.paramsData.status="",this.getTableData("electronic");break}},getElectronicTable(){if(0==this.projectList.length)return this.mainPage.total=0,void(this.electronicTableData=[]);this.getSerarchTableList()},getWaterTable(){if(0==this.projectList.length)return this.mainPage.total=0,void(this.waterTableData=[]);this.getSerarchTableList()},getDoorTable(){if(0==this.projectList.length)return this.mainPage.total=0,void(this.doorTableData=[]);this.getSerarchTableList()},watchRoomStatus(t,e){var a=e,o="";o="electronic"==t?"/api/deviceManage/getElectricityStatus":"/api/deviceManage/getWaterStatus",this.$http.get(o,{params:{deviceNo:e.deviceNo,roomId:e.roomId}}).then(o=>{var r=o.data;if(0==r.errorCode)switch(a.showTooltip=!0,a.statusInfo.name=r.data.statusName,a.statusInfo.room=r.data.roomName,t){case"electronic":this.$set(this.electronicTableData,e.keyCount,a);break;case"water":this.$set(this.waterTableData,e.keyCount,a);break;default:break}}).catch(function(t){console.log(t)})},exportSearchList(t){var e="";switch(t){case"electronic":e="./api/deviceManage/exportDeviceElectricityList";break;case"water":e="./api/deviceManage/exportDeviceWaterList";break;case"door":e="./api/deviceManage/exportDeviceLockList";break;default:e="./api/deviceManage/exportDeviceElectricityList";break}var a=`${e}?cityId=${this.paramsData.cityId}\n            &orgId=${this.paramsData.orgId}&roomId=${this.paramsData.roomId}&roomStructure=${this.paramsData.roomStructure}\n            &status=${this.paramsData.status||""}&currentPage=${this.paramsData.currentPage}&pageSize=${this.paramsData.pageSize}`;window.open(a)},getTableData(t){var e="";if("electronic"==t){if(0==this.projectList.length)return this.mainPage.total=0,void(this.electronicTableData=[]);e="/api/deviceManage/getDeviceElectricityList"}else if("water"==t){if(0==this.projectList.length)return this.mainPage.total=0,void(this.waterTableData=[]);e="/api/deviceManage/getDeviceWaterList"}else{if(0==this.projectList.length)return this.mainPage.total=0,void(this.doorTableData=[]);e="/api/deviceManage/getDeviceLockList"}this.$http.get(e,{params:this.paramsData}).then(e=>{var a=e.data;if(0==a.errorCode)switch(t){case"electronic":this.electronicTableData=a.data.content||[];for(var o=0;o<this.electronicTableData.length;o++)this.electronicTableData[o].showTooltip=!1,this.electronicTableData[o].keyCount=o,this.electronicTableData[o].statusInfo={},this.electronicTableData[o].indexNum=Number(this.paramsData.pageSize)*Number(this.paramsData.currentPage-1)+Number(1+o);this.getLivePersonInfo(this.electronicTableData),this.mainPage.total=a.data.total;break;case"water":this.waterTableData=a.data.content||[];for(o=0;o<this.waterTableData.length;o++)this.waterTableData[o].showTooltip=!1,this.waterTableData[o].keyCount=o,this.waterTableData[o].statusInfo={},this.waterTableData[o].indexNum=Number(this.paramsData.pageSize)*Number(this.paramsData.currentPage-1)+Number(1+o);this.getLivePersonInfo(this.waterTableData),this.mainPage.total=a.data.total;break;case"door":this.doorTableData=a.data.content||[];for(o=0;o<this.doorTableData.length;o++)this.doorTableData[o].indexNum=Number(this.paramsData.pageSize)*Number(this.paramsData.currentPage-1)+Number(1+o);this.getLivePersonInfo(this.doorTableData),this.mainPage.total=a.data.total;break;default:this.electronicTableData=a.data.content||[];for(o=0;o<this.electronicTableData.length;o++)this.electronicTableData[o].indexNum=Number(this.paramsData.pageSize)*Number(this.paramsData.currentPage-1)+Number(1+o);this.getLivePersonInfo(this.electronicTableData),this.mainPage.total=a.data.total;break}}).catch(function(t){console.log(t)})},getLivePersonInfo(t){for(let o=0;o<t.length;o++){var e=[],a=[];for(let r=0;r<t[o].housemate.length;r++)e.push(t[o].housemate[r].customerName),a.push(t[o].housemate[r].customerPhone);e.length>0?t[o].customerNames=e.join(","):t[o].customerNames="-",a.length>0?t[o].customerPhones=a.join(","):t[o].customerPhones="-","door"==this.deviceMode&&(t[o].livePerson=t[o].housemate.length)}},showMoreTableInfo(t,e){this.moreTableInfo.roomId=t.roomId,this.moreTableInfo.contractNo=t.contractNo,this.moreTableInfo.deviceId=t.deviceId,this.moreInfoPage.currentPage=1,this.getMoreInfoTable()},getMoreInfoTable(){this.dialogVisible=!0,this.moreTableInfo.currentPage=this.moreInfoPage.currentPage,this.moreTableInfo.pageSize=this.moreInfoPage.pageSize;var t="";t="1"==this.moreTableInfo.deviceType?"/api/deviceManage/getElectricityRecords":"/api/deviceManage/getWaterRecords",this.$http.get(t,{params:this.moreTableInfo}).then(t=>{var e=t.data;if(0==e.errorCode){this.dialogVisible=!0,this.moreTableList=e.data.content;for(var a=0;a<this.moreTableList.length;a++)this.moreTableList[a].img&&""!=this.moreTableList[a].img.url?this.moreTableList[a].imgUrl=this.moreTableList[a].img.url:this.moreTableList[a].imgUrl="";this.moreInfoPage.total=e.data.total}}).catch(function(t){console.log(t)})},showBigImgFunc(t){""!=t.img.url&&(this.bigImg.url=t.img.url,this.bigImg.isShow=!0,this.$nextTick(()=>{var t=document.querySelectorAll(".big-img-content")[0];t.style.background="url("+this.bigImg.url+") no-repeat center center",t.style.backgroundSize="contain"}))},deleteDeviceRecord(t){this.$confirm("确认删除？").then(e=>{this.$http.post("/api/deviceManage/deleteRecords",{deviceRecordsId:t.deviceRecordsId,deviceType:this.moreTableInfo.deviceType}).then(t=>{var e=t.data;0==e.errorCode&&setTimeout(()=>{this.$message({message:"删除成功！",type:"success"}),this.getMoreInfoTable()},1e3)}).catch(function(t){console.log(t)})}).catch(t=>{})},changeDoorTableStatus(t,e){this.$http.post("/api/deviceManage/updateLockPwdStatus",{deviceId:e.deviceId,pwdStatus:t}).then(t=>{var e=t.data;0==e.errorCode&&setTimeout(()=>{this.$message({message:"状态修改成功！",type:"success"}),this.getDoorTable()},1e3)}).catch(function(t){console.log(t)})},handleTableData(t){this.handleTableInfo.address="",this.handleTableInfo.surplus="",this.handleTableInfo.info="",this.handleTableInfo.imgId="",this.handleTableInfo.isFirst=!1,this.handleTableInfo.oldSurplus="",this.houseUploadImgList=[];let e=(new Date).valueOf();this.handleTableInfo.meterTime=Object(s["g"])(e),this.handleTableInfo.roomId=t.roomId,this.handleTableInfo.deviceType="electronic"==this.deviceMode?"1":"2",this.handleTableInfo.deviceId=t.deviceId,this.handleTableInfo.contractNo=t.contractNo,this.handleTableInfo.address=t.address||"-",this.dialogVisibleHandle=!0},houseUploadImgPreview(t){const e=t.size/1024/1024<3;if(!e)return this.$message({message:"上传图片大小不能超过 3MB!",type:"error"});let a=new FormData;a.append("file",t),this.$http({method:"post",url:"./api/file/uploadthumbCompress",data:a}).then(e=>{var a=e.data;0==a.errorCode&&(this.houseUploadImgList=[],this.houseUploadImgList.push({id:a.data.id,minPic:a.data.thumb_1,maxPic:a.data.thumb_2,originPic:a.data.url,name:t.name}))})},removeUploadFile(){this.houseUploadImgList=[]},comfirmHandleTable(){var t="";t="1"==this.handleTableInfo.deviceType?"/api/deviceManage/addElectricityRecords":"/api/deviceManage/addWaterRecords";var e={deviceId:this.handleTableInfo.deviceId,roomId:this.handleTableInfo.roomId,contractNo:this.handleTableInfo.contractNo,surplus:this.handleTableInfo.surplus,meterTime:this.handleTableInfo.meterTime,info:this.handleTableInfo.info,imgId:1==this.houseUploadImgList.length?this.houseUploadImgList[0].id:"",isFirst:this.handleTableInfo.isFirst?"1":"0",oldSurplus:this.handleTableInfo.isFirst?this.handleTableInfo.oldSurplus:""};this.$http.post(t,e).then(t=>{var e=t.data;0==e.errorCode&&setTimeout(()=>{this.$message({message:"手动操表成功！",type:"success"}),this.dialogVisibleHandle=!1,this.getTableData(this.deviceMode)},1e3)}).catch(function(t){console.log(t)})}}},l=i,n=(a("e21c"),a("6691")),c=Object(n["a"])(l,o,r,!1,null,null,null);e["default"]=c.exports},e21c:function(t,e,a){"use strict";var o=a("4492"),r=a.n(o);r.a}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60bf9635"],{"0b8b":function(e,o,t){},"43bf":function(e,o,t){"use strict";var i=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"originList"},[t("el-input",{attrs:{readonly:""},nativeOn:{click:function(o){return e.changeShowMode(o)}},model:{value:e.inputVal,callback:function(o){e.inputVal=o},expression:"inputVal"}}),t("transition",{attrs:{name:"el-zoom-in-top"}},[e.isShow?t("div",{staticClass:"show-tree"},[t("div",{staticClass:"origin-list-content"},[e._l(e.roomOriginList,function(o,i){return t("div",{key:i},[t("el-checkbox",{model:{value:o.isChecked,callback:function(t){e.$set(o,"isChecked",t)},expression:"item.isChecked"}},[e._v(" "+e._s(o.info))])],1)}),0==e.roomOriginList.length?t("div",{staticStyle:{"text-align":"center"}},[e._v("\n            暂无数据\n        ")]):e._e()],2),t("div",{staticClass:"deep-content"},[t("el-button",{staticClass:"greenBtn",attrs:{size:"small"},on:{click:e.cancelChoiceOrigin}},[e._v("取消")]),t("el-button",{staticClass:"el-button el-button--primary",attrs:{size:"small"},on:{click:e.comfirmChoiceOrigin}},[e._v("确定")])],1)]):e._e()])],1)},a=[],s={name:"originList",data(){return{inputVal:"",isShow:!1,roomOriginList:[]}},props:[],created(){this.getRoomOriginList()},watch:{},methods:{changeShowMode(){this.isShow=!this.isShow},getRoomOriginList(){this.$http.get("/api/daily/order/public/findSourceTypies").then(e=>{var o=e.data;if(0==o.errorCode){for(var t=o.data||[],i=0;i<t.length;i++)t[i].isChecked=!1;this.roomOriginList=t}}).catch(function(e){console.log(e)})},comfirmChoiceOrigin(){for(var e=[],o=0;o<this.roomOriginList.length;o++)this.roomOriginList[o].isChecked&&e.push(this.roomOriginList[o].info);e.length==this.roomOriginList.length&&this.roomOriginList.length>0?this.inputVal="全部渠道来源":e.length>0?this.inputVal=e.join(","):this.inputVal="",this.isShow=!1},cancelChoiceOrigin(){for(var e=0;e<this.roomOriginList.length;e++)this.roomOriginList[e].isChecked=!1;this.inputVal="",this.isShow=!1}}},r=s,n=(t("fffe"),t("6691")),l=Object(n["a"])(r,i,a,!1,null,null,null);o["a"]=l.exports},9556:function(e,o,t){},d99d:function(e,o,t){},e7ba:function(e,o,t){"use strict";var i=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"roomType"},[t("el-input",{attrs:{readonly:""},nativeOn:{click:function(o){return e.changeShowMode(o)}},model:{value:e.inputVal,callback:function(o){e.inputVal=o},expression:"inputVal"}}),t("transition",{attrs:{name:"el-zoom-in-top"}},[e.isShow?t("div",{staticClass:"show-tree"},[t("div",{staticClass:"origin-list-content"},[e._l(e.roomTypeList,function(o,i){return t("div",{key:i},[t("el-checkbox",{model:{value:o.isChecked,callback:function(t){e.$set(o,"isChecked",t)},expression:"item.isChecked"}},[e._v(" "+e._s(o.name))])],1)}),0==e.roomTypeList.length?t("div",{staticStyle:{"text-align":"center"}},[e._v("\n            暂无数据\n        ")]):e._e()],2),t("div",{staticClass:"deep-content"},[t("el-button",{staticClass:"greenBtn",attrs:{size:"small"},on:{click:e.cancelChoiceOrigin}},[e._v("取消")]),t("el-button",{staticClass:"el-button el-button--primary",attrs:{size:"small"},on:{click:e.comfirmChoiceOrigin}},[e._v("确定")])],1)]):e._e()])],1)},a=[],s={name:"roomType",data(){return{inputVal:"",isShow:!1,roomTypeList:[]}},props:["getRoomId","url"],created(){},watch:{getRoomId(){this.inputVal="",this.getRoomTypeList()}},mounted(){console.log(this.url),console.log(this.getRoomId)},methods:{changeShowMode(){this.isShow=!this.isShow},getRoomTypeList(){this.$http.get("/api/daily/room_type/list",{params:{dailyRentalId:this.getRoomId}}).then(e=>{var o=e.data;if(0==o.errorCode){for(var t=o.data||[],i=0;i<t.length;i++)t[i].isChecked=!1;this.roomTypeList=t}}).catch(function(e){console.log(e)})},comfirmChoiceOrigin(){for(var e=[],o=0;o<this.roomTypeList.length;o++)this.roomTypeList[o].isChecked&&e.push(this.roomTypeList[o].name);e.length==this.roomTypeList.length&&this.roomTypeList.length>0?this.inputVal="全部房型":e.length>0?this.inputVal=e.join(","):this.inputVal="",this.isShow=!1},cancelChoiceOrigin(){for(var e=0;e<this.roomTypeList.length;e++)this.roomTypeList[e].isChecked=!1;this.inputVal="",this.isShow=!1}}},r=s,n=(t("f1b6"),t("6691")),l=Object(n["a"])(r,i,a,!1,null,null,null);o["a"]=l.exports},f1b6:function(e,o,t){"use strict";var i=t("9556"),a=t.n(i);a.a},f3dd:function(e,o,t){"use strict";var i=t("d99d"),a=t.n(i);a.a},f901:function(e,o,t){"use strict";t.r(o);var i=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"realRoom"},[t("div",{staticClass:"search-list"},[t("el-row",[t("el-col",{attrs:{span:22}},[t("el-col",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyRoomStateSearch"),expression:"$authority.indexOf('dailyRoomStateSearch') != '-1'"}],attrs:{span:3}},[t("el-col",{staticStyle:{"text-align":"right","padding-right":"10px",height:"60px",overflow:"hidden"},attrs:{span:6}},[e._v("\n                        项目\n                    ")]),t("el-col",{attrs:{span:16}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.searchRealRoomTable},model:{value:e.realRoomSearchInfo.projectId,callback:function(o){e.$set(e.realRoomSearchInfo,"projectId",o)},expression:"realRoomSearchInfo.projectId"}},e._l(e.projectList,function(e){return t("el-option",{key:e.dailyRentalId,attrs:{label:e.name,value:e.dailyRentalId}})}),1)],1)],1),t("el-col",{attrs:{span:3}},[t("el-col",{staticStyle:{"text-align":"right","padding-right":"10px",height:"60px",overflow:"hidden"},attrs:{span:6}},[e._v("\n                        房型\n                    ")]),t("el-col",{attrs:{span:16}},[t("room-type",{ref:"roomType",attrs:{getRoomId:e.realRoomSearchInfo.projectId}})],1)],1),t("el-col",{attrs:{span:4}},[t("el-col",{staticStyle:{"text-align":"right","padding-right":"10px",height:"60px",overflow:"hidden"},attrs:{span:8}},[e._v("\n                        渠道来源\n                    ")]),t("el-col",{attrs:{span:14}},[t("origin-list",{ref:"originList"})],1)],1),t("el-col",{attrs:{span:4}},[t("el-col",{staticStyle:{"text-align":"right","padding-right":"10px",height:"60px",overflow:"hidden"},attrs:{span:8}},[e._v("\n                        排序规则\n                    ")]),t("el-col",{attrs:{span:14}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.realRoomSearchInfo.sort,callback:function(o){e.$set(e.realRoomSearchInfo,"sort",o)},expression:"realRoomSearchInfo.sort"}},e._l(e.roomSortList,function(e){return t("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1)],1),t("el-col",{attrs:{span:5}},[t("el-col",{staticStyle:{"text-align":"right","padding-right":"10px",height:"60px",overflow:"hidden"},attrs:{span:6}},[e._v("\n                        房间信息\n                    ")]),t("el-col",{attrs:{span:14}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"姓名、电话、房间号",clearable:""},model:{value:e.realRoomSearchInfo.info,callback:function(o){e.$set(e.realRoomSearchInfo,"info",o)},expression:"realRoomSearchInfo.info"}})],1)],1)],1),t("el-col",{staticClass:"disp-right",attrs:{span:2}},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyRoomStateSearch"),expression:"$authority.indexOf('dailyRoomStateSearch') != '-1'"}],staticClass:"el-button el-button--primary",on:{click:e.searchRealRoomTable}},[e._v("查询")]),e._e()],1)],1)],1),t("div",{staticClass:"content-room-container"},[t("div",{staticClass:"content-room-list"},e._l(e.realRoomTable,function(o,i){return t("div",{key:i,staticClass:"room-list-ceil"},[t("div",{staticClass:"hover-box",on:{mouseenter:function(o){return e.roomListHoverEnter(i)},mouseleave:function(o){return e.roomListHoverLeave(i)}}},[t("div",{staticClass:"init-show"},[t("div",{staticClass:"top-bar",class:{"no-renting":"noRent"==o.roomType,"day-reserve":"hasReserved"==o.roomType,"day-live":"hasLived"==o.roomType,configing:"config"==o.roomType}}),t("div",{staticClass:"room-num"},[e._v(e._s(o.dailyBuildName||"-")+"("+e._s(o.dailyRoomName||"")+") "+e._s(o.dailyRoomTypeName||"-"))]),t("div",{staticClass:"room-rent-info"},["empty"==o.roomType?t("div",{staticClass:"single"},[e._v(e._s(o.price||0)+"元/日")]):e._e(),"hasReserved"==o.roomType&&o.reserve&&o.reserve.first?t("div",[e._v(e._s(o.reserve.first.name||"-"))]):e._e(),"hasReserved"==o.roomType&&o.reserve&&o.reserve.first?t("div",[e._v(e._s(o.reserve.first.tel||"-"))]):e._e(),"hasLived"==o.roomType&&o.lived&&o.lived.first?t("div",[e._v(e._s(o.lived.first.name||"-"))]):e._e(),"hasLived"==o.roomType&&o.lived&&o.lived.first?t("div",[e._v(e._s(o.lived.first.tel||"-"))]):e._e(),"noRent"==o.roomType?t("div",{staticClass:"single"},[e._v("不可租")]):e._e()])]),t("transition",{attrs:{name:"el-zoom-in-bottom"}},[1==o.isShow?t("div",{staticClass:"init-hide"},[t("el-popover",{attrs:{placement:"right",width:"340",trigger:"empty"==o.roomType?"click":"hover"}},["hasReserved"==o.roomType?t("div",{staticClass:"hover-show-room-popover"},[t("div",{staticClass:"person"},[t("div",[t("span",{staticClass:"my-icon user"}),t("span",[e._v(e._s(o.reserve.first.name||"-")+" "+e._s(o.reserve.first.tel))])]),t("span",{staticClass:"order-status no-living"},[e._v("未入住")])]),t("div",[t("span",{staticClass:"my-icon customer-type"}),e._v(e._s(o.reserve.dailyOrderSourceName||"-"))]),t("div",[t("span",{staticClass:"my-icon enter-day"}),e._v(e._s(o.reserve.startDate)+"入住，共住"),t("span",{staticClass:"green"},[e._v(e._s(o.reserve.nights||"0"))]),e._v("晚")]),t("div",[t("span",{staticClass:"my-icon order-money"}),t("div",{staticClass:"room-info mulite-line"},[t("div",[e._v("订单金额：￥"+e._s(o.reserve.orderAmount||"0"))]),t("div",[e._v("已收款：￥"+e._s(o.reserve.paidAmount||"0"))]),o.reserve.nonPayAmount>=0&&0==o.reserve.refundAmount?t("div",{staticClass:"green"},[e._v("需补交：￥"+e._s(o.reserve.nonPayAmount||"0"))]):o.reserve.refundAmount>0?t("div",{staticClass:"green"},[e._v("需退回：￥"+e._s(o.reserve.refundAmount||"0"))]):e._e()])]),t("div",[t("span",{staticClass:"my-icon label"}),t("div",{staticClass:"room-info mulite-line"},[e._v("\n                                                备注："+e._s(o.reserve.info||"-")+"\n                                            ")])])]):e._e(),"hasLived"==o.roomType?t("div",{staticClass:"hover-show-room-popover"},[t("div",{staticClass:"person"},[t("div",[t("span",{staticClass:"my-icon user"}),t("span",[e._v(e._s(o.lived.first.name||"-")+" "+e._s(o.lived.first.tel))])]),t("span",{staticClass:"order-status had-leave",staticStyle:{border:"1px solid #f3893b","background-color":"#fef3eb",color:"#f3893b"}},[e._v("已入住")])]),t("div",[t("span",{staticClass:"my-icon customer-type"}),e._v(e._s(o.lived.dailyOrderSourceName||"-"))]),t("div",[t("span",{staticClass:"my-icon enter-day"}),e._v(e._s(o.lived.startDate)+"入住，共住"),t("span",{staticClass:"green"},[e._v(e._s(o.lived.nights||"0"))]),e._v("晚")]),t("div",[t("span",{staticClass:"my-icon order-money"}),t("div",{staticClass:"room-info mulite-line"},[t("div",[e._v("订单金额：￥"+e._s(o.lived.orderAmount||"0"))]),t("div",[e._v("已收款：￥"+e._s(o.lived.paidAmount||"0"))]),o.lived.nonPayAmount>=0&&0==o.lived.refundAmount?t("div",{staticClass:"green"},[e._v("需补交：￥"+e._s(o.lived.nonPayAmount||"0"))]):o.lived.refundAmount>0?t("div",{staticClass:"green"},[e._v("需退回：￥"+e._s(o.lived.refundAmount||"0"))]):e._e()])]),t("div",[t("span",{staticClass:"my-icon label"}),t("div",{staticClass:"room-info mulite-line"},[e._v("\n                                                备注："+e._s(o.lived.info||"-")+"\n                                            ")])])]):e._e(),t("div",{attrs:{slot:"reference",id:"hasSlot"},slot:"reference"},["empty"==o.roomType&&"-1"!=e.$authority.indexOf("dailyOrderAddReserve")?t("div",{staticClass:"hide-inner",on:{click:function(t){return e.enterRoomManage(o,"reserve")}}},[e._v("添加预定")]):e._e(),"empty"==o.roomType&&"-1"!=e.$authority.indexOf("dailyRoomLiveIn")?t("div",{staticClass:"hide-inner",on:{click:function(t){return e.enterRoomManage(o,"DirectLive")}}},[e._v("直接入住")]):e._e(),"hasReserved"==o.roomType&&"-1"!=e.$authority.indexOf("dailyRoomLiveIn")?t("div",{staticClass:"hide-inner",on:{click:function(t){return e.enterRoomManage(o,"orderDetail","CheckLive")}}},[e._v("办理入住")]):e._e(),"hasLived"==o.roomType&&"-1"!=e.$authority.indexOf("dailyOrderExitRent")?t("div",{staticClass:"hide-inner",on:{click:function(t){return e.enterRoomManage(o,"orderDetail","exitRoom")}}},[e._v("办理退租")]):e._e(),"hasReserved"!=o.roomType&&"hasLived"!=o.roomType||"-1"==e.$authority.indexOf("dailyRoomOrderDetail")?e._e():t("div",{staticClass:"hide-inner",on:{click:function(t){return e.enterRoomManage(o,"orderDetail","orderDetail")}}},[e._v("查看订单")])])])],1):e._e()])],1),t("div",{staticClass:"room-condition"},[t("span",{staticClass:"daily-room-device-manage",on:{click:function(t){return e.handleTableDeviceInsert(o)}}}),t("span",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyRoomSetDirt"),expression:"$authority.indexOf('dailyRoomSetDirt') != '-1'"}],staticClass:"dirt-icon",class:{"is-dirty":!(!o.clean||!o.clean.val||2!=o.clean.val)},on:{click:function(t){return e.changeRoomDirtStatus(o)}}})])])}),0)]),t("el-dialog",{staticClass:"my-puple",attrs:{width:"950px",title:"打印单据",visible:e.dialogTableVisibleprint},on:{"update:visible":function(o){e.dialogTableVisibleprint=o}}},[t("div",{ref:"printcontainer",staticClass:"printcontainer"},[t("h2",{staticClass:"billtype"},[e._v("住宿单")]),t("div",{staticClass:"billinfo"},[t("div",{staticClass:"mr-40",attrs:{title:"打印日期："+e.printInfo.printDate}},[e._v("打印日期："+e._s(e.printInfo.printDate))]),t("div",{staticClass:"mr-40",attrs:{title:"客户姓名："+e.printInfo.printpeopleName}},[e._v("客户姓名："+e._s(e.printInfo.printpeopleName))]),t("div",{staticClass:"mr-40",attrs:{title:"地址："+e.printInfo.printaddes}},[e._v("地址："+e._s(e.printInfo.printaddes))])]),t("div",{staticClass:"billTable"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.printTableData,stripe:""}},[t("el-table-column",{attrs:{align:"center",prop:"roomName",label:"房间号"}}),t("el-table-column",{attrs:{prop:"name",align:"center",label:"费用项",width:"180"}}),t("el-table-column",{attrs:{prop:"name",width:"200",align:"center",label:"费用时间"},scopedSlots:e._u([{key:"default",fn:function(o){return[e._v("\n                    "+e._s(1==o.row.cycle.val?o.row.startTime+"-"+o.row.endTime:""+o.row.startTime)+"\n                ")]}}])}),t("el-table-column",{attrs:{prop:"name",align:"center",label:"总额/已收(元)"},scopedSlots:e._u([{key:"default",fn:function(o){return[e._v("\n                  "+e._s(o.row.amount)+"/"+e._s(o.row.paidAmount)+"\n                ")]}}])}),t("el-table-column",{attrs:{align:"center",prop:"nonPayAmount",label:"待收(元)"}})],1)],1),t("div",{staticClass:"printmaininfo mt-10"},[t("div",{staticClass:"pinfo-item"},[t("div",[t("span",[e._v("订单总额："+e._s(e._f("filterMoney")(e.printInfo.total))),t("span"),e._v("(大写金额："+e._s(e.printInfo.uppercasetotal)+")")])])]),t("div",{staticClass:"pinfo-item mt-10"}),t("div",{staticClass:"mt-10 no-print",staticStyle:{"text-align":"center"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.printVoucher}},[e._v("确认打印")])],1)])])]),e.dialogInsertLive?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:e.roomManageInfo.manageTypeName,visible:e.dialogInsertLive,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"1100px","before-close":e.closeDialogInsertLive},on:{"update:visible":function(o){e.dialogInsertLive=o}}},[t("div",{staticClass:"room-puple-detail"},[t("div",{staticClass:"title-font"},[e._v("住客")]),t("div",{staticClass:"person-info"},[e._l(e.livePersonList,function(o,i){return t("el-row",{key:i,staticClass:"person-info-ceil"},[t("el-col",{attrs:{span:22}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("姓名")]),t("el-col",{attrs:{span:16}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:o.persons[0].name,callback:function(t){e.$set(o.persons[0],"name",t)},expression:"item.persons[0].name"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:5}},[e._v("手机")]),t("el-col",{attrs:{span:17}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:o.persons[0].phone,callback:function(t){e.$set(o.persons[0],"phone",t)},expression:"item.persons[0].phone"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:10}},[t("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"证件类型",size:"small"},model:{value:o.persons[0].cardType,callback:function(t){e.$set(o.persons[0],"cardType",t)},expression:"item.persons[0].cardType"}},e._l(e.cardTypeList,function(e){return t("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:14}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:o.persons[0].cardNo,callback:function(t){e.$set(o.persons[0],"cardNo",t)},expression:"item.persons[0].cardNo"}})],1)],1)],1),t("el-row",{staticClass:"mt-10"},[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:6}},[e._v("入住")]),t("el-col",{attrs:{span:"分配房间"==e.roomManageInfo.manageTypeName?12:16}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",clearable:!1,size:"small","value-format":"yyyy-MM-dd",readonly:"直接入住"==e.roomManageInfo.manageTypeName},on:{change:function(o){return e.changeReserveEnterData(i)}},model:{value:o.startData,callback:function(t){e.$set(o,"startData",t)},expression:"item.startData"}})],1),"分配房间"==e.roomManageInfo.manageTypeName?t("el-col",{staticStyle:{"padding-left":"6px"},attrs:{span:5}},[t("el-button",{staticClass:"greenBtn has-remain-font",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:function(o){return e.openDialogRemainTime("distributeDetail",i)}}},[e._v("保留到\n                                "),e.dialogRoomRemainTime||""==o.retentionTime||null==o.retentionTime?e._e():t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px",right:"-2px"}})])],1):e._e()],1),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:5}},[e._v("离店")]),t("el-col",{attrs:{span:17}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",clearable:!1,size:"small","value-format":"yyyy-MM-dd"},on:{change:function(o){return e.changeReserveLeaveData(i)}},model:{value:o.leaveData,callback:function(t){e.$set(o,"leaveData",t)},expression:"item.leaveData"}})],1)],1),t("el-col",{attrs:{span:3}},[t("el-input-number",{staticStyle:{width:"92%"},attrs:{min:1,size:"small"},on:{change:function(o){return e.changeRoomNigihtVal(i)}},model:{value:o.night,callback:function(t){e.$set(o,"night",t)},expression:"item.night"}})],1),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(o){return e.changeRoomTypeVal(i)}},model:{value:o.roomType,callback:function(t){e.$set(o,"roomType",t)},expression:"item.roomType"}},e._l(o.optionRooms,function(e,o){return t("el-option",{key:o,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房费规格",size:"small"},on:{change:function(o){return e.changeDayRoomPriceVal("DirectLive",i)}},model:{value:o.priceSpecs,callback:function(t){e.$set(o,"priceSpecs",t)},expression:"item.priceSpecs"}},e._l(o.priceSpecsList,function(e,o){return t("el-option",{key:o,attrs:{label:e.chanelName,value:e.dailySalesChanelId}})}),1)],1),t("el-col",{attrs:{span:3}},[t("el-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[e._v("￥")]),t("el-col",{attrs:{span:19}},[o.priceSpecs&&"handle"!=o.priceSpecs?t("el-tag",{staticStyle:{width:"100%"},attrs:{type:"info"}},[e._v(e._s(Number(o.price).toFixed(2)))]):t("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1,min:0,size:"small"},on:{change:function(o){return e.calculateRoomPrice(i)}},model:{value:o.price,callback:function(t){e.$set(o,"price",t)},expression:"item.price"}})],1)],1)],1)],1),t("el-col",{attrs:{span:1}},[t("div",[o.persons&&o.persons.length<=1?t("span",{staticClass:"add-person-icon",on:{click:function(t){return e.dialogShowRoomPerson("dialogInsertLive",o.persons,i)}}}):t("el-badge",{staticClass:"add-person-item",attrs:{value:o.persons.length,max:99}},[t("span",{staticClass:"add-person-icon",on:{click:function(t){return e.dialogShowRoomPerson("dialogInsertLive",o.persons,i)}}})])],1),"CheckLive"==e.roomManageInfo.manageType?t("div",{staticStyle:{"margin-top":"10px"}},[t("span",{staticStyle:{"padding-left":"6px"}},[t("el-checkbox",{model:{value:o.checked,callback:function(t){e.$set(o,"checked",t)},expression:"item.checked"}})],1)]):e._e()]),"CheckLive"!=e.roomManageInfo.manageType?t("el-col",{attrs:{span:1}},[t("el-row",[e._v(" ")]),t("el-row",[t("i",{staticClass:"el-icon-remove add-margin",on:{click:function(o){return e.removeNewRoomList(i)}}})])],1):e._e(),e._e()],1)}),"CheckLive"!=e.roomManageInfo.manageType?t("div",{staticClass:"insert-room"},[t("span",{staticClass:"green",staticStyle:{cursor:"pointer"},on:{click:e.insertNewRoomList}},[t("i",{staticClass:"el-icon-circle-plus"}),e._v("添加房间")]),t("span",[e._v("房费合计：￥"),t("span",{staticClass:"green"},[e._v(e._s(e.roomLiveInfo.roomTotalPrice||"0"))])])]):e._e()],2),t("el-row",[t("el-col",{attrs:{span:6}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"线下客人"},model:{value:e.roomLiveInfo.origin,callback:function(o){e.$set(e.roomLiveInfo,"origin",o)},expression:"roomLiveInfo.origin"}},e._l(e.roomOriginList,function(e,o){return t("el-option",{key:o,attrs:{label:e.info,value:e.dailyOrderSourceId}})}),1)],1)],1),t("div",{staticClass:"title-font mt-10"},[e._v("收支信息")]),t("el-row",[t("el-col",{attrs:{span:8}},[e._v("订单金额：￥"),t("span",[e._v(e._s(e.roomLiveInfo.orderTotalMoney||"0"))]),e._v("（房费"),t("span",[e._v(e._s(e.roomLiveInfo.roomTotalPrice||"0"))]),e._v("）")]),t("el-col",{attrs:{span:4}},[e._v("押金: ￥"+e._s(e.roomLiveInfo.roomDepositMoney||"0"))]),t("el-col",{attrs:{span:5}},[e._v("已收款: ￥"+e._s(e.roomLiveInfo.receiveMoney||"0"))]),t("el-col",{staticClass:"green",attrs:{span:4}},[e._v(e._s(e.roomLiveInfo.needMoney>=0?"需补交":"需退回")+"：￥"+e._s(Math.abs(e.roomLiveInfo.needMoney||"0")))]),t("el-col",{staticClass:"green",staticStyle:{"text-align":"right",cursor:"pointer"},attrs:{span:3},nativeOn:{click:function(o){return e.insertAddtionPay(o)}}},[t("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加款项")])],1),e.roomLiveInfo.showAddtionPay?t("div",{staticClass:"person-info",staticStyle:{"margin-top":"0px"}},[t("el-row",[t("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?3:4}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"费用类型",size:"small"},on:{change:function(o){return e.changeIncomeFeeVal("DirectLive")}},model:{value:e.roomLiveInfo.incomeMoneyType,callback:function(o){e.$set(e.roomLiveInfo,"incomeMoneyType",o)},expression:"roomLiveInfo.incomeMoneyType"}},e._l(e.incomeFeeTypeList,function(e){return t("el-option",{key:e.feeTypeId,attrs:{label:e.feeTypeName,value:e.feeTypeId}})}),1)],1),3==e.roomLiveInfo.incomeMoneyType?t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"其它费用",size:"small"},model:{value:e.roomLiveInfo.incomeAddtionMoneyType,callback:function(o){e.$set(e.roomLiveInfo,"incomeAddtionMoneyType",o)},expression:"roomLiveInfo.incomeAddtionMoneyType"}},e._l(e.incomeAddtionFeeList,function(e){return t("el-option",{key:e.detailFeeTypeId,attrs:{label:e.feeName,value:e.detailFeeTypeId}})}),1)],1):e._e(),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"收/支",size:"small"},on:{change:function(o){return e.changeIncomePayType("DirectLive")}},model:{value:e.roomLiveInfo.incomeReceiveType,callback:function(o){e.$set(e.roomLiveInfo,"incomeReceiveType",o)},expression:"roomLiveInfo.incomeReceiveType"}},e._l(e.incomeOrPayList,function(e){return t("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?3:4}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(o){return e.getMoneyDayList("DirectLive")}},model:{value:e.roomLiveInfo.incomeChoiceRoom,callback:function(o){e.$set(e.roomLiveInfo,"incomeChoiceRoom",o)},expression:"roomLiveInfo.incomeChoiceRoom"}},e._l(e.roomLimitTypeList,function(e,o){return t("el-option",{key:o,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),t("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?4:5}},[t("el-col",{attrs:{span:1==e.roomLiveInfo.incomeMoneyType?5:7}},[e._v("金额")]),t("el-col",{directives:[{name:"show",rawName:"v-show",value:1==e.roomLiveInfo.incomeMoneyType,expression:"roomLiveInfo.incomeMoneyType == 1"}],attrs:{span:9}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"天数",size:"small"},on:{change:function(o){return e.changeMoneyDayVal("DirectLive")}},model:{value:e.roomLiveInfo.rentMoneyDay,callback:function(o){e.$set(e.roomLiveInfo,"rentMoneyDay",o)},expression:"roomLiveInfo.rentMoneyDay"}},e._l(e.moneyChoiceDayList,function(e,o){return t("el-option",{key:o,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:1==e.roomLiveInfo.incomeMoneyType?9:15}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{disabled:1==e.roomLiveInfo.incomeMoneyType&&!e.roomLiveInfo.moneyCanEidt,controls:!1,min:0,size:"small"},model:{value:e.roomLiveInfo.incomeMoney,callback:function(o){e.$set(e.roomLiveInfo,"incomeMoney",o)},expression:"roomLiveInfo.incomeMoney"}})],1)],1),t("el-col",{attrs:{span:e.roomLiveInfo.showPayNo?3:4}},[t("el-col",{attrs:{span:22}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.roomLiveInfo.showPayType,placeholder:"支付方式",size:"small"},on:{change:function(o){return e.changeAddtionPayType("DirectLive")}},model:{value:e.roomLiveInfo.incomePayType,callback:function(o){e.$set(e.roomLiveInfo,"incomePayType",o)},expression:"roomLiveInfo.incomePayType"}},e._l(e.incomePayTypeList,function(e){return t("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),t("el-col",{attrs:{span:e.roomLiveInfo.showPayNo?5:4}},[e.roomLiveInfo.showPayNo?t("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogSettleAccounts}},[e._v("单号 \n                        "),!e.dialogReserveSettleAccounts&&e.settleAccount.newVal.length>0?t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]):e._e(),t("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogReserveLabel}},[e._v("备注 \n                        "),!e.dialogReserveLabel&&e.reserveLabel.isInsert&&e.reserveLabel.newVal.length>0?t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveReserveIncomeInfo}},[e._v("保存")])],1)],1)],1):e._e(),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderReserveTable,border:""}},[t("el-table-column",{attrs:{prop:"moneyTypeName",align:"center",label:"费用类型"}}),t("el-table-column",{attrs:{prop:"incomeName",align:"center",label:"收/支"},scopedSlots:e._u([{key:"default",fn:function(o){return[2==o.row.income?t("span",{staticStyle:{color:"#24b0fc"}},[e._v("+"+e._s(o.row.money)+e._s(o.row.incomeName||"-"))]):t("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(o.row.money)+e._s(o.row.incomeName||"-"))])]}}],null,!1,18178844)}),t("el-table-column",{attrs:{prop:"payTypeName",align:"center",label:"支付方式"}}),t("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房间"}}),t("el-table-column",{attrs:{prop:"operatorTime",align:"center",label:"操作时间"}}),t("el-table-column",{attrs:{prop:"payNo",align:"center",label:"挂账单号"}}),t("el-table-column",{attrs:{prop:"operatorName",align:"center",label:"操作人"}}),t("el-table-column",{attrs:{prop:"operate",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.deleteTableReserve(o.row)}}},[e._v("删除")]),1==o.row.income?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.getReserveTableMoney(o.row)}}},[e._v("收款")]):e._e(),o.row.label&&""!=o.row.label?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.showTableReserveLabel(o.row)}}},[e._v("备注")]):e._e()]}}],null,!1,2098310231)})],1)],1),t("div",{staticClass:"mt-10"},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"订单备注..."},model:{value:e.roomLiveInfo.label,callback:function(o){e.$set(e.roomLiveInfo,"label",o)},expression:"roomLiveInfo.label"}})],1),e._e(),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitDirectLive}},[e._v("保存")])],1)],1)])],1):e._e(),e.dialogReserveNoChoice?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"新增预定",visible:e.dialogReserveNoChoice,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"1100px","before-close":function(){return e.dialogReserveNoChoice=!1}},on:{"update:visible":function(o){e.dialogReserveNoChoice=o}}},[t("div",{staticClass:"room-puple-detail"},[t("div",{staticClass:"title-font"},[e._v("住客")]),t("div",{staticClass:"person-info"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("姓名")]),t("el-col",{attrs:{span:16}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:e.noRoomReserveInfo.name,callback:function(o){e.$set(e.noRoomReserveInfo,"name",o)},expression:"noRoomReserveInfo.name"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:5}},[e._v("手机")]),t("el-col",{attrs:{span:17}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.noRoomReserveInfo.phone,callback:function(o){e.$set(e.noRoomReserveInfo,"phone",o)},expression:"noRoomReserveInfo.phone"}})],1)],1),t("el-col",{attrs:{span:9}},[t("el-col",{attrs:{span:9}},[t("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"证件类型",size:"small"},model:{value:e.noRoomReserveInfo.cardType,callback:function(o){e.$set(e.noRoomReserveInfo,"cardType",o)},expression:"noRoomReserveInfo.cardType"}},e._l(e.cardTypeList,function(e,o){return t("el-option",{key:o,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:14}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.noRoomReserveInfo.cardNo,callback:function(o){e.$set(e.noRoomReserveInfo,"cardNo",o)},expression:"noRoomReserveInfo.cardNo"}})],1)],1),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"线下客人",size:"small"},model:{value:e.noRoomReserveInfo.origin,callback:function(o){e.$set(e.noRoomReserveInfo,"origin",o)},expression:"noRoomReserveInfo.origin"}},e._l(e.roomOriginList,function(e,o){return t("el-option",{key:o,attrs:{label:e.info,value:e.dailyOrderSourceId}})}),1)],1)],1)],1),t("div",{staticClass:"title-font"},[e._v("房间信息 "),t("span",{staticStyle:{float:"right"}},[e._v("房费合计："),t("span",{staticClass:"green",staticStyle:{"font-size":"22px"}},[e._v("￥"+e._s(e.noRoomReserveInfo.roomTotalPrice||"0"))])])]),t("div",{staticClass:"person-info"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:5}},[e._v("入住")]),t("el-col",{attrs:{span:12}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",size:"small","value-format":"yyyy-MM-dd",clearable:!1,readonly:""},on:{change:e.changeReserveNoRoom},model:{value:e.noRoomReserveInfo.startData,callback:function(o){e.$set(e.noRoomReserveInfo,"startData",o)},expression:"noRoomReserveInfo.startData"}})],1),t("el-col",{staticStyle:{"padding-left":"6px"},attrs:{span:5}},[t("el-button",{staticClass:"greenBtn has-remain-font",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:function(o){return e.openDialogRemainTime("noRoomReserve",0)}}},[e._v("保留到\n                                "),e.dialogRoomRemainTime||""==e.noRoomReserveInfo.retentionTime||null==e.noRoomReserveInfo.retentionTime?e._e():t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px",right:"-2px"}})])],1)],1),t("el-col",{staticStyle:{"padding-right":"6px"},attrs:{span:4}},[t("el-col",{attrs:{span:5}},[e._v("离店")]),t("el-col",{attrs:{span:19}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",size:"small","value-format":"yyyy-MM-dd",clearable:!1},on:{change:e.changeReserveNoRoom},model:{value:e.noRoomReserveInfo.leaveData,callback:function(o){e.$set(e.noRoomReserveInfo,"leaveData",o)},expression:"noRoomReserveInfo.leaveData"}})],1)],1),t("el-col",{staticStyle:{position:"relative"},attrs:{span:3}},[t("el-input-number",{staticStyle:{width:"92%"},attrs:{min:1,size:"small"},on:{change:e.changeNoRoomCount},model:{value:e.noRoomReserveInfo.night,callback:function(o){e.$set(e.noRoomReserveInfo,"night",o)},expression:"noRoomReserveInfo.night"}}),t("span",{staticStyle:{position:"absolute",right:"50px","z-index":"999","font-size":"14px"}},[e._v("晚")])],1),t("el-col",{attrs:{span:2}},[t("el-select",{staticStyle:{width:"95%"},attrs:{size:"small"},on:{change:e.changeNoRoomTypeVal},model:{value:e.noRoomReserveInfo.roomType,callback:function(o){e.$set(e.noRoomReserveInfo,"roomType",o)},expression:"noRoomReserveInfo.roomType"}},e._l(e.roomTypeList,function(e){return t("el-option",{key:e.dailyRoomTypeId,attrs:{label:e.name,value:e.dailyRoomTypeId}})}),1)],1),t("el-col",{staticStyle:{position:"relative"},attrs:{span:3}},[t("el-input-number",{staticStyle:{width:"92%"},attrs:{min:1,size:"small"},on:{change:e.calculateNoRoomPrice},model:{value:e.noRoomReserveInfo.roomCount,callback:function(o){e.$set(e.noRoomReserveInfo,"roomCount",o)},expression:"noRoomReserveInfo.roomCount"}}),t("span",{staticStyle:{position:"absolute",right:"50px","z-index":"999","font-size":"14px"}},[e._v("间")])],1),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房费规格",size:"small"},on:{change:e.changeNoRoomTypeVal},model:{value:e.noRoomReserveInfo.priceSpecs,callback:function(o){e.$set(e.noRoomReserveInfo,"priceSpecs",o)},expression:"noRoomReserveInfo.priceSpecs"}},e._l(e.noRoomReserveInfo.priceSpecsList,function(e,o){return t("el-option",{key:o,attrs:{label:e.chanelName,value:e.dailySalesChanelId}})}),1)],1),t("el-col",{attrs:{span:3}},[t("el-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[e._v("￥")]),t("el-col",{attrs:{span:19}},[e.noRoomReserveInfo.priceSpecs&&"handle"!=e.noRoomReserveInfo.priceSpecs?t("el-tag",{staticStyle:{width:"100%"},attrs:{type:"info"}},[e._v(e._s(Number(e.noRoomReserveInfo.price).toFixed(2)))]):t("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1,min:0,size:"small"},on:{change:e.calculateNoRoomPrice},model:{value:e.noRoomReserveInfo.price,callback:function(o){e.$set(e.noRoomReserveInfo,"price",o)},expression:"noRoomReserveInfo.price"}})],1)],1)],1)],1),t("div",{staticClass:"mt-10"},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"订单备注..."},model:{value:e.noRoomReserveInfo.label,callback:function(o){e.$set(e.noRoomReserveInfo,"label",o)},expression:"noRoomReserveInfo.label"}})],1),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitNoRoomReserve}},[e._v("新增订单")])],1)])])],1):e._e(),e.dialogInsertReserve?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"新增预定",visible:e.dialogInsertReserve,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"1100px","before-close":function(){return e.dialogInsertReserve=!1}},on:{"update:visible":function(o){e.dialogInsertReserve=o}}},[t("div",{staticClass:"room-puple-detail"},[t("div",{staticClass:"title-font"},[e._v("住客")]),t("div",{staticClass:"person-info"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("姓名")]),t("el-col",{attrs:{span:16}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:e.roomReserveInfo.name,callback:function(o){e.$set(e.roomReserveInfo,"name",o)},expression:"roomReserveInfo.name"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:5}},[e._v("手机")]),t("el-col",{attrs:{span:17}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.roomReserveInfo.phone,callback:function(o){e.$set(e.roomReserveInfo,"phone",o)},expression:"roomReserveInfo.phone"}})],1)],1),t("el-col",{attrs:{span:9}},[t("el-col",{attrs:{span:9}},[t("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"证件类型",size:"small"},model:{value:e.roomReserveInfo.cardType,callback:function(o){e.$set(e.roomReserveInfo,"cardType",o)},expression:"roomReserveInfo.cardType"}},e._l(e.cardTypeList,function(e){return t("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:14}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.roomReserveInfo.cardNo,callback:function(o){e.$set(e.roomReserveInfo,"cardNo",o)},expression:"roomReserveInfo.cardNo"}})],1)],1),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"线下客人",size:"small"},model:{value:e.roomReserveInfo.origin,callback:function(o){e.$set(e.roomReserveInfo,"origin",o)},expression:"roomReserveInfo.origin"}},e._l(e.roomOriginList,function(e,o){return t("el-option",{key:o,attrs:{label:e.info,value:e.dailyOrderSourceId}})}),1)],1)],1)],1),t("div",{staticClass:"title-font"},[e._v("房间信息 "),t("span",{staticStyle:{float:"right"}},[e._v("房费合计："),t("span",{staticClass:"green",staticStyle:{"font-size":"22px"}},[e._v("￥"+e._s(e.roomReserveInfo.roomTotalPrice||0))])])]),t("div",{staticClass:"person-info"},e._l(e.roomOrderList,function(o,i){return t("el-row",{key:i,class:{"mb-10":i!=e.roomOrderList.length-1}},[t("el-col",{attrs:{span:7}},[t("el-col",{attrs:{span:5}},[e._v("入住")]),t("el-col",{attrs:{span:12}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",size:"small","value-format":"yyyy-MM-dd",clearable:!1,readonly:""},on:{change:function(o){return e.changeReserveEnterData(i)}},model:{value:o.startData,callback:function(t){e.$set(o,"startData",t)},expression:"item.startData"}})],1),t("el-col",{staticStyle:{"padding-left":"6px"},attrs:{span:5}},[t("el-button",{staticClass:"greenBtn has-remain-font",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:function(o){return e.openDialogRemainTime("reserve",i)}}},[e._v("保留到\n                                "),e.dialogRoomRemainTime||""==o.retentionTime||null==o.retentionTime?e._e():t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px",right:"-2px"}})])],1)],1),t("el-col",{attrs:{span:4}},[t("el-col",{attrs:{span:5}},[e._v("离店")]),t("el-col",{attrs:{span:19}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",size:"small","value-format":"yyyy-MM-dd",clearable:!1},on:{change:function(o){return e.changeReserveLeaveData(i)}},model:{value:o.leaveData,callback:function(t){e.$set(o,"leaveData",t)},expression:"item.leaveData"}})],1)],1),t("el-col",{staticClass:"pl-10",attrs:{span:3}},[t("el-input-number",{staticStyle:{width:"92%"},attrs:{min:1,size:"small"},on:{change:function(o){return e.changeRoomNigihtVal(i)}},model:{value:o.night,callback:function(t){e.$set(o,"night",t)},expression:"item.night"}})],1),t("el-col",{attrs:{span:2}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(o){return e.changeRoomTypeVal(i)}},model:{value:o.roomType,callback:function(t){e.$set(o,"roomType",t)},expression:"item.roomType"}},e._l(o.optionRooms,function(e,o){return t("el-option",{key:o,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房费规格",size:"small"},on:{change:function(o){return e.changeDayRoomPriceVal("reserve",i)}},model:{value:o.priceSpecs,callback:function(t){e.$set(o,"priceSpecs",t)},expression:"item.priceSpecs"}},e._l(o.priceSpecsList,function(e,o){return t("el-option",{key:o,attrs:{label:e.chanelName,value:e.dailySalesChanelId}})}),1)],1),t("el-col",{attrs:{span:3}},[t("el-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[e._v("￥")]),t("el-col",{attrs:{span:19}},[o.priceSpecs&&"handle"!=o.priceSpecs?t("el-tag",{staticStyle:{width:"100%"},attrs:{type:"info"}},[e._v(e._s(Number(o.price).toFixed(2)))]):t("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1,min:0,size:"small"},on:{change:function(o){return e.calculateRoomPrice(i)}},model:{value:o.price,callback:function(t){e.$set(o,"price",t)},expression:"item.price"}})],1)],1),t("el-col",{staticStyle:{"text-align":"left","padding-left":"6px"},attrs:{span:2}},[i>0?t("i",{staticClass:"el-icon-remove green",staticStyle:{cursor:"pointer","margin-right":"6px","font-size":"18px"},on:{click:function(o){return e.removeRoomOrderList(i)}}}):e._e(),i==e.roomOrderList.length-1?t("i",{staticClass:"el-icon-circle-plus green",staticStyle:{cursor:"pointer","font-size":"18px"},on:{click:e.addRoomOrderList}}):e._e()])],1)}),1),t("div",{staticClass:"title-font mt-10 mb-10"},[e._v("收支信息")]),t("el-row",[t("el-col",{attrs:{span:8}},[e._v("订单金额：￥"),t("span",[e._v(e._s(e.roomReserveInfo.orderTotalMoney||"0"))]),e._v("（房费"),t("span",[e._v(e._s(e.roomReserveInfo.roomTotalPrice||"0"))]),e._v("）")]),t("el-col",{attrs:{span:4}},[e._v("押金: ￥"+e._s(e.roomReserveInfo.roomDepositMoney||"0"))]),t("el-col",{attrs:{span:5}},[e._v("已收款: ￥"+e._s(e.roomReserveInfo.receiveMoney||"0"))]),t("el-col",{staticClass:"green",attrs:{span:4}},[e._v(e._s(e.roomReserveInfo.needMoney>=0?"需补交":"需退回")+"：￥"+e._s(Math.abs(e.roomReserveInfo.needMoney||0)))]),t("el-col",{staticClass:"green",staticStyle:{"text-align":"right",cursor:"pointer"},attrs:{span:3},nativeOn:{click:function(o){return e.insertAddtionPay(o)}}},[t("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加款项")])],1),e.roomReserveInfo.showAddtionPay?t("div",{staticClass:"person-info",staticStyle:{"margin-top":"6px"}},[t("el-row",[t("el-col",{attrs:{span:3==e.roomReserveInfo.incomeMoneyType?3:4}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"费用类型",size:"small"},on:{change:function(o){return e.changeIncomeFeeVal("reserve")}},model:{value:e.roomReserveInfo.incomeMoneyType,callback:function(o){e.$set(e.roomReserveInfo,"incomeMoneyType",o)},expression:"roomReserveInfo.incomeMoneyType"}},e._l(e.incomeFeeTypeList,function(e){return t("el-option",{key:e.feeTypeId,attrs:{label:e.feeTypeName,value:e.feeTypeId}})}),1)],1),3==e.roomReserveInfo.incomeMoneyType?t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"其它费用",size:"small"},model:{value:e.roomReserveInfo.incomeAddtionMoneyType,callback:function(o){e.$set(e.roomReserveInfo,"incomeAddtionMoneyType",o)},expression:"roomReserveInfo.incomeAddtionMoneyType"}},e._l(e.incomeAddtionFeeList,function(e){return t("el-option",{key:e.detailFeeTypeId,attrs:{label:e.feeName,value:e.detailFeeTypeId}})}),1)],1):e._e(),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"收/支",size:"small"},on:{change:function(o){return e.changeIncomePayType("reserve")}},model:{value:e.roomReserveInfo.incomeReceiveType,callback:function(o){e.$set(e.roomReserveInfo,"incomeReceiveType",o)},expression:"roomReserveInfo.incomeReceiveType"}},e._l(e.incomeOrPayList,function(e){return t("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:3==e.roomReserveInfo.incomeMoneyType?3:4}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(o){return e.getMoneyDayList("reserve")}},model:{value:e.roomReserveInfo.incomeChoiceRoom,callback:function(o){e.$set(e.roomReserveInfo,"incomeChoiceRoom",o)},expression:"roomReserveInfo.incomeChoiceRoom"}},e._l(e.roomLimitTypeList,function(e,o){return t("el-option",{key:o,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),t("el-col",{attrs:{span:3==e.roomReserveInfo.incomeMoneyType?4:5}},[t("el-col",{attrs:{span:1==e.roomReserveInfo.incomeMoneyType?5:7}},[e._v("金额")]),t("el-col",{directives:[{name:"show",rawName:"v-show",value:1==e.roomReserveInfo.incomeMoneyType,expression:"roomReserveInfo.incomeMoneyType == 1"}],attrs:{span:9}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"天数",size:"small"},on:{change:function(o){return e.changeMoneyDayVal("reserve")}},model:{value:e.roomReserveInfo.rentMoneyDay,callback:function(o){e.$set(e.roomReserveInfo,"rentMoneyDay",o)},expression:"roomReserveInfo.rentMoneyDay"}},e._l(e.moneyChoiceDayList,function(e,o){return t("el-option",{key:o,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:1==e.roomReserveInfo.incomeMoneyType?9:15}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{disabled:1==e.roomReserveInfo.incomeMoneyType&&!e.roomReserveInfo.moneyCanEidt,controls:!1,min:0,size:"small"},model:{value:e.roomReserveInfo.incomeMoney,callback:function(o){e.$set(e.roomReserveInfo,"incomeMoney",o)},expression:"roomReserveInfo.incomeMoney"}})],1)],1),t("el-col",{attrs:{span:e.roomReserveInfo.showPayNo?3:4}},[t("el-col",{attrs:{span:22}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.roomReserveInfo.showPayType,placeholder:"支付方式",size:"small"},on:{change:function(o){return e.changeAddtionPayType("reserve")}},model:{value:e.roomReserveInfo.incomePayType,callback:function(o){e.$set(e.roomReserveInfo,"incomePayType",o)},expression:"roomReserveInfo.incomePayType"}},e._l(e.incomePayTypeList,function(e){return t("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),t("el-col",{attrs:{span:e.roomReserveInfo.showPayNo?5:4}},[e.roomReserveInfo.showPayNo?t("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogSettleAccounts}},[e._v("单号 \n                        "),!e.dialogReserveSettleAccounts&&e.settleAccount.newVal.length>0?t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]):e._e(),t("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogReserveLabel}},[e._v("备注 \n                        "),!e.dialogReserveLabel&&e.reserveLabel.isInsert&&e.reserveLabel.newVal.length>0?t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveReserveIncomeInfo}},[e._v("保存")])],1)],1)],1):e._e(),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderReserveTable,border:""}},[t("el-table-column",{attrs:{prop:"moneyTypeName",align:"center",label:"费用类型"}}),t("el-table-column",{attrs:{prop:"incomeName",align:"center",label:"收/支"},scopedSlots:e._u([{key:"default",fn:function(o){return[2==o.row.income?t("span",{staticStyle:{color:"#24b0fc"}},[e._v("+"+e._s(o.row.money)+e._s(o.row.incomeName||"-"))]):t("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(o.row.money)+e._s(o.row.incomeName||"-"))])]}}],null,!1,18178844)}),t("el-table-column",{attrs:{prop:"payTypeName",align:"center",label:"支付方式"}}),t("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房间"}}),t("el-table-column",{attrs:{prop:"operatorTime",align:"center",label:"操作时间"}}),t("el-table-column",{attrs:{prop:"payNo",align:"center",label:"挂账单号"}}),t("el-table-column",{attrs:{prop:"operatorName",align:"center",label:"操作人"}}),t("el-table-column",{attrs:{prop:"operate",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.deleteTableReserve(o.row)}}},[e._v("删除")]),1==o.row.income?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.getReserveTableMoney(o.row,"none")}}},[e._v("收款")]):e._e(),o.row.label&&""!=o.row.label?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.showTableReserveLabel(o.row)}}},[e._v("备注")]):e._e()]}}],null,!1,3179437553)})],1)],1),t("div",{staticClass:"mt-10"},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"订单备注..."},model:{value:e.roomReserveInfo.label,callback:function(o){e.$set(e.roomReserveInfo,"label",o)},expression:"roomReserveInfo.label"}})],1),e._e(),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitReserve}},[e._v("确认预定")])],1)],1)])],1):e._e(),e.dialogRoomDetail?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"查看详情",visible:e.dialogRoomDetail,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"980px","before-close":function(){return e.dialogRoomDetail=!1}},on:{"update:visible":function(o){e.dialogRoomDetail=o}}},[t("p",{staticStyle:{"text-align":"right","margin-bottom":"0px"}},[t("span",{staticClass:"greenFont tabOperteBtn",on:{click:e.printBtnAll}},[e._v("打印整张单据")])]),t("div",{staticClass:"room-puple-detail"},[t("div",{staticClass:"title-font"},[e._v("住宿")]),e._l(e.orderPersonList,function(o,i){return t("div",{key:i,staticClass:"person-info"},[t("el-row",[t("el-col",{attrs:{span:12}},[o.roomStatus&&2==o.roomStatus.val?t("span",{staticClass:"order-status no-living"},[e._v("未入住")]):o.roomStatus&&3==o.roomStatus.val?t("span",{staticClass:"order-status had-leave"},[e._v("已入住")]):o.roomStatus&&4==o.roomStatus.val?t("span",{staticClass:"order-status leave-building"},[e._v("已离店")]):e._e(),e._v("\n                        "+e._s(o.first.name||"-")+" "),o.roomStatus&&1!=o.roomStatus.val?t("span",{staticClass:"send-message",on:{click:function(t){return e.sendRoomInfoMessage(i,o.roomStatus.val)}}},[e._v("发送短信")]):e._e()]),1==o.roomStatus.val?t("el-col",{attrs:{span:12}},[e._v(e._s(o.dailyRoomTypeName||"-"))]):e._e(),o.roomStatus&&3==o.roomStatus.val||o.roomStatus&&4==o.roomStatus.val?t("el-col",{attrs:{span:12}},[e._v(e._s(o.dailyRoomName||"-")+" ("+e._s(o.dailyRoomTypeName||"-")+") \n                      "),t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.printBtn(o)}}},[e._v("打印单据")])]):e._e()],1),t("el-row",[1==o.roomStatus.val?t("el-col",{attrs:{span:12}},[e._v("手机号："+e._s(o.first.tel||"-"))]):t("el-col",{attrs:{span:12}},[e._v("身份证："+e._s(o.first.cardNo||"-"))]),t("el-col",{attrs:{span:12}},[e._v(e._s(o.startDate||"-")+"入住 - "+e._s(o.endDate||"-")+"离店，共"+e._s(o.nights||"0")+"晚")])],1),t("el-row",["1"==e.orderRoomDetail.personStatus.val||"2"==e.orderRoomDetail.personStatus.val?t("el-col",{attrs:{span:20}},[e._v("保留时间："+e._s(o.retentionTime||"-"))]):e._e(),t("el-col",{attrs:{span:"1"==e.orderRoomDetail.personStatus.val||"2"==e.orderRoomDetail.personStatus.val?4:24}},[e._v("房费合计：￥"),t("span",{staticClass:"green"},[e._v(e._s(o.roomAmount||"0"))])])],1)],1)}),t("div",{staticClass:"title-font"},[e._v("订单")]),t("div",{staticClass:"person-info"},[t("el-row",[t("el-col",{attrs:{span:12}},[t("span",{staticClass:"order-status",class:{"waiting-separate":"待分房"==e.orderRoomDetail.roomStatus.text||"已分房"==e.orderRoomDetail.roomStatus.text,"leave-building":"已离店"==e.orderRoomDetail.roomStatus.text||"已退房"==e.orderRoomDetail.roomStatus.text||"已取消"==e.orderRoomDetail.roomStatus.text}},[e._v(e._s(e.orderRoomDetail.roomStatus.text))]),e._v("\n                      订单号："+e._s(e.orderRoomDetail.orderNo||"-")+"\n                    ")]),t("el-col",{attrs:{span:12}},[e._v("渠道来源："+e._s(e.orderRoomDetail.dailyOrderSourceName||"-"))])],1)],1),t("div",{staticClass:"title-font"},[e._v("收支信息")]),t("div",{staticClass:"person-info"},[t("el-row",[t("el-col",{attrs:{span:8}},[e._v("订单金额：￥"),t("span",[e._v(e._s(e.orderRoomDetail.orderTotalMoney||"0"))]),e._v("（房费"),t("span",[e._v(e._s(e.orderRoomDetail.roomTotalPrice||"0"))]),e._v("）")]),t("el-col",{attrs:{span:4}},[e._v("押金: ￥"+e._s(e.orderRoomDetail.roomDepositMoney||"0"))]),t("el-col",{attrs:{span:5}},[e._v("已收款: ￥"+e._s(e.orderRoomDetail.receiveMoney||"0"))]),t("el-col",{staticClass:"green",attrs:{span:4}},[e._v(e._s(e.orderRoomDetail.needMoney>=0?"需补交":"需退回")+"：￥"+e._s(Math.abs(e.orderRoomDetail.needMoney||0)))]),"1"!=e.orderRoomDetail.personStatus.val?t("el-col",{staticClass:"green",staticStyle:{"text-align":"right",cursor:"pointer"},attrs:{span:3},nativeOn:{click:function(o){return e.insertAddtionPay(o)}}},[t("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加款项")]):e._e()],1)],1),e.orderRoomDetail.showAddtionPay?t("div",{staticClass:"person-info",staticStyle:{"margin-top":"6px"}},[t("el-row",[t("el-col",{attrs:{span:3==e.orderRoomDetail.incomeMoneyType?3:4}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"费用类型",size:"small"},on:{change:function(o){return e.changeIncomeFeeVal("orderDetail")}},model:{value:e.orderRoomDetail.incomeMoneyType,callback:function(o){e.$set(e.orderRoomDetail,"incomeMoneyType",o)},expression:"orderRoomDetail.incomeMoneyType"}},e._l(e.incomeFeeTypeList,function(e){return t("el-option",{key:e.feeTypeId,attrs:{label:e.feeTypeName,value:e.feeTypeId}})}),1)],1),3==e.orderRoomDetail.incomeMoneyType?t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"其它费用",size:"small"},model:{value:e.orderRoomDetail.incomeAddtionMoneyType,callback:function(o){e.$set(e.orderRoomDetail,"incomeAddtionMoneyType",o)},expression:"orderRoomDetail.incomeAddtionMoneyType"}},e._l(e.incomeAddtionFeeList,function(e){return t("el-option",{key:e.detailFeeTypeId,attrs:{label:e.feeName,value:e.detailFeeTypeId}})}),1)],1):e._e(),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"收/支",size:"small"},on:{change:function(o){return e.changeIncomePayType("orderDetail")}},model:{value:e.orderRoomDetail.incomeReceiveType,callback:function(o){e.$set(e.orderRoomDetail,"incomeReceiveType",o)},expression:"orderRoomDetail.incomeReceiveType"}},e._l(e.incomeOrPayList,function(e){return t("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:3==e.orderRoomDetail.incomeMoneyType?3:4}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(o){return e.getMoneyDayList("orderDetail")}},model:{value:e.orderRoomDetail.incomeChoiceRoom,callback:function(o){e.$set(e.orderRoomDetail,"incomeChoiceRoom",o)},expression:"orderRoomDetail.incomeChoiceRoom"}},e._l(e.roomLimitTypeList,function(e,o){return t("el-option",{key:o,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),t("el-col",{attrs:{span:3==e.orderRoomDetail.incomeMoneyType?4:5}},[t("el-col",{attrs:{span:1==e.orderRoomDetail.incomeMoneyType?5:7}},[e._v("金额")]),t("el-col",{directives:[{name:"show",rawName:"v-show",value:1==e.orderRoomDetail.incomeMoneyType,expression:"orderRoomDetail.incomeMoneyType == 1"}],attrs:{span:9}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"天数",size:"small"},on:{change:function(o){return e.changeMoneyDayVal("orderDetail")}},model:{value:e.orderRoomDetail.rentMoneyDay,callback:function(o){e.$set(e.orderRoomDetail,"rentMoneyDay",o)},expression:"orderRoomDetail.rentMoneyDay"}},e._l(e.moneyChoiceDayList,function(e,o){return t("el-option",{key:o,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:1==e.orderRoomDetail.incomeMoneyType?9:15}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{disabled:1==e.orderRoomDetail.incomeMoneyType&&!e.orderRoomDetail.moneyCanEidt,controls:!1,min:0,size:"small"},model:{value:e.orderRoomDetail.incomeMoney,callback:function(o){e.$set(e.orderRoomDetail,"incomeMoney",o)},expression:"orderRoomDetail.incomeMoney"}})],1)],1),t("el-col",{attrs:{span:e.orderRoomDetail.showPayNo?3:4}},[t("el-col",{attrs:{span:22}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.orderRoomDetail.showPayType,placeholder:"支付方式",size:"small"},on:{change:function(o){return e.changeAddtionPayType("orderDetail")}},model:{value:e.orderRoomDetail.incomePayType,callback:function(o){e.$set(e.orderRoomDetail,"incomePayType",o)},expression:"orderRoomDetail.incomePayType"}},e._l(e.incomePayTypeList,function(e){return t("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),t("el-col",{attrs:{span:e.orderRoomDetail.showPayNo?5:4}},[e.orderRoomDetail.showPayNo?t("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogSettleAccounts}},[e._v("单号 \n                        "),!e.dialogReserveSettleAccounts&&e.settleAccount.newVal.length>0?t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]):e._e(),t("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogReserveLabel}},[e._v("备注 \n                        "),!e.dialogReserveLabel&&e.reserveLabel.isInsert&&e.reserveLabel.newVal.length>0?t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return e.saveOrderIncome("orderDetail")}}},[e._v("保存")])],1)],1)],1):e._e(),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderReserveTable,border:""}},[t("el-table-column",{attrs:{prop:"moneyTypeName",align:"center",label:"费用类型"}}),t("el-table-column",{attrs:{prop:"incomeName",align:"center",label:"收/支"},scopedSlots:e._u([{key:"default",fn:function(o){return[2==o.row.income?t("span",{staticStyle:{color:"#24b0fc"}},[e._v("+"+e._s(o.row.money)+e._s(o.row.incomeName||"-"))]):1==o.row.income?t("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(o.row.money)+e._s(o.row.incomeName||"-"))]):t("span",{staticStyle:{color:"#ff0000"}},[e._v("-"+e._s(o.row.money)+e._s(o.row.incomeName||"-"))])]}}],null,!1,3738689072)}),t("el-table-column",{attrs:{prop:"payTypeName",align:"center",label:"支付方式"}}),t("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房间"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",[e._v(e._s(o.row.roomName))]),t("span",[e._v(e._s(o.row.roomDailyTypeName))])]}}],null,!1,3653808405)}),t("el-table-column",{attrs:{prop:"operatorTime",align:"center",label:"操作时间"}}),t("el-table-column",{attrs:{prop:"payNo",align:"center",label:"挂账单号"}}),t("el-table-column",{attrs:{prop:"operatorName",align:"center",label:"操作人"}}),t("el-table-column",{attrs:{prop:"operate",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(o){return[1==o.row.income?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.deleteOrderRoom(o.row)}}},[e._v("删除")]):e._e(),1==o.row.income?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.getReceiveMoney(o.row)}}},[e._v("收款")]):e._e(),2==o.row.income&&o.row.refundAmount&&o.row.refundAmount>0?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.getBackMoney(o.row)}}},[e._v("退款")]):e._e(),t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.showTableReserveLabel(o.row)}}},[e._v("备注")])]}}],null,!1,3659109370)})],1)],1),t("div",{staticClass:"mt-10"},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"订单备注..."},model:{value:e.orderRoomDetail.label,callback:function(o){e.$set(e.orderRoomDetail,"label",o)},expression:"orderRoomDetail.label"}})],1)],2),t("span",{staticClass:"room-info-footer mt-10",attrs:{slot:"footer"},slot:"footer"},[t("span",["1"==e.orderRoomDetail.personStatus.val?t("span",{staticStyle:{"padding-right":"10px"}},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyOrderCancel"),expression:"$authority.indexOf('dailyOrderCancel') != '-1'"}],attrs:{type:"primary"},on:{click:e.cancelRoomOrder}},[e._v("取消订单")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyOrderDistributeRoom"),expression:"$authority.indexOf('dailyOrderDistributeRoom') != '-1'"}],attrs:{type:"primary"},on:{click:e.enterDistributeRoom}},[e._v("立即分房")])],1):e._e(),"2"!=e.orderRoomDetail.personStatus.val||e.orderRoomDetail.personStatus.hasBigger?e._e():t("span",{staticStyle:{"padding-right":"10px"}},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyOrderCancelRoom"),expression:"$authority.indexOf('dailyOrderCancelRoom') != '-1'"}],attrs:{type:"primary"},on:{click:function(o){e.dialogCancelDistribute=!0}}},[e._v("取消分房")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyOrderCancel"),expression:"$authority.indexOf('dailyOrderCancel') != '-1'"}],attrs:{type:"primary"},on:{click:e.cancelRoomOrder}},[e._v("取消订单")])],1),"2"==e.orderRoomDetail.personStatus.val||"3"==e.orderRoomDetail.personStatus.val?t("span",[t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyRoomOrderEdit"),expression:"$authority.indexOf('dailyRoomOrderEdit') != '-1'"}],attrs:{type:"primary"},on:{click:function(o){return e.enterEditRoomOrder("orderDetail")}}},[e._v("修改订单")])],1):e._e()]),t("span",["2"==e.orderRoomDetail.personStatus.val&&"-1"!=e.$authority.indexOf("dailyRoomLiveIn")?t("el-button",{attrs:{type:"primary"},on:{click:function(o){return e.enterEditRoomOrder("CheckLive")}}},[e._v("办理入住")]):e._e(),"2"==e.orderRoomDetail.personStatus.val&&e.orderRoomDetail.personStatus.hasBigger&&"-1"!=e.$authority.indexOf("dailyRoomExitRoom")?t("el-button",{attrs:{type:"primary"},on:{click:function(o){e.dialogExitRoom=!0}}},[e._v("办理退房")]):e._e(),"3"==e.orderRoomDetail.personStatus.val&&"-1"!=e.$authority.indexOf("dailyRoomExitRoom")?t("el-button",{attrs:{type:"primary"},on:{click:function(o){return e.enterEditRoomOrder("exitRoom")}}},[e._v("办理退房")]):e._e()],1)])])],1):e._e(),e.dialogExitRoom?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"办理退房",visible:e.dialogExitRoom,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"980px","before-close":e.closeDialogExitRoom},on:{"update:visible":function(o){e.dialogExitRoom=o}}},[t("div",{staticClass:"room-puple-detail"},[t("div",{staticClass:"person-info",staticStyle:{"margin-top":"0px"}},e._l(e.exitPersonList,function(o,i){return t("el-row",{key:i},[t("el-col",{attrs:{span:6}},[t("el-checkbox",{on:{change:function(o){return e.changeExitPersonChoice(i)}},model:{value:o.isChecked,callback:function(t){e.$set(o,"isChecked",t)},expression:"item.isChecked"}},[e._v(e._s(o.dailyRoomName||"-")+" ("+e._s(o.dailyRoomTypeName||"-")+")")])],1),t("el-col",{attrs:{span:12}},[t("span",{staticStyle:{"font-size":"14px"}},[e._v("入离："+e._s(o.startDate||"-")+" 至 "+e._s(o.endDate||"-")+" 入住"+e._s(o.nights||"0")+"晚")])]),t("el-col",{attrs:{span:4}},[t("span",{staticStyle:{"font-size":"14px"}},[e._v("房费：￥"+e._s(o.roomAmount||"0"))])])],1)}),1),t("div",{staticClass:"title-font mt-10"},[e._v("收支信息")]),t("el-row",[t("el-col",{attrs:{span:8}},[e._v("订单金额：￥"),t("span",[e._v(e._s(e.roomLiveInfo.orderTotalMoney||"0"))]),e._v("（房费"),t("span",[e._v(e._s(e.roomLiveInfo.roomTotalPrice||"0"))]),e._v("）")]),t("el-col",{attrs:{span:4}},[e._v("押金: ￥"+e._s(e.roomLiveInfo.roomDepositMoney||"0"))]),t("el-col",{attrs:{span:5}},[e._v("已收款: ￥"+e._s(e.roomExitInfo.depositDeduct?e.roomLiveInfo.receiveMoney+e.roomLiveInfo.roomDepositMoney:e.roomLiveInfo.receiveMoney))]),e.roomExitInfo.depositDeduct?t("el-col",{staticClass:"green",attrs:{span:4}},[e._v(e._s(e.roomLiveInfo.needMoney-e.roomLiveInfo.roomDepositMoney>=0?"需补交":"需退回")+"：￥"+e._s(Math.abs(e.roomLiveInfo.needMoney-e.roomLiveInfo.roomDepositMoney||"0")))]):t("el-col",{staticClass:"green",attrs:{span:4}},[e._v(e._s(e.roomLiveInfo.needMoney>=0?"需补交":"需退回")+"：￥"+e._s(Math.abs(e.roomLiveInfo.needMoney||"0")))]),t("el-col",{staticClass:"green",staticStyle:{"text-align":"right",cursor:"pointer"},attrs:{span:3},nativeOn:{click:function(o){return e.insertAddtionPay(o)}}},[t("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加款项")])],1),e.roomExitInfo.showAddtionPay?t("div",{staticClass:"person-info",staticStyle:{"margin-top":"0px"}},[t("el-row",[t("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?3:4}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"费用类型",size:"small"},on:{change:function(o){return e.changeIncomeFeeVal("DirectLive")}},model:{value:e.roomLiveInfo.incomeMoneyType,callback:function(o){e.$set(e.roomLiveInfo,"incomeMoneyType",o)},expression:"roomLiveInfo.incomeMoneyType"}},e._l(e.incomeFeeTypeList,function(e){return t("el-option",{key:e.feeTypeId,attrs:{label:e.feeTypeName,value:e.feeTypeId}})}),1)],1),3==e.roomLiveInfo.incomeMoneyType?t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"其它费用",size:"small"},model:{value:e.roomLiveInfo.incomeAddtionMoneyType,callback:function(o){e.$set(e.roomLiveInfo,"incomeAddtionMoneyType",o)},expression:"roomLiveInfo.incomeAddtionMoneyType"}},e._l(e.incomeAddtionFeeList,function(e){return t("el-option",{key:e.detailFeeTypeId,attrs:{label:e.feeName,value:e.detailFeeTypeId}})}),1)],1):e._e(),t("el-col",{attrs:{span:3}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"收/支",size:"small"},on:{change:function(o){return e.changeIncomePayType("DirectLive")}},model:{value:e.roomLiveInfo.incomeReceiveType,callback:function(o){e.$set(e.roomLiveInfo,"incomeReceiveType",o)},expression:"roomLiveInfo.incomeReceiveType"}},e._l(e.incomeOrPayList,function(e){return t("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?3:4}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"房间",size:"small"},on:{change:function(o){return e.getMoneyDayList("exitRoom")}},model:{value:e.roomLiveInfo.incomeChoiceRoom,callback:function(o){e.$set(e.roomLiveInfo,"incomeChoiceRoom",o)},expression:"roomLiveInfo.incomeChoiceRoom"}},e._l(e.roomLimitTypeList,function(e,o){return t("el-option",{key:o,attrs:{label:e.dailyRoomName,value:e.dailyRoomId}})}),1)],1),t("el-col",{attrs:{span:3==e.roomLiveInfo.incomeMoneyType?4:5}},[t("el-col",{attrs:{span:1==e.roomLiveInfo.incomeMoneyType?5:7}},[e._v("金额")]),t("el-col",{directives:[{name:"show",rawName:"v-show",value:1==e.roomLiveInfo.incomeMoneyType,expression:"roomLiveInfo.incomeMoneyType == 1"}],attrs:{span:9}},[t("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"天数",size:"small"},on:{change:function(o){return e.changeMoneyDayVal("exitRoom")}},model:{value:e.roomLiveInfo.rentMoneyDay,callback:function(o){e.$set(e.roomLiveInfo,"rentMoneyDay",o)},expression:"roomLiveInfo.rentMoneyDay"}},e._l(e.moneyChoiceDayList,function(e,o){return t("el-option",{key:o,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:1==e.roomLiveInfo.incomeMoneyType?9:15}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{disabled:1==e.roomLiveInfo.incomeMoneyType&&!e.roomLiveInfo.moneyCanEidt,controls:!1,min:0,size:"small"},model:{value:e.roomLiveInfo.incomeMoney,callback:function(o){e.$set(e.roomLiveInfo,"incomeMoney",o)},expression:"roomLiveInfo.incomeMoney"}})],1)],1),t("el-col",{attrs:{span:e.roomLiveInfo.showPayNo?3:4}},[t("el-col",{attrs:{span:22}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.roomLiveInfo.showPayType,placeholder:"支付方式",size:"small"},on:{change:function(o){return e.changeAddtionPayType("DirectLive")}},model:{value:e.roomLiveInfo.incomePayType,callback:function(o){e.$set(e.roomLiveInfo,"incomePayType",o)},expression:"roomLiveInfo.incomePayType"}},e._l(e.incomePayTypeList,function(e){return t("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),t("el-col",{attrs:{span:e.roomLiveInfo.showPayNo?5:4}},[e.roomLiveInfo.showPayNo?t("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogSettleAccounts}},[e._v("单号 \n                        "),!e.dialogReserveSettleAccounts&&e.settleAccount.newVal.length>0?t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]):e._e(),t("el-button",{staticClass:"greenBtn",staticStyle:{position:"relative"},attrs:{size:"mini"},on:{click:e.openDialogReserveLabel}},[e._v("备注 \n                        "),!e.dialogReserveLabel&&e.reserveLabel.isInsert&&e.reserveLabel.newVal.length>0?t("i",{staticClass:"el-icon-check",staticStyle:{position:"absolute",bottom:"2px"}}):e._e()]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveReserveIncomeInfo}},[e._v("保存")])],1)],1)],1):e._e(),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderReserveTable,border:""}},[t("el-table-column",{attrs:{prop:"moneyTypeName",align:"center",label:"费用类型"}}),t("el-table-column",{attrs:{prop:"incomeName",align:"center",label:"收/支"},scopedSlots:e._u([{key:"default",fn:function(o){return[2==o.row.income?t("span",{staticStyle:{color:"#24b0fc"}},[e._v("+"+e._s(o.row.money)+e._s(o.row.incomeName||"-"))]):1==o.row.income?t("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(o.row.money)+e._s(o.row.incomeName||"-"))]):t("span",{staticStyle:{color:"#ff0000"}},[e._v("-"+e._s(o.row.money)+e._s(o.row.incomeName||"-"))])]}}],null,!1,3738689072)}),t("el-table-column",{attrs:{prop:"payTypeName",align:"center",label:"支付方式"}}),t("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房间"}}),t("el-table-column",{attrs:{prop:"operatorTime",align:"center",label:"操作时间"}}),t("el-table-column",{attrs:{prop:"payNo",align:"center",label:"挂账单号"}}),t("el-table-column",{attrs:{prop:"operatorName",align:"center",label:"操作人"}}),t("el-table-column",{attrs:{prop:"operate",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(o){return[1==o.row.income?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.deleteOrderRoom(o.row)}}},[e._v("删除")]):e._e(),1==o.row.income?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.getReceiveMoney(o.row)}}},[e._v("收款")]):e._e(),2==o.row.income&&o.row.refundAmount&&o.row.refundAmount>0?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.getBackMoney(o.row)}}},[e._v("退款")]):e._e()]}}],null,!1,4125500932)})],1)],1),t("div",{staticClass:"mt-10"},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"订单备注..."},model:{value:e.roomLiveInfo.label,callback:function(o){e.$set(e.roomLiveInfo,"label",o)},expression:"roomLiveInfo.label"}})],1),t("div",{staticClass:"right-space-btn mt-10"},[t("el-checkbox",{model:{value:e.roomExitInfo.depositDeduct,callback:function(o){e.$set(e.roomExitInfo,"depositDeduct",o)},expression:"roomExitInfo.depositDeduct"}},[e._v("押金抵扣")]),t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmClearAndExitRoom}},[e._v("结账退房")])],1)],1)])],1):e._e(),e.dialogCancelDistribute?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"取消分房",visible:e.dialogCancelDistribute,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"460px","before-close":function(){return e.dialogCancelDistribute=!1}},on:{"update:visible":function(o){e.dialogCancelDistribute=o}}},[t("div",{staticClass:"room-puple-detail"},[t("p",[e._v("\n                  确定取消分房吗？\n                ")]),t("p",[e._v("\n                  取消分房的订单，在“订单-待分房”列表中，并支持重新分房\n                ")]),t("div",{staticClass:"right-space-btn"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitCancelDistribute}},[e._v("确定")])],1)])])],1):e._e(),e.dialogDailyAccount?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"日租记账",visible:e.dialogDailyAccount,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px","before-close":function(){return e.dialogDailyAccount=!1}},on:{"update:visible":function(o){e.dialogDailyAccount=o}}},[t("div",{staticClass:"room-puple-detail",staticStyle:{"padding-left":"10px"}},[t("el-row",{staticClass:"mb-10"},[t("el-col",{staticClass:"puple-account-choice",attrs:{span:5}},[t("span",{class:{"choice-income-active":"income"==e.dailyAccount.accountType},on:{click:function(o){return e.changeAccountType("income")}}},[e._v("收入")]),t("span",{class:{"choice-income-active":"outcome"==e.dailyAccount.accountType},on:{click:function(o){return e.changeAccountType("outcome")}}},[e._v("支出")])]),t("el-col",{attrs:{span:19}},[t("el-col",{staticClass:"is-required-b",attrs:{span:3}},[e._v("楼盘")]),t("el-col",{attrs:{span:20}},[t("el-select",{staticStyle:{width:"98%"},attrs:{placeholder:"请选择楼盘",size:"small"},model:{value:e.dailyAccount.projectId,callback:function(o){e.$set(e.dailyAccount,"projectId",o)},expression:"dailyAccount.projectId"}},e._l(e.projectList,function(e){return t("el-option",{key:e.dailyRentalId,attrs:{label:e.name,value:e.dailyRentalId}})}),1)],1)],1)],1),t("el-row",{staticClass:"mb-10"},[t("el-col",{attrs:{span:12}},[t("el-col",{staticClass:"is-required-b",attrs:{span:4}},[e._v("金额")]),t("el-col",{attrs:{span:18}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.dailyAccount.money,callback:function(o){e.$set(e.dailyAccount,"money",o)},expression:"dailyAccount.money"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-col",{staticClass:"is-required-b",attrs:{span:4}},[e._v("日期")]),t("el-col",{attrs:{span:18}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择时间"},model:{value:e.dailyAccount.date,callback:function(o){e.$set(e.dailyAccount,"date",o)},expression:"dailyAccount.date"}})],1)],1)],1),t("el-row",{staticClass:"mb-10"},[t("el-col",{attrs:{span:12}},[t("el-col",{staticClass:"is-required-b",attrs:{span:8}},[e._v("费用类型")]),t("el-col",{attrs:{span:14}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择费用类型",size:"small"},model:{value:e.dailyAccount.moneyType,callback:function(o){e.$set(e.dailyAccount,"moneyType",o)},expression:"dailyAccount.moneyType"}},e._l(e.moneyTypeList,function(e,o){return t("el-option",{key:o,attrs:{label:e.feeName,value:e.detailFeeTypeId}})}),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-col",{staticClass:"is-required-b",attrs:{span:8}},[e._v("支付方式")]),t("el-col",{attrs:{span:14}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择支付方式",size:"small"},model:{value:e.dailyAccount.payType,callback:function(o){e.$set(e.dailyAccount,"payType",o)},expression:"dailyAccount.payType"}},e._l(e.incomePayTypeList,function(e){return t("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:23}},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"备注"},model:{value:e.dailyAccount.label,callback:function(o){e.$set(e.dailyAccount,"label",o)},expression:"dailyAccount.label"}})],1)],1),t("div",{staticClass:"right-space-btn mt-10",staticStyle:{"padding-right":"20px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitDailyAccount}},[e._v("确定")])],1)],1)])],1):e._e(),e.dialogRoomStatusList?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:e.roomOrderInfo.name,visible:e.dialogRoomStatusList,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"960px","before-close":function(){return e.dialogRoomStatusList=!1}},on:{"update:visible":function(o){e.dialogRoomStatusList=o}}},[t("div",{staticClass:"room-puple-detail"},[t("div",{staticClass:"mb-10"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roomOrderNumTable,border:""}},[t("el-table-column",{attrs:{prop:"dailyOrderSourceName",align:"center",label:"渠道"}}),t("el-table-column",{attrs:{prop:"orgName",align:"center",label:"客人入住信息",width:"250"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("div",[t("div",{domProps:{innerHTML:e._s(o.row.first.name||"-")}}),t("div",[t("span",[e._v(e._s(o.row.startDate||"")+" - "+e._s(o.row.endDate||"")+" 共"+e._s(o.row.dayNum)+"晚")])])])]}}],null,!1,536517040)}),t("el-table-column",{attrs:{prop:"roomAmount",align:"center",label:"金额"}}),t("el-table-column",{attrs:{prop:"dailyRoomTypeName",align:"center",label:"房型"}}),"今日预离"==e.roomOrderInfo.name?t("el-table-column",{attrs:{prop:"status",align:"center",label:"入住状态"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("div",[e._v("\n                              已入住\n                            ")])]}}],null,!1,2838196228)}):e._e(),t("el-table-column",{attrs:{prop:"status",align:"center",label:"房间号"},scopedSlots:e._u([{key:"default",fn:function(o){return[o.row.orderStatus&&"1"==o.row.orderStatus.val?t("div",[t("span",[e._v("未分房")])]):t("div",[t("span",[e._v(e._s(o.row.dailyBuildName||"-")+"("+e._s(o.row.dailyRoomName||"-")+")")])])]}}],null,!1,663897673)}),t("el-table-column",{attrs:{prop:"operator",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyRoomOrderDetail"),expression:"$authority.indexOf('dailyRoomOrderDetail') != '-1'"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return t.stopPropagation(),e.handleTableCurrentChange(o.row)}}},[e._v("详情")])]}}],null,!1,2554803343)})],1)],1)])])],1):e._e(),e.dialogCancelOrder?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"取消订单",visible:e.dialogCancelOrder,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"660px","before-close":function(){return e.dialogCancelOrder=!1}},on:{"update:visible":function(o){e.dialogCancelOrder=o}}},[t("div",{staticClass:"room-puple-detail"},[t("p",{staticStyle:{"text-align":"center"}},[e._v("\n                  该订单已收款"),t("span",{staticStyle:{color:"#ff0000"}},[e._v("￥"+e._s(e.orderRoomDetail.receiveMoney||"0"))]),e._v("，是否确认取消订单？\n                ")]),t("div",[t("el-row",[t("el-col",{attrs:{span:6}},[e._v("是否需要退款：")]),t("el-col",{attrs:{span:18}},[t("el-radio",{attrs:{label:"1"},model:{value:e.cancelOrder.backMoney,callback:function(o){e.$set(e.cancelOrder,"backMoney",o)},expression:"cancelOrder.backMoney"}},[e._v("不需要")]),t("el-radio",{attrs:{label:"2"},model:{value:e.cancelOrder.backMoney,callback:function(o){e.$set(e.cancelOrder,"backMoney",o)},expression:"cancelOrder.backMoney"}},[e._v("需要")])],1)],1),2==e.cancelOrder.backMoney?t("el-row",{staticClass:"mt-10"},[t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderBackMoneyTable,border:""}},[t("el-table-column",{attrs:{prop:"moneyTypeName",align:"center",label:"费用类型"}}),t("el-table-column",{attrs:{prop:"incomeName",align:"center",label:"收/支"},scopedSlots:e._u([{key:"default",fn:function(o){return[2==o.row.income?t("span",{staticStyle:{color:"#24b0fc"}},[e._v("+"+e._s(o.row.money)+e._s(o.row.incomeName||"-"))]):t("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(o.row.money)+e._s(o.row.incomeName||"-"))])]}}],null,!1,18178844)}),t("el-table-column",{attrs:{prop:"payTypeName",align:"center",label:"支付方式"}}),t("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房间"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",[e._v(e._s(o.row.roomName))]),t("span",[e._v(e._s(o.row.roomDailyTypeName))])]}}],null,!1,3653808405)}),t("el-table-column",{attrs:{prop:"operatorTime",align:"center",label:"操作时间"}}),t("el-table-column",{attrs:{prop:"operatorName",align:"center",label:"操作人"}}),t("el-table-column",{attrs:{prop:"operate",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(o){return[1==o.row.income?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.deleteOrderRoom(o.row)}}},[e._v("删除")]):e._e(),1==o.row.income?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.getReceiveMoney(o.row)}}},[e._v("收款")]):e._e(),2==o.row.income?t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.getBackMoney(o.row)}}},[e._v("退款")]):e._e(),t("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.showTableReserveLabel(o.row)}}},[e._v("备注")])]}}],null,!1,1079154164)})],1)],1)]):e._e(),t("el-row",{staticClass:"mt-10"},[t("el-col",{attrs:{span:24}},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:5,maxRows:8},placeholder:"备注"},model:{value:e.cancelOrder.label,callback:function(o){e.$set(e.cancelOrder,"label",o)},expression:"cancelOrder.label"}})],1)],1),t("el-row",{staticClass:"mt-10"},[t("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("选择取消订单原因：")]),t("el-col",{attrs:{span:18}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择取消原因",size:"small"},model:{value:e.cancelOrder.reason,callback:function(o){e.$set(e.cancelOrder,"reason",o)},expression:"cancelOrder.reason"}},e._l(e.cancelOrderReasonList,function(e,o){return t("el-option",{key:o,attrs:{label:e.info,value:e.dailyOrderClosedId}})}),1)],1)],1)],1),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitCancelOrder}},[e._v("确定")])],1)])])],1):e._e(),e.dialogHandOver&&"-1"!=e.$authority.indexOf("dailyOrderHandOver")?t("div",{staticClass:"my-puple has-print-content"},[t("el-dialog",{attrs:{title:"交班",visible:e.dialogHandOver,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"940px","before-close":function(){return e.dialogHandOver=!1}},on:{"update:visible":function(o){e.dialogHandOver=o}}},[t("div",{ref:"print",staticClass:"room-puple-detail is-print-container"},[t("div",{staticClass:"handle-title"},[e._v("\n                  "+e._s(e.handleOverInfo.orderName||"-")+"-交班汇总报表\n                ")]),t("div",{staticClass:"mb-10"},[t("el-row",[t("el-col",{attrs:{span:11}},[e._v("营业日期："+e._s(e.handleOverInfo.saleStartData||"-")+"/"+e._s(e.handleOverInfo.saleEndData||"-"))]),t("el-col",{attrs:{span:5}},[e._v("收银员："+e._s(e.handleOverInfo.user||"-"))]),t("el-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[e._v("班次："+e._s(e.handleOverInfo.orderName)+"("+e._s(e.handleOverInfo.duringStartTime)+"-"+e._s(e.handleOverInfo.duringEndTime)+")")])],1)],1),t("div",{staticClass:"handle-over-account mb-10"},[t("div",{staticClass:"table-header"},[e._v("本班账务发生合计")]),t("div",{staticClass:"print-table"},[t("div",{staticClass:"print-table-row"},[t("div",[e._v("序号")]),t("div",[e._v("支付方式")]),t("div",[e._v("收入金额(元)")]),t("div",[e._v("支出金额(元)")]),t("div",[e._v("合计(元)")])]),e._l(e.finalAggregateTable,function(o,i){return i<e.finalAggregateTable.length-1?t("div",{key:i,staticClass:"print-table-row"},[t("div",[e._v(e._s(i+1))]),t("div",[e._v(e._s(o.payName||"-"))]),t("div",[e._v(e._s(o.incomeTotal||"-"))]),t("div",[e._v(e._s(o.payoutTotal||"-"))]),t("div",[e._v(e._s(o.total||"-"))])]):e._e()}),t("div",{staticClass:"print-table-row table-total"},[t("div",[e._v("合计")]),t("div"),t("div",[e._v(e._s(e.finalAggregateTable[e.finalAggregateTable.length-1].incomeTotal||"-"))]),t("div",[e._v(e._s(e.finalAggregateTable[e.finalAggregateTable.length-1].payoutTotal||"-"))]),t("div",[e._v(e._s(e.finalAggregateTable[e.finalAggregateTable.length-1].total||"-"))])])],2)]),t("span",{staticClass:"room-info-footer mt-10 mb-10 no-print",attrs:{slot:"footer"},slot:"footer"},[t("span",[t("span",[t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyRoomHandlePrint"),expression:"$authority.indexOf('dailyRoomHandlePrint') != '-1'"}],attrs:{type:"primary"},on:{click:e.doPrintHandleOver}},[e._v("打印")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyRoomHandleExport"),expression:"$authority.indexOf('dailyRoomHandleExport') != '-1'"}],attrs:{type:"primary"},on:{click:e.exportHandleOver}},[e._v("导出")])],1)]),t("span",[t("el-button",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyHandleOverExit"),expression:"$authority.indexOf('dailyHandleOverExit') != '-1'"}],staticStyle:{"background-color":"#0bccbe",border:"0px"},attrs:{type:"primary"},on:{click:e.exitHandleOver}},[e._v("确认正常并退出")])],1)])])])],1):e._e(),e.dialogChoiceFlightSelection?t("div",{staticClass:"my-puple dialog-rom-operate"},[t("el-dialog",{attrs:{title:"班次选择",visible:e.dialogChoiceFlightSelection,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"500px","before-close":e.closeDialogLabel},on:{"update:visible":function(o){e.dialogChoiceFlightSelection=o}}},[t("div",{staticClass:"room-puple-detail"},[t("el-row",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("dailyRoomStateSearch"),expression:"$authority.indexOf('dailyRoomStateSearch') != '-1'"}],staticClass:"select-rental mb-10"},[t("el-col",{attrs:{span:4}},[e._v("楼盘")]),t("el-col",{attrs:{span:20}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.changeProjectHandleOver},model:{value:e.handleOverInfo.projectId,callback:function(o){e.$set(e.handleOverInfo,"projectId",o)},expression:"handleOverInfo.projectId"}},e._l(e.projectList,function(e){return t("el-option",{key:e.dailyRentalId,attrs:{label:e.name,value:e.dailyRentalId}})}),1)],1)],1),t("div",{staticClass:"mt-10 room-time-selection"},e._l(e.handleOverList,function(o,i){return t("div",{key:i,on:{click:function(o){return e.choiceHandleTime(i)}}},[t("div",{staticClass:"selection-title"},[e._v(e._s(o.className))]),t("div",{staticClass:"selection-time"},[e._v(e._s(o.beginTime)+"-"+e._s(o.endTime))])])}),0)],1)])],1):e._e(),e.dialogAddRoomPerson?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"入住人信息",visible:e.dialogAddRoomPerson,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"760px","before-close":function(){return e.dialogAddRoomPerson=!1}},on:{"update:visible":function(o){e.dialogAddRoomPerson=o}}},[t("div",{staticClass:"room-puple-detail"},[t("div",e._l(e.personShow.List,function(o,i){return t("el-row",{key:i,staticClass:"mb-10"},[t("el-col",{attrs:{span:6}},[t("el-col",{staticClass:"is-required-b",attrs:{span:6}},[e._v("姓名")]),t("el-col",{attrs:{span:16}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:o.name,callback:function(t){e.$set(o,"name",t)},expression:"item.name"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:5}},[e._v("手机")]),t("el-col",{attrs:{span:17}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:o.phone,callback:function(t){e.$set(o,"phone",t)},expression:"item.phone"}})],1)],1),t("el-col",{attrs:{span:10}},[t("el-col",{attrs:{span:10}},[t("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"证件类型",size:"small"},model:{value:o.cardType,callback:function(t){e.$set(o,"cardType",t)},expression:"item.cardType"}},e._l(e.cardTypeList,function(e){return t("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1),t("el-col",{attrs:{span:14}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:o.cardNo,callback:function(t){e.$set(o,"cardNo",t)},expression:"item.cardNo"}})],1)],1),t("el-col",{attrs:{span:2}},[t("i",{staticClass:"el-icon-remove add-margin",staticStyle:{margin:"0 6px"},on:{click:function(o){return e.deletePersonDialog(i)}}}),i==e.personShow.List.length-1?t("i",{staticClass:"el-icon-circle-plus add-margin",staticStyle:{color:"#f3893b",cursor:"pointer","font-size":"18px"},on:{click:e.insertPersonDialog}}):e._e()])],1)}),1),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.dialogHideRoomPerson}},[e._v("保存")])],1)])])],1):e._e(),e.dialogSendMessage?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"发送短信",visible:e.dialogSendMessage,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"460px","before-close":function(){return e.dialogSendMessage=!1}},on:{"update:visible":function(o){e.dialogSendMessage=o}}},[t("div",{staticClass:"mb-10"},[e._v("\n              收件人："+e._s(e.sendMessageInfo.name||"-")+"("+e._s(e.sendMessageInfo.phone||"-")+")\n            ")]),t("div",{staticClass:"mb-10"},[t("el-radio-group",{on:{change:e.changeSendMessageType},model:{value:e.sendMessageInfo.type,callback:function(o){e.$set(e.sendMessageInfo,"type",o)},expression:"sendMessageInfo.type"}},[t("el-radio",{attrs:{label:1}},[e._v("欢迎预定")]),t("el-radio",{attrs:{label:2}},[e._v("欢迎入住")]),t("el-radio",{attrs:{label:3}},[e._v("门锁密码")]),t("el-radio",{attrs:{label:4}},[e._v("再次光临")])],1)],1),t("div",{staticClass:"room-puple-detail"},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:8},placeholder:"请输入发送短信内容"},model:{value:e.sendMessageInfo.message,callback:function(o){e.$set(e.sendMessageInfo,"message",o)},expression:"sendMessageInfo.message"}}),t("div",{staticClass:"mb-10"}),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitSendMessage}},[e._v("立刻发送")])],1)],1)])],1):e._e(),e.dialogReserveLabel?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"备注",visible:e.dialogReserveLabel,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"460px","before-close":e.closeDialogReserveLabel},on:{"update:visible":function(o){e.dialogReserveLabel=o}}},[t("div",{staticClass:"room-puple-detail"},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:8},placeholder:"请添加备注内容"},model:{value:e.reserveLabel.newVal,callback:function(o){e.$set(e.reserveLabel,"newVal",o)},expression:"reserveLabel.newVal"}}),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveDialogReserveLabel}},[e._v("保存")])],1)],1)])],1):e._e(),e.dialogReserveSettleAccounts?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"挂账单号",visible:e.dialogReserveSettleAccounts,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"460px","before-close":e.closeDialogSettleAccounts},on:{"update:visible":function(o){e.dialogReserveSettleAccounts=o}}},[t("div",{staticClass:"room-puple-detail"},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:8},placeholder:"请输入挂账单号"},model:{value:e.settleAccount.newVal,callback:function(o){e.$set(e.settleAccount,"newVal",o)},expression:"settleAccount.newVal"}}),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{staticClass:"greenBtn",on:{click:e.closeDialogSettleAccounts}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveDialogSettleAccounts}},[e._v("保存")])],1)],1)])],1):e._e(),e.dialogRoomRemainTime?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"房间保留时间",visible:e.dialogRoomRemainTime,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"360px","before-close":e.closeDialogRemainTime},on:{"update:visible":function(o){e.dialogRoomRemainTime=o}}},[t("div",{staticClass:"room-puple-detail"},[t("div",{staticStyle:{"margin-bottom":"20px"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择房间保留时间"},model:{value:e.remainTime.newVal,callback:function(o){e.$set(e.remainTime,"newVal",o)},expression:"remainTime.newVal"}})],1),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmChoiceRemainTime}},[e._v("保存")])],1)])])],1):e._e(),e.dialogLabel?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"备注",visible:e.dialogLabel,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"460px","before-close":e.closeDialogLabel},on:{"update:visible":function(o){e.dialogLabel=o}}},[t("div",{staticClass:"room-puple-detail"},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:8},placeholder:"请添加备注内容"},model:{value:e.allLable.newVal,callback:function(o){e.$set(e.allLable,"newVal",o)},expression:"allLable.newVal"}}),t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:function(o){e.dialogLabel=!1}}},[e._v("保存")])],1)],1)])],1):e._e(),e.dialogReceiveMoney?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"收款",visible:e.dialogReceiveMoney,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px","before-close":function(){return e.dialogReceiveMoney=!1}},on:{"update:visible":function(o){e.dialogReceiveMoney=o}}},[t("div",{staticClass:"room-puple-detail"},[t("el-row",{staticClass:"mb-10"},[t("el-col",{attrs:{span:12}},[t("el-col",{staticClass:"is-required-b",attrs:{span:8}},[e._v("收款途径：")]),t("el-col",{attrs:{span:12}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:e.receiveMoneyInfo.payType,callback:function(o){e.$set(e.receiveMoneyInfo,"payType",o)},expression:"receiveMoneyInfo.payType"}},e._l(e.incomePayTypeList,function(e){return t("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-col",{staticClass:"is-required-b",attrs:{span:8}},[e._v("收款金额：")]),t("el-col",{attrs:{span:12}},[t("el-input",{staticStyle:{width:"100%"},attrs:{disabled:"",size:"small"},model:{value:e.receiveMoneyInfo.money,callback:function(o){e.$set(e.receiveMoneyInfo,"money",o)},expression:"receiveMoneyInfo.money"}})],1)],1)],1),t("el-row",{staticClass:"mb-10"},[t("el-col",{attrs:{span:4}},[e._v("备注：")]),t("el-col",{attrs:{span:18}},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"备注"},model:{value:e.receiveMoneyInfo.label,callback:function(o){e.$set(e.receiveMoneyInfo,"label",o)},expression:"receiveMoneyInfo.label"}})],1)],1),t("el-row",[t("el-col",{attrs:{span:22}},[t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitReceiveMoney}},[e._v("确定")])],1)])],1)],1)])],1):e._e(),e.dialogExitMoney?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"退款",visible:e.dialogExitMoney,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px","before-close":function(){return e.dialogExitMoney=!1}},on:{"update:visible":function(o){e.dialogExitMoney=o}}},[t("div",{staticClass:"room-puple-detail"},[t("el-row",{staticClass:"mb-10"},[t("el-col",{staticClass:"is-required-b",attrs:{span:4}},[e._v("退款方式")]),t("el-col",{attrs:{span:18}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",size:"small"},model:{value:e.exitMoneyInfo.payType,callback:function(o){e.$set(e.exitMoneyInfo,"payType",o)},expression:"exitMoneyInfo.payType"}},e._l(e.incomePayTypeList,function(e){return t("el-option",{key:e.dailyDetailPayTypeId,attrs:{label:e.info,value:e.dailyDetailPayTypeId}})}),1)],1)],1),t("el-row",{staticClass:"mb-10"},[t("el-col",{attrs:{span:12}},[t("el-col",{staticClass:"is-required-b",attrs:{span:8}},[e._v("退款金额：")]),t("el-col",{attrs:{span:12}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.exitMoneyInfo.money,callback:function(o){e.$set(e.exitMoneyInfo,"money",o)},expression:"exitMoneyInfo.money"}})],1),t("el-col",{attrs:{span:2}},[e._v("元")])],1),e._e()],1),e._e(),e._e(),e._e(),t("el-row",{staticClass:"mb-10"},[t("el-col",{attrs:{span:4}},[e._v("备注：")]),t("el-col",{attrs:{span:18}},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"备注"},model:{value:e.exitMoneyInfo.label,callback:function(o){e.$set(e.exitMoneyInfo,"label",o)},expression:"exitMoneyInfo.label"}})],1)],1),t("el-row",[t("el-col",{attrs:{span:22}},[t("div",{staticClass:"right-space-btn mt-10"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitExitMoney}},[e._v("确定")])],1)])],1)],1)])],1):e._e(),e.dialogVisibleInsertDevice?t("div",{staticClass:"my-puple"},[t("el-dialog",{attrs:{title:"设备管理",visible:e.dialogVisibleInsertDevice,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px","before-close":function(){return e.dialogVisibleInsertDevice=!1}},on:{"update:visible":function(o){e.dialogVisibleInsertDevice=o}}},[t("el-row",[t("el-col",{attrs:{span:22}},[t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.changDeviceChoiceTabVal},model:{value:e.deviceInsertInfo.type,callback:function(o){e.$set(e.deviceInsertInfo,"type",o)},expression:"deviceInsertInfo.type"}},[t("el-tab-pane",{attrs:{label:"门禁",name:"door"}})],1)],1),t("el-row",{staticClass:"each-item"},[t("el-col",{staticClass:"is-required-a pl-10",attrs:{span:5}},[e._v("项目")]),t("el-col",{attrs:{span:17}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:"请选择"},on:{change:e.changeDevieProjectVal},model:{value:e.deviceInsertInfo.orgId,callback:function(o){e.$set(e.deviceInsertInfo,"orgId",o)},expression:"deviceInsertInfo.orgId"}},e._l(e.deviceProjectList,function(e){return t("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1)],1),t("el-row",{staticClass:"each-item"},[t("el-col",{staticClass:"is-required-a pl-10",attrs:{span:5}},[e._v("房间号")]),t("el-col",{attrs:{span:17}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:"请选择"},model:{value:e.deviceInsertInfo.roomId,callback:function(o){e.$set(e.deviceInsertInfo,"roomId",o)},expression:"deviceInsertInfo.roomId"}},e._l(e.deviceRoomList,function(e){return t("el-option",{key:e.roomId,attrs:{label:e.roomName,value:e.roomId}})}),1)],1)],1),t("el-row",{staticClass:"each-item"},[t("el-col",{staticClass:"is-required-a pl-10",attrs:{span:5}},[e._v("品牌")]),t("el-col",{attrs:{span:17}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.deviceInsertInfo.brandId,callback:function(o){e.$set(e.deviceInsertInfo,"brandId",o)},expression:"deviceInsertInfo.brandId"}},e._l(e.deviceBrandList,function(e){return t("el-option",{key:e.deviceCategotyId,attrs:{label:e.name,value:e.deviceCategotyId}})}),1)],1)],1),t("el-row",{staticClass:"each-item"},[t("el-col",{staticClass:"is-required-a pl-10",attrs:{span:5}},[e._v("设备序列号")]),t("el-col",{attrs:{span:17}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入设备序列号",clearable:""},model:{value:e.deviceInsertInfo.deviceNo,callback:function(o){e.$set(e.deviceInsertInfo,"deviceNo",o)},expression:"deviceInsertInfo.deviceNo"}})],1)],1),t("el-row",{staticClass:"each-item"},[t("el-col",{staticClass:"is-required-a pl-10",attrs:{span:5}},[e._v("设备名称")]),t("el-col",{attrs:{span:17}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入设备名称",clearable:""},model:{value:e.deviceInsertInfo.deviceName,callback:function(o){e.$set(e.deviceInsertInfo,"deviceName",o)},expression:"deviceInsertInfo.deviceName"}})],1)],1),t("el-row",{staticClass:"each-item"},[t("el-col",{staticClass:"is-required-a pl-10",attrs:{span:5}},[e._v("设备型号")]),t("el-col",{attrs:{span:17}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入设备型号",clearable:""},model:{value:e.deviceInsertInfo.deviceModel,callback:function(o){e.$set(e.deviceInsertInfo,"deviceModel",o)},expression:"deviceInsertInfo.deviceModel"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.comfirmSubmitInsertDevice}},[e._v("确 定")]),t("el-button",{staticClass:"greenBtn",on:{click:function(o){e.dialogVisibleInsertDevice=!1}}},[e._v("取 消")])],1)],1)],1):e._e(),t("div",{staticClass:"deep-container"},[t("el-row",[e.roomOrderNumList.length>=1?t("el-col",{attrs:{span:12}},e._l(e.roomOrderNumList,function(o,i){return t("span",{key:i,staticClass:"left",on:{click:function(t){return e.showOrderNumTable(o)}}},[e._v(e._s(o.status.text)+" "),t("span",{staticClass:"room-num"},[e._v(e._s(o.count))])])}),0):t("el-col",{attrs:{span:12}},[t("span",{staticClass:"left"},[e._v("   ")])]),t("el-col",{attrs:{span:12}},[t("span",{staticClass:"right-content"},[t("span",{staticClass:"online-room"},[e._v("实时房态")]),t("span",{staticClass:"room-time",on:{click:e.showDialogHandOver}},[e._v(e._s(e.handleOverInfo.orderName)+"："+e._s(e.handleOverInfo.duringStartTime)+"-"+e._s(e.handleOverInfo.duringEndTime))])]),t("span",{staticStyle:{float:"right","margin-right":"40px"}},[t("span",{staticClass:"center"},[t("span",{staticClass:"room-status"}),e._v("空置")]),t("span",{staticClass:"center"},[t("span",{staticClass:"room-status day-reserve"}),e._v("日租预定")]),t("span",{staticClass:"center"},[t("span",{staticClass:"room-status day-live"}),e._v("日租入住")]),t("span",{staticClass:"center"},[t("span",{staticClass:"room-status no-renting"}),e._v("不可租")])])])],1)],1)],1)},a=[],s=t("e7ba"),r=t("43bf"),n=t("90b9"),l={name:"realRoom",components:{roomType:s["a"],originList:r["a"]},data(){return{projectList:[],realRoomTable:[],orderReserveTable:[],orderListTable:[],roomStatusTable:[{}],dialogInsertLive:!1,dialogReserveNoChoice:!1,dialogInsertReserve:!1,dialogRoomDetail:!1,dialogExitRoom:!1,dialogDailyAccount:!1,dialogRoomStatusList:!1,dialogCancelOrder:!1,dialogHandOver:!1,dialogReserveLabel:!1,dialogLabel:!1,dialogTableVisibleprint:!1,dialogAddRoomPerson:!1,dialogCancelDistribute:!1,dialogReceiveMoney:!1,dialogExitMoney:!1,dialogChoiceFlightSelection:!1,dialogSendMessage:!1,dialogReserveSettleAccounts:!1,dialogRoomRemainTime:!1,dialogVisibleInsertDevice:!1,realRoomSearchInfo:{projectId:"",roomId:"",roomType:"",origins:"",sort:"",info:""},roomSortList:[],roomOrderNumList:[],roomOrderNumTable:[],roomOrderInfo:{name:"",type:""},roomManageInfo:{},noRoomReserveInfo:{name:"",phone:"",cardType:"",cardNo:"",origin:"",roomTotalPrice:"",startData:"",retentionTime:"",leaveData:"",night:"",priceSpecs:"",priceSpecsList:[],roomType:"",roomCount:"",price:"",priceDataList:[],label:""},noRoomNumTypeList:[],roomReserveInfo:{name:"",phone:"",cardType:"",cardNo:"",origin:"",roomTotalPrice:"",roomDepositMoney:"",orderTotalMoney:"",receiveMoney:"",needMoney:"",showAddtionPay:!1,incomeMoneyType:"",incomeAddtionMoneyType:"",incomeReceiveType:"",incomeChoiceRoom:"",rentMoneyDay:"",moneyCanEidt:!0,incomeMoney:"",incomePayType:"",oldPayType:"",showPayType:!0,payNo:"",showPayNo:!1,label:"",account:""},roomOriginList:[],cardTypeList:[],incomeFeeTypeList:[],incomeAddtionFeeList:[],incomeOrPayList:[],incomePayTypeList:[],roomTypeList:[],roomLimitTypeList:[],otherFeeTypeVal:3,reserveLabel:{index:0,isInsert:!1,originVal:"",dailyOrderDetailId:"",dailyOrderId:"",newVal:""},livePersonList:[{persons:[{name:"",phone:"",cardType:"",cardNo:""}],startData:"",leaveData:"",night:"",roomType:"",optionRooms:[],priceSpecs:"",priceSpecsList:[],roomTypeId:"",price:"",priceDataList:[]}],personShow:{index:0,from:"",List:[]},roomLiveInfo:{origin:"",roomTotalPrice:"",roomDepositMoney:"",orderTotalMoney:"",receiveMoney:"",needMoney:"",incomeMoneyType:"",incomeAddtionMoneyType:"",incomeReceiveType:"",incomeChoiceRoom:"",incomeMoney:"",incomePayType:"",rentMoneyDay:"",oldPayType:"",showPayType:!0,payNo:"",showPayNo:!1,showAddtionPay:!1,label:"",roomStatus:{},personStatus:{}},orderRoomDetail:{dailyOrderId:"",orderNo:"",orderTime:"",dailyOrderSourceId:"",dailyOrderSourceName:"",roomStatus:{},personStatus:{},roomTotalPrice:"",roomDepositMoney:"",orderTotalMoney:"",receiveMoney:"",needMoney:"",incomeMoneyType:"",incomeAddtionMoneyType:"",incomeReceiveType:"",incomeChoiceRoom:"",rentMoneyDay:"",moneyCanEidt:!0,incomeMoney:"",incomePayType:"",oldPayType:"",showPayType:!0,payNo:"",showPayNo:!1,showAddtionPay:!1,closedId:"",label:""},orderPersonList:[],roomOrderList:[{startData:"",leaveData:"",night:"0",roomType:"",optionRooms:[],priceSpecs:"",priceSpecsList:[],roomTypeId:"",price:"",priceDataList:[]}],cancelOrder:{backMoney:"1",money:"",payType:"",label:"",reason:""},cancelOrderReasonList:[],roomExitInfo:{showAddtionPay:!1,depositDeduct:!0},exitPersonList:[],receiveMoneyInfo:{payType:"",money:""},dailyAccount:{accountType:"income",projectId:"",money:"",date:"",moneyType:"",payType:"",label:""},moneyTypeList:[],handleOverInfo:{classId:"",projectId:"",orderName:"",duringStartTime:"",duringEndTime:"",user:"",saleStartData:"",saleEndData:""},handleOverList:[],finalAggregateTable:[],allLable:{type:"",originVal:"",newVal:""},settleAccount:{type:"",originVal:"",newVal:""},remainTime:{type:"",index:0,originVal:"",newVal:""},exitMoneyInfo:{refundDetailId:"",dailyOrderId:"",money:"",payType:"",status:"",label:""},receiveMoneyInfo:{dailyOrderDetailId:"",dailyOrderId:"",payType:"",money:"",label:"",payType:"",status:""},sendMessageInfo:{type:1,name:"",phone:"",message:"",dailyOrderRoomId:"",personList:[]},deviceInsertInfo:{type:"door",orgId:"",orgType:"",roomId:"",brandId:"",deviceNo:"",deviceName:"",deviceModel:""},deviceProjectList:[],moneyChoiceDayList:[],moneyDayInfo:{startData:"",endData:"",roomPrice:0,dayCount:0},deviceOriginProjectList:[],deviceRoomList:[],deviceBrandList:[],roomPriceTypeList:[],turnOver:{time:"",start:"",remain:""},currentPage:1,pageSize:10,total:10,currentData:"",printTableData:[],printInfo:{clickI:0,data1:[],printDate:"",printpeopleName:"",printaddes:"",total:0,uppercasetotal:"零",receivedtotal:0,dueintotal:0,creapeople:"",creDade:""}}},created(){this.getCurrentData(),this.getRoomPriceTypeList(),this.getHandleOverStatus()},computed:{},mounted(){},watch:{"$store.getters.getRealRoom.count"(){this.$store.getters.getRealRoom.isShow&&("account"==this.$store.getters.getRealRoom.from?(this.dailyAccount.accountType="income",this.dailyAccount.projectId="",this.dailyAccount.money="",this.dailyAccount.date="",this.dailyAccount.moneyType="",this.dailyAccount.payType="",this.dailyAccount.label="",0==this.incomePayTypeList.length&&this.getIncomePayTypeList(),0==this.moneyTypeList.length&&this.getMoneyTypeList(),this.dialogDailyAccount=!0):this.enterHeaderReserve())}},methods:{printVoucher(){this.$print(this.$refs.printcontainer)},printBtnAll(){this.printBtn({})},printBtn(e={}){try{let t=this,i={dailyOrderId:t.orderRoomDetail.dailyOrderId};e.dailyOrderRoomId&&(i.dailyOrderRoomId=e.dailyOrderRoomId),t.$http("/api/daily/order/getDailyOrderPrint",{method:"get",params:i}).then(e=>{let o=e.data;0==o.errorCode?(t.printInfo.printpeopleName=o.data.customerNames,t.printInfo.printpeopleName=t.printInfo.printpeopleName.join("、"),t.printInfo.printaddes=o.data.address,t.printInfo.printDate=Object(n["f"])(new Date),t.$set(t.printInfo,"total",o.data.amount||0),t.printInfo.uppercasetotal=Object(n["e"])(parseFloat(o.data.amount)),t.printInfo.receivedtotal=o.data.paidAmount,t.printInfo.dueintotal=o.data.nonPayAmount,t.printTableData=o.data.details,t.dialogTableVisibleprint=!0):t.$message.error("获取打印订单数据失败！")}).catch(e=>{console.log(e)})}catch(o){console.log(o)}},handleSizeChange(e){this.currentPage=1,this.pageSize=e,this.getRealRoomTable()},handleCurrentChange(e){this.currentPage=e,this.getRealRoomTable()},getCurrentData(){var e=(new Date).valueOf()/1e3;this.currentData=Object(n["l"])(e)},getProjectList(e=""){this.$http.get("/api/daily/order/getRentalList").then(o=>{var t=o.data;if(0==t.errorCode){if(this.projectList=t.data||[],this.projectList.length>0&&""==e?this.realRoomSearchInfo.projectId=this.projectList[0].dailyRentalId:this.realRoomSearchInfo.projectId=e,0==this.projectList.length)return;this.getRealRoomTable(),this.geRoomOrderNumList()}}).catch(function(e){console.log(e)})},getRealRoomTable(){if(0!=this.projectList.length){var e=[],o=[];if(this.$refs.roomType.roomTypeList&&this.$refs.roomType.roomTypeList.length>0)for(var t=0;t<this.$refs.roomType.roomTypeList.length;t++)this.$refs.roomType.roomTypeList[t].isChecked&&e.push(this.$refs.roomType.roomTypeList[t].dailyRoomTypeId);if(this.$refs.originList.roomOriginList&&this.$refs.originList.roomOriginList.length>0)for(t=0;t<this.$refs.originList.roomOriginList.length;t++)this.$refs.originList.roomOriginList[t].isChecked&&o.push(this.$refs.originList.roomOriginList[t].dailyOrderSourceId);var i={dailyRentalId:this.realRoomSearchInfo.projectId,dailyBuildId:"",dailyRoomId:this.realRoomSearchInfo.roomId,dailyOrderSourceIds:o.length>0?o.join(","):"",dailyRoomTypeId:"",dailyRoomTypeIds:e.length>0?e.join(","):"",clean:"",dailyOrderSourceId:this.realRoomSearchInfo.origin,otherInfo:this.realRoomSearchInfo.info,order:this.realRoomSearchInfo.sort};this.$http.get("/api/daily/order/real",{params:i}).then(e=>{var o=e.data;if(0==o.errorCode){this.realRoomTable=o.data||[];for(var t=0;t<this.realRoomTable.length;t++)this.realRoomTable[t].isShow=!1,this.realRoomTable[t].lived&&""!=this.realRoomTable[t].lived?this.realRoomTable[t].roomType="hasLived":this.realRoomTable[t].reserve&&""!=this.realRoomTable[t].reserve?this.realRoomTable[t].roomType="hasReserved":this.realRoomTable[t].roomRentStatus&&"2"==this.realRoomTable[t].roomRentStatus.val?this.realRoomTable[t].roomType="noRent":this.realRoomTable[t].roomType="empty"}}).catch(function(e){console.log(e)})}},changeRoomDirtStatus(e){var o=e.clean&&e.clean.val&&1==e.clean.val?2:e.clean&&e.clean.val&&2==e.clean.val?1:"";this.$http.post("/api/daily/rental/room/hygiene",{dailyRoomId:e.dailyRoomId,clean:o}).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"操作成功!",type:"success"}),this.getRealRoomTable(),this.geRoomOrderNumList())}).catch(function(e){console.log(e)})},getTurnOverTime(){return new Promise((e,o)=>{this.$http.get("/api/daily/rental/getTurnoverTime",{params:{dailyRentalId:this.realRoomSearchInfo.projectId}}).then(o=>{var t=o.data;0==t.errorCode&&(this.turnOver.start=t.data.times&&t.data.times.length>0?t.data.times[0].substring(0,10):this.currentData,this.turnOver.time=t.data.turnoverTime+":00",this.turnOver.remain=this.turnOver.start+" "+this.turnOver.time,e(this.turnOver))})})},sendRoomInfoMessage(e,o){this.sendMessageInfo.name=this.orderPersonList[e].first.name,this.sendMessageInfo.phone=this.orderPersonList[e].first.tel,this.sendMessageInfo.message="",this.sendMessageInfo.dailyOrderRoomId=this.orderPersonList[e].dailyOrderRoomId,this.sendMessageInfo.personList=this.orderPersonList[e].customers||[],this.sendMessageInfo.type=3==o?3:4==o?4:1,this.getMessageInfo()},getMessageInfo(){this.$http.get("/api/daily/order/getMessage",{params:{type:this.sendMessageInfo.type,dailyOrderRoomId:this.sendMessageInfo.dailyOrderRoomId}}).then(e=>{var o=e.data;0==o.errorCode&&(this.sendMessageInfo.message=o.message||"",this.dialogSendMessage=!0)}).catch(function(e){console.log(e)})},getRoomPriceTypeList(){this.$http.get("/api/daily/sales_chanel/list").then(e=>{var o=e.data;0==o.errorCode&&(this.roomPriceTypeList=o.data||[],this.roomPriceTypeList.push({chanelName:"手动",dailySalesChanelId:"handle"}))}).catch(function(e){console.log(e)})},changeSendMessageType(){this.getMessageInfo()},comfirmSubmitSendMessage(){for(var e=[],o=0;o<this.sendMessageInfo.personList.length;o++)e.push(this.sendMessageInfo.personList[o].tel);this.$http.post("/api/daily/order/sendMessage",{dailyOrderRoomId:this.sendMessageInfo.dailyOrderRoomId,content:this.sendMessageInfo.message,phones:e}).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"短信发送成功!",type:"success"}),this.dialogSendMessage=!1)}).catch(function(e){console.log(e)})},exportRealroomTable(){var e=this.dailyOrderSourceIds&&this.dailyOrderSourceIds.length>0?this.dailyOrderSourceIds.join(","):"",o=this.dailyRoomTypeId&&this.dailyRoomTypeId.length>0?this.dailyRoomTypeId.join(","):"",t=`./api/daily/order/realExport?dailyRentalId=${this.realRoomSearchInfo.projectId}\n          &dailyRoomId=${this.realRoomSearchInfo.roomId}&dailyOrderSourceIds=${e}\n          &dailyRoomTypeIds=${o}&dailyOrderSourceId=${this.realRoomSearchInfo.origin||""}\n          &otherInfo=${this.realRoomSearchInfo.info}&order=${this.realRoomSearchInfo.sort}`;window.open(t)},searchRealRoomTable(){this.currentPage=1,this.getRealRoomTable(),this.geRoomOrderNumList()},roomListHoverEnter(e){this.realRoomTable[e].isShow=!0;var o=this.realRoomTable[e];this.$set(this.realRoomTable,e,o)},roomListHoverLeave(e){this.realRoomTable[e].isShow=!1;var o=this.realRoomTable[e];this.$set(this.realRoomTable,e,o)},geRoomOrderNumList(){0!=this.projectList.length&&this.$http.get("/api/daily/order/realStatus",{params:{dailyRentalId:this.realRoomSearchInfo.projectId}}).then(e=>{var o=e.data;0==o.errorCode&&(this.roomOrderNumList=o.data||[])}).catch(function(e){console.log(e)})},getRoomSortList(){this.$http.get("/api/daily/order/public/sort").then(e=>{var o=e.data;0==o.errorCode&&(this.roomSortList=o.data||[])}).catch(function(e){console.log(e)})},showOrderNumTable(e){this.roomOrderInfo.name=e.status.text,this.roomOrderInfo.type=e.status.val,this.getOrderNumTable(e.status.val)},getOrderNumTable(e){this.$http.get("/api/daily/order/realList",{params:{dailyRentalId:this.realRoomSearchInfo.projectId,status:e}}).then(e=>{var o=e.data;if(0==o.errorCode){this.roomOrderNumTable=o.data||[];for(var t=0;t<this.roomOrderNumTable.length;t++)this.roomOrderNumTable[t].dayNum=this.formatDayNum(this.roomOrderNumTable[t].startDate,this.roomOrderNumTable[t].endDate);this.dialogRoomStatusList=!0}}).catch(function(e){console.log(e)})},formatDayNum(e,o){if(e&&e.length>0&&o&&o.length>0){var t=e.split("-"),i=o.split("-"),a=new Date(t[0],t[1],t[2]),s=new Date(i[0],i[1],i[2]),r=(s.getTime()-a.getTime())/864e5;return r}return""},async enterHeaderReserve(){var e=[];e=JSON.parse(JSON.stringify(this.roomPriceTypeList));var o=await this.getTurnOverTime();this.roomManageInfo.manageType="noRoomReserve",this.noRoomReserveInfo.name="",this.noRoomReserveInfo.phone="",this.noRoomReserveInfo.cardType="",this.noRoomReserveInfo.cardNo="",this.noRoomReserveInfo.origin="",this.noRoomReserveInfo.roomTotalPrice=0,this.noRoomReserveInfo.startData=o.start||this.currentData,this.noRoomReserveInfo.retentionTime=o.remain||this.noRoomReserveInfo.startData+" 12:00:00",this.noRoomReserveInfo.leaveData=Object(n["h"])("next",this.noRoomReserveInfo.startData,1),this.noRoomReserveInfo.night=1,this.noRoomReserveInfo.roomType="",this.noRoomReserveInfo.priceSpecs=e[0].dailySalesChanelId,this.noRoomReserveInfo.priceSpecsList=e,this.noRoomReserveInfo.roomCount=1,this.noRoomReserveInfo.price=0,this.noRoomReserveInfo.label="",this.remainTime.originVal=this.noRoomReserveInfo.retentionTime,this.remainTime.newVal=this.noRoomReserveInfo.retentionTime,this.getCardTypeList("noRoomReserve"),this.getNoRoomTypeList(),this.roomOriginList=this.$refs.originList.roomOriginList||[],this.noRoomReserveInfo.origin=this.roomOriginList.length>0?this.roomOriginList[0].dailyOrderSourceId:"",this.dialogReserveNoChoice=!0},changeNoRoomTypeVal(){this.$http.get("/api/daily/room_type/prices",{params:{start:this.noRoomReserveInfo.startData,end:this.noRoomReserveInfo.leaveData,dailyRoomTypeId:this.noRoomReserveInfo.roomType,dailySalesChanelId:"handle"==this.noRoomReserveInfo.priceSpecs?"":this.noRoomReserveInfo.priceSpecs}}).then(e=>{var o=e.data;if(0==o.errorCode){var t=o.data.total||0,i=o.data.detail||[];this.noRoomReserveInfo.price=t/i.length,this.noRoomReserveInfo.roomTotalPrice=this.noRoomReserveInfo.roomCount*t,this.noRoomReserveInfo.priceDataList=i||[],this.calculateNoRoomPrice()}}).catch(function(e){console.log(e)})},changeNoRoomCount(){this.noRoomReserveInfo.leaveData=Object(n["h"])("next",this.noRoomReserveInfo.startData,this.noRoomReserveInfo.night),this.changeNoRoomTypeVal()},changeDayRoomPriceVal(e,o){var t={};switch(e){case"reserve":t.start=this.roomOrderList[o].startData,t.end=this.roomOrderList[o].leaveData,t.dailyRoomId=this.roomOrderList[o].roomType,t.night=this.roomOrderList[o].night,t.priceSpecs=this.roomOrderList[o].priceSpecs;break;case"DirectLive":t.start=this.livePersonList[o].startData,t.end=this.livePersonList[o].leaveData,t.dailyRoomId=this.livePersonList[o].roomType,t.night=this.livePersonList[o].night,t.priceSpecs=this.livePersonList[o].priceSpecs;break;default:}this.getDayRoomPriceList(e,o,t)},getDayRoomPriceList(e,o,t){this.$http.get("/api/daily/room_type/room/prices",{params:{start:t.start,end:t.end,dailyRoomId:t.dailyRoomId,dailySalesChanelId:"handle"==t.priceSpecs?"":t.priceSpecs}}).then(t=>{var i=t.data;if(0==i.errorCode){for(var a=i.data||[],s=0,r=0;r<a.length;r++)s+=Number(a[r].price)||0;switch(e){case"reserve":this.roomOrderList[o].price=s/a.length,this.roomOrderList[o].priceDataList=a;break;case"DirectLive":this.livePersonList[o].price=s/a.length,this.livePersonList[o].priceDataList=a;break;default:}this.calculateRoomPrice(o)}}).catch(function(e){console.log(e)})},comfirmSubmitNoRoomReserve(){if(""==this.noRoomReserveInfo.name||void 0==this.noRoomReserveInfo.name)return this.$message({type:"error",message:"姓名不能为空!"});if(""==this.noRoomReserveInfo.phone||void 0==this.noRoomReserveInfo.phone)return this.$message({type:"error",message:"手机号码不能为空!"});if(""==this.noRoomReserveInfo.cardNo||void 0==this.noRoomReserveInfo.cardNo)return this.$message({type:"error",message:"证件号码不能为空!"});for(var e=[],o=[],t=0;t<this.noRoomReserveInfo.priceDataList.length;t++)o.push({time:this.noRoomReserveInfo.priceDataList[t].date,price:"handle"==this.noRoomReserveInfo.priceSpecs?this.noRoomReserveInfo.price:this.noRoomReserveInfo.priceDataList[t].price});var i="";for(t=0;t<this.roomPriceTypeList.length;t++)this.roomPriceTypeList[t].dailySalesChanelId==this.noRoomReserveInfo.priceSpecs&&(i=this.roomPriceTypeList[t].chanelName);e.push({startDate:this.noRoomReserveInfo.startData,retentionTime:this.noRoomReserveInfo.retentionTime,endDate:this.noRoomReserveInfo.leaveData,dailyRoomTypeId:this.noRoomReserveInfo.roomType,roomNum:this.noRoomReserveInfo.roomCount,customers:[{name:this.noRoomReserveInfo.name,tel:this.noRoomReserveInfo.phone,cardType:this.noRoomReserveInfo.cardType,cardNo:this.noRoomReserveInfo.cardNo}],roomStatus:"1",priceSpecs:"handle"==this.noRoomReserveInfo.priceSpecs?"-1":this.noRoomReserveInfo.priceSpecs,priceSpecsName:i,prices:o});var a={dailyRentalId:this.realRoomSearchInfo.projectId,sourceId:this.noRoomReserveInfo.origin,info:this.noRoomReserveInfo.label,rooms:e,incomes:[]};this.$http.post("/api/daily/order/create",a).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"预定成功!",type:"success"}),this.dialogReserveNoChoice=!1,this.getRealRoomTable(),this.geRoomOrderNumList())}).catch(function(e){console.log(e)})},enterRoomManage(e,o,t="me"){this.roomManageInfo=e||{},this.roomManageInfo.manageType=o,this.roomOriginList=this.$refs.originList.roomOriginList||[],this.roomManageInfo.from=t;var i=[];switch(i=JSON.parse(JSON.stringify(this.roomPriceTypeList)),o){case"reserve":this.enterReserveMode();break;case"DirectLive":if(this.roomManageInfo.manageTypeName="直接入住","me"!=t){"orderDetail"==t?this.roomManageInfo.manageTypeName="修改订单":"distributeDetail"==t?this.roomManageInfo.manageTypeName="分配房间":"compareLive"==t&&(this.roomManageInfo.manageTypeName="办理入住",this.roomManageInfo.from="me"),this.livePersonList=[],this.roomLiveInfo.dailyOrderId=this.orderRoomDetail.dailyOrderId,this.roomLiveInfo.orderNo=this.orderRoomDetail.orderNo,this.roomLiveInfo.dailyOrderSourceId=this.orderRoomDetail.dailyOrderSourceId,this.roomLiveInfo.label=this.orderRoomDetail.label,this.roomLiveInfo.roomTotalPrice=this.orderRoomDetail.roomTotalPrice,this.roomLiveInfo.orderTotalMoney=this.orderRoomDetail.orderTotalMoney,this.roomLiveInfo.roomDepositMoney=this.orderRoomDetail.roomDepositMoney,this.roomLiveInfo.receiveMoney=this.orderRoomDetail.receiveMoney,this.roomLiveInfo.needMoney=this.orderRoomDetail.needMoney,this.roomLiveInfo.origin=this.orderRoomDetail.dailyOrderSourceId,this.roomLiveInfo.incomeChoiceRoom=this.roomLimitTypeList.length>0?this.roomLimitTypeList[0].dailyRoomId:"",this.roomLiveInfo.showAddtionPay=!1,this.roomLiveInfo.roomStatus=this.orderRoomDetail.roomStatus||{},this.roomLiveInfo.personStatus=this.orderRoomDetail.personStatus||{};for(var a=0;a<this.orderPersonList.length;a++){for(var s=[],r=0;r<this.orderPersonList[a].customers.length;r++)s.push({name:this.orderPersonList[a].customers[r].name,phone:this.orderPersonList[a].customers[r].tel,cardType:this.orderPersonList[a].customers[r].cardType+"",cardNo:this.orderPersonList[a].customers[r].cardNo});var n=[];for(r=0;r<this.orderPersonList[a].prices.length;r++)n.push({date:this.orderPersonList[a].prices[r].time,price:this.orderPersonList[a].prices[r].price});this.livePersonList.push({persons:s,startData:this.orderPersonList[a].startDate,retentionTime:this.orderPersonList[a].retentionTime,leaveData:this.orderPersonList[a].endDate,night:this.orderPersonList[a].nights,roomType:this.orderPersonList[a].dailyRoomId,optionRooms:this.orderPersonList[a].optionRooms,priceSpecs:this.orderPersonList[a].priceSpecs||i[0].dailySalesChanelId,priceSpecsList:i,roomTypeId:this.orderPersonList[a].dailyRoomTypeId,price:this.orderPersonList[a].roomAmount/this.orderPersonList[a].nights,priceDataList:n,roomStatus:this.orderPersonList[a].roomStatus&&""!=this.orderPersonList[a].roomStatus.val?this.orderPersonList[a].roomStatus.val:""})}this.calculateRoomPrice(-1),"distributeDetail"==t&&this.getLiveRoomTypeList(0,this.orderPersonList[0].startDate,this.orderPersonList[0].endDate),this.dialogInsertLive=!0}else this.enterDirectLiveMode();this.$nextTick(()=>{this.getMoneyDayList("DirectLive")});break;case"CheckLive":if(this.roomManageInfo.manageTypeName="办理入住","me"!=t){if("orderDetail"==t){this.livePersonList=[],this.roomLiveInfo.dailyOrderId=this.orderRoomDetail.dailyOrderId,this.roomLiveInfo.orderNo=this.orderRoomDetail.orderNo,this.roomLiveInfo.dailyOrderSourceId=this.orderRoomDetail.dailyOrderSourceId,this.roomLiveInfo.label=this.orderRoomDetail.label,this.roomLiveInfo.roomTotalPrice=this.orderRoomDetail.roomTotalPrice,this.roomLiveInfo.orderTotalMoney=this.orderRoomDetail.orderTotalMoney,this.roomLiveInfo.receiveMoney=this.orderRoomDetail.receiveMoney,this.roomLiveInfo.needMoney=this.orderRoomDetail.needMoney,this.roomLiveInfo.origin=this.orderRoomDetail.dailyOrderSourceId,this.roomLiveInfo.incomeChoiceRoom=this.roomLimitTypeList.length>0?this.roomLimitTypeList[0].dailyRoomId:"",this.roomLiveInfo.showAddtionPay=!1,this.roomLiveInfo.roomStatus=this.orderRoomDetail.roomStatus||{},this.roomLiveInfo.personStatus=this.orderRoomDetail.personStatus||{};for(a=0;a<this.orderPersonList.length;a++){for(s=[],r=0;r<this.orderPersonList[a].customers.length;r++)s.push({name:this.orderPersonList[a].customers[r].name,phone:this.orderPersonList[a].customers[r].tel,cardType:this.orderPersonList[a].customers[r].cardType+"",cardNo:this.orderPersonList[a].customers[r].cardNo});for(n=[],r=0;r<this.orderPersonList[a].prices.length;r++)n.push({date:this.orderPersonList[a].prices[r].time,price:this.orderPersonList[a].prices[r].price});this.livePersonList.push({persons:s,startData:this.orderPersonList[a].startDate,leaveData:this.orderPersonList[a].endDate,night:this.orderPersonList[a].nights,roomType:this.orderPersonList[a].dailyRoomId,optionRooms:this.orderPersonList[a].optionRooms,priceSpecs:this.orderPersonList[a].priceSpecs||i[0].dailySalesChanelId,priceSpecsList:i,roomTypeId:this.orderPersonList[a].dailyRoomTypeId,price:this.orderPersonList[a].roomAmount/this.orderPersonList[a].nights,priceDataList:n,roomStatus:this.orderPersonList[a].roomStatus&&""!=this.orderPersonList[a].roomStatus.val?this.orderPersonList[a].roomStatus.val:""})}this.calculateRoomPrice(-1),this.dialogInsertLive=!0}}else this.enterDirectLiveMode();break;case"exitRoom":if("me"!=t&&"orderDetail"==t){this.exitPersonList=[],this.roomLiveInfo.dailyOrderId=this.orderRoomDetail.dailyOrderId,this.roomLiveInfo.orderNo=this.orderRoomDetail.orderNo,this.roomLiveInfo.dailyOrderSourceId=this.orderRoomDetail.dailyOrderSourceId,this.roomLiveInfo.label=this.orderRoomDetail.label,this.roomLiveInfo.roomTotalPrice=this.orderRoomDetail.roomTotalPrice,this.roomLiveInfo.orderTotalMoney=this.orderRoomDetail.orderTotalMoney,this.roomLiveInfo.receiveMoney=this.orderRoomDetail.receiveMoney,this.roomLiveInfo.needMoney=this.orderRoomDetail.needMoney,this.roomLiveInfo.origin=this.orderRoomDetail.dailyOrderSourceId,this.roomLiveInfo.incomeChoiceRoom=this.roomLimitTypeList.length>0?this.roomLimitTypeList[0].dailyRoomId:"",this.roomExitInfo.showAddtionPay=!1,this.roomLiveInfo.roomStatus=this.orderRoomDetail.roomStatus||{},this.roomLiveInfo.personStatus=this.orderRoomDetail.personStatus||{};for(a=0;a<this.orderPersonList.length;a++){e=this.orderPersonList[a];e.roomStatus&&3==e.roomStatus.val&&(e.isChecked=!0,this.exitPersonList.push(e))}this.calculateRoomPrice()}this.calculatePayAndNeedMoney(),this.roomExitInfo.depositDeduct=!0,this.dialogExitRoom=!0;break;case"orderDetail":this.roomManageInfo.manageTypeName="修改订单";var l="";this.roomManageInfo.lived&&""!=this.roomManageInfo.lived?l=this.roomManageInfo.lived.dailyOrderId:this.roomManageInfo.reserve&&""!=this.roomManageInfo.reserve&&(l=this.roomManageInfo.reserve.dailyOrderId),"CheckLive"==this.roomManageInfo.from?this.roomManageInfo.to="compareLive":"exitRoom"==this.roomManageInfo.from?this.roomManageInfo.to="exitLive":this.roomManageInfo.to="",""!=l&&this.enterOrderDetailMode(l),this.calculatePayAndNeedMoney();break;default:console.log("other")}this.getCardTypeList(o),this.getIncomeFeeTypeList(o),this.getIncomePayTypeList(o)},async enterReserveMode(){this.roomReserveInfo.name="",this.roomReserveInfo.phone="",this.roomReserveInfo.cardType="",this.roomReserveInfo.cardNo="",this.roomReserveInfo.origin=this.roomOriginList.length>0?this.roomOriginList[0].dailyOrderSourceId:"",this.roomReserveInfo.roomTotalPrice="",this.roomReserveInfo.orderTotalMoney="",this.roomReserveInfo.roomDepositMoney="",this.roomReserveInfo.receiveMoney="",this.roomReserveInfo.needMoney="",this.roomReserveInfo.showAddtionPay=!1,this.roomReserveInfo.label="",this.roomReserveInfo.account="",this.roomOrderList=[];var e=await this.getTurnOverTime();this.remainTime.originVal=e.remain||this.currentData+" 12:00:00",this.remainTime.newVal=this.remainTime.originVal;var o=[];o=JSON.parse(JSON.stringify(this.roomPriceTypeList)),this.roomOrderList.push({startData:e.start||this.currentData,retentionTime:e.remain||this.currentData+" 12:00:00",leaveData:Object(n["h"])("next",e.start,1),night:1,roomType:this.roomManageInfo.dailyRoomId,optionRooms:[],priceSpecs:o[0].dailySalesChanelId,priceSpecsList:o,roomTypeId:"",price:this.roomManageInfo.price||0,priceDataList:[]}),this.orderReserveTable=[],this.reserveLabel.isInsert=!0,this.reserveLabel.index=0,this.reserveLabel.originVal="",this.reserveLabel.newVal="",this.getReserveRoomTypeList(0,this.currentData,Object(n["h"])("next",this.currentData,1)),this.changeDayRoomPriceVal("reserve",0),this.dialogInsertReserve=!0},async enterDirectLiveMode(){this.livePersonList=[],this.roomLiveInfo.origin=this.roomOriginList.length>0?this.roomOriginList[0].dailyOrderSourceId:"",this.roomLiveInfo.showAddtionPay=!1,this.roomLiveInfo.label="","me"==this.roomManageInfo.from&&(this.orderReserveTable=[]);var e=await this.getTurnOverTime(),o=[];o=JSON.parse(JSON.stringify(this.roomPriceTypeList)),this.livePersonList.push({persons:[{name:"",phone:"",cardType:"",cardNo:""}],startData:e.start||this.currentData,leaveData:Object(n["h"])("next",e.start,1),night:1,roomType:this.roomManageInfo.dailyRoomId,optionRooms:[],priceSpecs:o[0].dailySalesChanelId,priceSpecsList:o,roomTypeId:"",price:this.roomManageInfo.price||0}),this.getLiveRoomTypeList(0,e.start||this.currentData,Object(n["h"])("next",this.currentData,1)),this.changeDayRoomPriceVal("DirectLive",0),this.dialogInsertLive=!0},enterOrderDetailMode(e){this.$http.get("/api/daily/order/findOrder",{params:{dailyOrderId:e}}).then(o=>{var t=o.data;if(0==t.errorCode){this.orderReserveTable=[],this.roomLimitTypeList=[],this.orderRoomDetail.dailyOrderId=e,this.orderRoomDetail.orderNo=t.data.orderNo,this.orderRoomDetail.dailyOrderSourceId=t.data.dailyOrderSourceId,this.orderRoomDetail.dailyOrderSourceName=t.data.dailyOrderSourceName||"-",this.orderRoomDetail.label=t.data.info,this.orderRoomDetail.roomStatus=t.data.status&&""!=t.data.status?t.data.status:{},this.orderRoomDetail.personStatus=t.data.beginRoomStatus&&""!=t.data.beginRoomStatus?t.data.beginRoomStatus:{},this.orderRoomDetail.personStatus.hasBigger=!1,this.orderRoomDetail.showAddtionPay=!1,this.orderRoomDetail.closedId=t.data.closedId,this.orderRoomDetail.roomTotalPrice=t.data.roomAmount,this.orderRoomDetail.orderTotalMoney=t.data.amount,this.orderRoomDetail.receiveMoney=t.data.paidAmount,this.orderRoomDetail.needMoney=t.data.nonPayAmount,this.orderPersonList=t.data.roomAndCustomersCmsVoList||[];for(var i=0;i<this.orderPersonList.length;i++){this.orderPersonList[i].priceSpecs&&"-1"==this.orderPersonList[i].priceSpecs&&(this.orderPersonList[i].priceSpecs="handle"),this.orderPersonList[i].roomStatus&&""!=this.orderPersonList[i].roomStatus&&this.orderRoomDetail.personStatus.val<this.orderPersonList[i].roomStatus.val&&(this.orderRoomDetail.personStatus.hasBigger=!0);for(var a=!1,s=0;s<this.roomLimitTypeList.length;s++)this.roomLimitTypeList[s].dailyRoomId==this.orderPersonList[i].dailyRoomId&&(a=!0);a||this.roomLimitTypeList.push({dailyRoomName:this.orderPersonList[i].dailyRoomName,dailyRoomId:this.orderPersonList[i].dailyRoomId})}var r=t.data.details||[];for(s=0;s<r.length;s++)this.orderReserveTable.push({newincome:r[s].income,newstatus:r[s].status,dailyDetailParentTypeId:r[s].dailyDetailParentTypeId,indexNum:s,moneyType:"收押金"==r[s].name?"2":"",moneyTypeName:r[s].name,income:1==r[s].status.val?r[s].status.val:1==r[s].income.val?2:3,incomeName:r[s].status.text,payType:r[s].payType,payTypeName:r[s].payName,money:r[s].amount,roomName:r[s].dailyRoomName,roomDailyTypeName:r[s].dailyRoomTypeName,roomDailyRoomId:r[s].dailyRoomId,roomDailyRentalId:r[s].dailyRentalId,roomDailyDetailTypeId:r[s].dailyDetailTypeId,operatorTime:r[s].updateTime&&""!=r[s].updateTime?r[s].updateTime.substring(0,10):"-",operatorName:r[s].createrName||"-",operate:"",dailyDetailId:r[s].dailyDetailId,dailyOrderId:r[s].dailyOrderId,refundAmount:r[s].refundAmount,payNo:r[s].payNo,label:r[s].info});if(this.calculatePayAndNeedMoney(),"distributeRoom"==this.roomManageInfo.to)this.enterRoomManage(this.roomManageInfo,"DirectLive","distributeDetail");else if("compareLive"==this.roomManageInfo.to)this.enterRoomManage(this.roomManageInfo,"DirectLive","compareLive");else if("exitLive"==this.roomManageInfo.to)this.enterRoomManage(this.roomManageInfo,"exitRoom","orderDetail");else{this.roomManageInfo.to="";var n=0,l=0,c=0,m=0,d=0,h=0;for(s=0;s<this.orderReserveTable.length;s++)2==this.orderReserveTable[s].income?("收押金"!=this.orderReserveTable[s].moneyTypeName&&(n+=this.orderReserveTable[s].money),"收房费"==this.orderReserveTable[s].moneyTypeName?d+=this.orderReserveTable[s].money:"收押金"==this.orderReserveTable[s].moneyTypeName&&(m+=this.orderReserveTable[s].money)):1==this.orderReserveTable[s].income?h+=this.orderReserveTable[s].money:("退押金"!=this.orderReserveTable[s].moneyTypeName&&(l+=this.orderReserveTable[s].money),"退房费"!=this.orderReserveTable[s].moneyTypeName&&"退押金"!=this.orderReserveTable[s].moneyTypeName&&(c+=this.orderReserveTable[s].money),"退押金"==this.orderReserveTable[s].moneyTypeName&&(m-=this.orderReserveTable[s].money));this.orderRoomDetail.orderTotalMoney=this.orderRoomDetail.roomTotalPrice+n+h-d-c,this.orderRoomDetail.receiveMoney=n-l,this.orderRoomDetail.roomDepositMoney=m,this.orderRoomDetail.needMoney=this.orderRoomDetail.orderTotalMoney-this.orderRoomDetail.receiveMoney,this.dialogRoomDetail=!0}}}).catch(function(e){console.log(e)})},insertAddtionPay(){if("-1"==this.$authority.indexOf("dailyOrderInsertAddtion"))return this.$message({type:"error",message:"权限不足，暂时无法操作该项!"});switch(this.roomManageInfo.manageType){case"reserve":this.roomReserveInfo.showAddtionPay||(this.reserveLabel.newVal=""),this.roomReserveInfo.showAddtionPay=!this.roomReserveInfo.showAddtionPay;break;case"CheckLive":case"DirectLive":this.roomLiveInfo.showAddtionPay||(this.reserveLabel.newVal=""),this.roomLiveInfo.showAddtionPay=!this.roomLiveInfo.showAddtionPay;break;case"exitRoom":this.roomExitInfo.showAddtionPay||(this.reserveLabel.newVal=""),this.getMoneyDayList("exitRoom"),this.roomExitInfo.showAddtionPay=!this.roomExitInfo.showAddtionPay;break;case"orderDetail":this.orderRoomDetail.showAddtionPay||(this.reserveLabel.newVal="",this.orderRoomDetail.incomeChoiceRoom=this.roomLimitTypeList.length>0?this.roomLimitTypeList[0].dailyRoomId:"",this.getMoneyDayList("orderDetail")),this.orderRoomDetail.showAddtionPay=!this.orderRoomDetail.showAddtionPay;break;default:this.dialogRoomStatusList&&(this.getCardTypeList("orderDetail"),this.getIncomeFeeTypeList("orderDetail"),this.getIncomePayTypeList("orderDetail"),this.orderRoomDetail.showAddtionPay||(this.orderRoomDetail.incomeMoney="",this.reserveLabel.newVal="",this.orderRoomDetail.incomeChoiceRoom=this.roomLimitTypeList.length>0?this.roomLimitTypeList[0].dailyRoomId:""),this.orderRoomDetail.showAddtionPay=!this.orderRoomDetail.showAddtionPay);break}},removeRoomOrderList(e){if(this.roomOrderList.length>1){for(var o=-1,t=0;t<this.roomLimitTypeList.length;t++)this.roomOrderList[e].roomType==this.roomLimitTypeList[t].dailyRoomId&&(o=t);-1!=o&&this.roomLimitTypeList.splice(o,1),this.roomOrderList.splice(e,1),this.changeRoomTypeVal(),this.calculateRoomPrice()}},addRoomOrderList(){this.roomOrderList.push({startData:this.roomOrderList[this.roomOrderList.length-1].startData,retentionTime:this.currentData+" 12:00:00",leaveData:this.roomOrderList[this.roomOrderList.length-1].leaveData,night:this.roomOrderList[this.roomOrderList.length-1].night,roomType:this.roomOrderList[this.roomOrderList.length-1].roomType,optionRooms:this.roomOrderList[this.roomOrderList.length-1].optionRooms,priceSpecs:this.roomOrderList[this.roomOrderList.length-1].priceSpecs,priceSpecsList:this.roomOrderList[this.roomOrderList.length-1].priceSpecsList,roomTypeId:this.roomOrderList[this.roomOrderList.length-1].roomTypeId,price:this.roomOrderList[this.roomOrderList.length-1].price}),this.changeRoomTypeVal()},getCardTypeList(e){this.$http.get("/api/contract/card_types").then(o=>{var t=o.data;if(0==t.errorCode&&(this.cardTypeList=t.data||[],this.cardTypeList.length>0)){for(var i=0;i<this.cardTypeList.length;i++)this.cardTypeList[i].val=this.cardTypeList[i].val+"";switch(e){case"reserve":this.roomReserveInfo.cardType=this.cardTypeList[0].val;break;case"DirectLive":this.livePersonList[0].persons[0].cardType=this.cardTypeList[0].val;break;case"noRoomReserve":this.noRoomReserveInfo.cardType=this.cardTypeList[0].val;break;case"CheckLive":break;case"exitRoom":break;case"orderDetail":break;default:}}}).catch(function(e){console.log(e)})},getIncomeFeeTypeList(e){this.$http.get("/api/daily/setting/getFeeTypeList").then(o=>{var t=o.data;if(0==t.errorCode&&(this.incomeFeeTypeList=t.data||[],this.incomeFeeTypeList.length>0)){var i="";switch(e){case"reserve":this.roomReserveInfo.incomeMoneyType=this.incomeFeeTypeList[0].feeTypeId,i=this.roomReserveInfo.incomeMoneyType;break;case"DirectLive":this.roomLiveInfo.incomeMoneyType=this.incomeFeeTypeList[0].feeTypeId,i=this.roomLiveInfo.incomeMoneyType;break;case"CheckLive":break;case"exitRoom":this.roomLiveInfo.incomeMoneyType=this.incomeFeeTypeList[0].feeTypeId,i=this.roomLiveInfo.incomeMoneyType;break;case"orderDetail":this.orderRoomDetail.incomeMoneyType=this.incomeFeeTypeList[0].feeTypeId,i=this.orderRoomDetail.incomeMoneyType;break;default:}this.getIncomeOrPayList(e,i),i&&1==i&&this.getMoneyDayList(e)}}).catch(function(e){console.log(e)})},changeIncomeFeeVal(e){this.getIncomeAddtionFeeList(e);var o="",t=!1;switch(e){case"reserve":o=this.roomReserveInfo.incomeMoneyType;break;case"DirectLive":o=this.roomLiveInfo.incomeMoneyType,this.dialogExitRoom&&(t=!0,this.getMoneyDayList("exitRoom"));break;case"CheckLive":break;case"exitRoom":o=this.roomLiveInfo.incomeMoneyType;break;case"orderDetail":o=this.orderRoomDetail.incomeMoneyType;break;default:}this.getIncomeOrPayList(e,o),o&&1==o&&!t&&this.getMoneyDayList(e)},getIncomeAddtionFeeList(e){this.$http.get("/api/daily/setting/getConsumptionFeeTypeList").then(o=>{var t=o.data;if(0==t.errorCode&&(this.incomeAddtionFeeList=t.data||[],this.incomeAddtionFeeList.length>0))switch(e){case"reserve":this.roomReserveInfo.incomeAddtionMoneyType=this.incomeAddtionFeeList[0].detailFeeTypeId;break;case"DirectLive":this.roomLiveInfo.incomeAddtionMoneyType=this.incomeAddtionFeeList[0].detailFeeTypeId;break;case"CheckLive":break;case"exitRoom":this.roomLiveInfo.incomeAddtionMoneyType=this.incomeAddtionFeeList[0].detailFeeTypeId;break;case"orderDetail":this.orderRoomDetail.incomeAddtionMoneyType=this.incomeAddtionFeeList[0].detailFeeTypeId;break;default:}}).catch(function(e){console.log(e)})},getIncomeOrPayList(e,o){this.$http.get("/api/daily/order/public/findDetailStatus",{params:{dailyDetailParentTypeId:o}}).then(t=>{var i=t.data;if(0==i.errorCode&&(this.incomeOrPayList=i.data||[],this.incomeOrPayList.length>0))switch(e){case"reserve":this.roomReserveInfo.incomeReceiveType=this.incomeOrPayList[0].val,this.roomReserveInfo.showPayType=1!==o&&2!=o||1!=this.incomeOrPayList[0].val,this.roomReserveInfo.showPayType?this.roomReserveInfo.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId:this.roomReserveInfo.incomePayType="",this.roomReserveInfo.showPayNo=!1;break;case"DirectLive":this.roomLiveInfo.incomeReceiveType=this.incomeOrPayList[0].val,this.roomLiveInfo.showPayType=1!==o&&2!=o||1!=this.incomeOrPayList[0].val,this.roomLiveInfo.showPayType?this.roomLiveInfo.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId:this.roomLiveInfo.incomePayType="",this.roomLiveInfo.showPayNo=!1;break;case"CheckLive":break;case"exitRoom":this.roomLiveInfo.incomeReceiveType=this.incomeOrPayList[0].val,this.roomLiveInfo.showPayType=1!==o&&2!=o||1!=this.incomeOrPayList[0].val,this.roomLiveInfo.showPayType?this.roomLiveInfo.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId:this.roomLiveInfo.incomePayType="",this.roomLiveInfo.showPayNo=!1;break;case"orderDetail":this.orderRoomDetail.incomeReceiveType=this.incomeOrPayList[0].val,this.orderRoomDetail.showPayType=1!==o&&2!=o||1!=this.incomeOrPayList[0].val,this.orderRoomDetail.showPayType?this.orderRoomDetail.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId:this.orderRoomDetail.incomePayType="",this.orderRoomDetail.showPayNo=!1;break;default:}}).catch(function(e){console.log(e)})},changeIncomePayType(e){switch(e){case"reserve":this.roomReserveInfo.showPayType=1!==this.roomReserveInfo.incomeMoneyType&&2!=this.roomReserveInfo.incomeMoneyType||1!=this.roomReserveInfo.incomeReceiveType,this.roomReserveInfo.showPayType?(this.roomReserveInfo.incomePayType=this.roomReserveInfo.oldPayType||this.incomePayTypeList[0].dailyDetailPayTypeId,this.roomReserveInfo.oldPayType="",this.changeAddtionPayType(e)):(this.roomReserveInfo.oldPayType=this.roomReserveInfo.incomePayType,this.roomReserveInfo.incomePayType="",this.roomReserveInfo.showPayNo=!1);break;case"DirectLive":this.roomLiveInfo.showPayType=1!==this.roomLiveInfo.incomeMoneyType&&2!=this.roomLiveInfo.incomeMoneyType||1!=this.roomLiveInfo.incomeReceiveType,this.roomLiveInfo.showPayType?(this.roomLiveInfo.incomePayType=this.roomLiveInfo.oldPayType||this.incomePayTypeList[0].dailyDetailPayTypeId,this.roomLiveInfo.oldPayType="",this.changeAddtionPayType(e)):(this.roomLiveInfo.oldPayType=this.roomLiveInfo.incomePayType,this.roomLiveInfo.incomePayType="",this.roomLiveInfo.showPayNo=!1);break;case"CheckLive":break;case"exitRoom":this.roomLiveInfo.showPayType=1!==this.roomLiveInfo.incomeMoneyType&&2!=this.roomLiveInfo.incomeMoneyType||1!=this.roomLiveInfo.incomeReceiveType,this.roomLiveInfo.showPayType?(this.roomLiveInfo.incomePayType=this.roomLiveInfo.oldPayType||this.incomePayTypeList[0].dailyDetailPayTypeId,this.roomLiveInfo.oldPayType="",this.changeAddtionPayType(e)):(this.roomLiveInfo.oldPayType=this.roomLiveInfo.incomePayType,this.roomLiveInfo.incomePayType="",this.roomLiveInfo.showPayNo=!1);break;case"orderDetail":this.orderRoomDetail.showPayType=1!==this.orderRoomDetail.incomeMoneyType&&2!=this.orderRoomDetail.incomeMoneyType||1!=this.orderRoomDetail.incomeReceiveType,this.orderRoomDetail.showPayType?(this.orderRoomDetail.incomePayType=this.orderRoomDetail.oldPayType||this.incomePayTypeList[0].dailyDetailPayTypeId,this.orderRoomDetail.oldPayType="",this.changeAddtionPayType(e)):(this.orderRoomDetail.oldPayType=this.orderRoomDetail.incomePayType,this.orderRoomDetail.incomePayType="",this.orderRoomDetail.showPayNo=!1);break;default:}},getIncomePayTypeList(e){this.$http.get("/api/daily/order/public/findPayTypies").then(o=>{var t=o.data;if(0==t.errorCode&&(this.incomePayTypeList=t.data||[],this.incomePayTypeList.length>0))switch(e){case"reserve":this.roomReserveInfo.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId;break;case"DirectLive":this.roomLiveInfo.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId;break;case"CheckLive":break;case"exitRoom":this.roomLiveInfo.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId;break;case"orderDetail":this.orderRoomDetail.incomePayType=this.incomePayTypeList[0].dailyDetailPayTypeId;break;default:}}).catch(function(e){console.log(e)})},getNoRoomTypeList(){this.$http.get("/api/daily/room_type/list",{params:{dailyRentalId:this.realRoomSearchInfo.projectId}}).then(e=>{var o=e.data;0==o.errorCode&&(this.roomTypeList=o.data||[],this.roomTypeList.length>0&&(this.noRoomReserveInfo.roomType=this.roomTypeList[0].dailyRoomTypeId,this.changeNoRoomTypeVal()))}).catch(function(e){console.log(e)})},getReserveRoomTypeList(e,o,t){this.$http.get("/api/daily/room_type/room_list",{params:{dailyRentalId:this.realRoomSearchInfo.projectId,dailyRoomTypeId:this.roomManageInfo.dailyRoomTypeId,dailyOrderRoomId:"",startDate:o,endDate:t,type:"1"}}).then(o=>{var t=o.data;if(0==t.errorCode){var i=t.data||[];this.roomLimitTypeList=[];for(var a="",s=0;s<i.length;s++)i[s].dailyRoomId==this.roomManageInfo.dailyRoomId&&(a=i[s].dailyRoomTypeId);this.roomOrderList[e].optionRooms=i||[],this.roomOrderList[e].roomTypeId=a;for(s=0;s<this.roomOrderList.length;s++)for(var r=0;r<this.roomOrderList[s].optionRooms.length;r++)if(this.roomOrderList[s].optionRooms[r].dailyRoomId==this.roomOrderList[s].roomType){var n=this.roomOrderList[s].optionRooms[r];this.roomLimitTypeList.push(n)}this.roomLimitTypeList.length>0&&(this.roomReserveInfo.incomeChoiceRoom=this.roomLimitTypeList[0].dailyRoomId),this.getMoneyDayList("reserve")}}).catch(function(e){console.log(e)})},getLiveRoomTypeList(e,o,t){this.$http.get("/api/daily/room_type/room_list",{params:{dailyRentalId:this.realRoomSearchInfo.projectId,dailyRoomTypeId:this.roomManageInfo.dailyRoomTypeId,dailyOrderRoomId:"",startDate:o,endDate:t,type:"2"}}).then(o=>{var t=o.data;if(0==t.errorCode){var i=t.data||[];this.roomLimitTypeList=[];for(var a="",s=0;s<i.length;s++)i[s].dailyRoomId==this.roomManageInfo.dailyRoomId&&(a=i[s].dailyRoomTypeId);this.livePersonList[e].optionRooms=i||[],this.livePersonList[e].roomTypeId=a;for(s=0;s<this.livePersonList.length;s++)for(var r=0;r<this.livePersonList[s].optionRooms.length;r++)if(this.livePersonList[s].optionRooms[r].dailyRoomId==this.livePersonList[s].roomType){var n=this.livePersonList[s].optionRooms[r];this.roomLimitTypeList.push(n)}if(this.roomLimitTypeList.length>0&&(this.roomLiveInfo.incomeChoiceRoom=this.roomLimitTypeList[0].dailyRoomId),"distributeDetail"==this.roomManageInfo.from)for(s=0;s<this.livePersonList.length;s++)this.livePersonList[s].optionRooms=i||[]}}).catch(function(e){console.log(e)})},getRoomTypeList(e){this.$http.get("/api/daily/room_type/room_list",{params:{dailyRoomTypeId:this.roomManageInfo.dailyRoomTypeId}}).then(o=>{var t=o.data;if(0==t.errorCode){this.roomTypeList=t.data||[],this.roomLimitTypeList=[];for(var i="",a=0;a<this.roomTypeList.length;a++)this.roomTypeList[a].dailyRoomId==this.roomManageInfo.dailyRoomId&&(i=this.roomTypeList[a].dailyRoomTypeId);switch(e){case"reserve":for(a=0;a<this.roomOrderList.length;a++)for(var s=0;s<this.roomTypeList.length;s++)if(this.roomTypeList[s].dailyRoomId==this.roomOrderList[a].roomType){var r=this.roomTypeList[s];this.roomLimitTypeList.push(r),this.roomReserveInfo.incomeChoiceRoom=r.dailyRoomId}this.roomOrderList[0].roomTypeId=i;break;case"DirectLive":for(a=0;a<this.roomTypeList.length;a++)if(this.roomTypeList[a].dailyRoomId==this.roomManageInfo.dailyRoomId){r=this.roomTypeList[a];this.roomLimitTypeList.push(r),this.roomLiveInfo.incomeChoiceRoom=r.dailyRoomId}this.livePersonList[0].roomTypeId=i;break;case"CheckLive":break;case"exitRoom":for(a=0;a<this.roomTypeList.length;a++)if(this.roomTypeList[a].dailyRoomId==this.roomManageInfo.dailyRoomId){r=this.roomTypeList[a];this.roomLimitTypeList.push(r),this.roomLiveInfo.incomeChoiceRoom=r.dailyRoomId}this.livePersonList[0].roomTypeId=i;break;case"orderDetail":for(a=0;a<this.roomTypeList.length;a++)if(this.roomTypeList[a].dailyRoomId==this.roomManageInfo.dailyRoomId){r=this.roomTypeList[a];this.roomLimitTypeList.push(r),this.roomLiveInfo.incomeChoiceRoom=r.dailyRoomId}this.livePersonList[0].roomTypeId=i;break;default:}this.getMoneyDayList(e)}}).catch(function(e){console.log(e)})},changeRoomTypeVal(e=0){switch(this.roomManageInfo.manageType){case"reserve":for(var o="",t=0;t<this.roomOrderList[e].optionRooms.length;t++)this.roomOrderList[e].optionRooms[t].dailyRoomId==this.roomOrderList[e].roomType&&(o=this.roomOrderList[e].optionRooms[t].dailyRoomTypeId);this.roomOrderList[e].roomTypeId=o,this.roomTypeTransform(this.roomOrderList),this.roomReserveInfo.incomeChoiceRoom=this.roomLimitTypeList[0].dailyRoomId,this.changeDayRoomPriceVal(this.roomManageInfo.manageType,e);break;case"DirectLive":for(o="",t=0;t<this.livePersonList[e].optionRooms.length;t++)this.livePersonList[e].optionRooms[t].dailyRoomId==this.livePersonList[e].roomType&&(o=this.livePersonList[e].optionRooms[t].dailyRoomTypeId);this.livePersonList[e].roomTypeId=o,this.roomTypeTransform(this.livePersonList),this.roomLiveInfo.incomeChoiceRoom=this.roomLimitTypeList[0].dailyRoomId,this.changeDayRoomPriceVal(this.roomManageInfo.manageType,e);break;case"CheckLive":break;case"exitRoom":break;case"orderDetail":break;default:}this.calculateRoomPrice("-1")},roomTypeTransform(e){this.roomLimitTypeList=[];for(var o=0;o<e.length;o++)for(var t=0;t<e[o].optionRooms.length;t++)if(e[o].optionRooms[t].dailyRoomId==e[o].roomType){for(var i=!0,a=0;a<this.roomLimitTypeList.length;a++)e[o].optionRooms[t].dailyRoomId==this.roomLimitTypeList[a].dailyRoomId&&(i=!1);if(i){var s=e[o].optionRooms[t];this.roomLimitTypeList.push(s)}}},changeRoomNigihtVal(e){switch(this.roomManageInfo.manageType){case"reserve":var o=this.roomOrderList[e];o.leaveData=Object(n["h"])("next",o.startData,o.night),this.roomOrderList[e]=o;break;case"DirectLive":o=this.livePersonList[e];o.leaveData=Object(n["h"])("next",o.startData,o.night),this.livePersonList[e]=o;break;default:}this.changeDayRoomPriceVal(this.roomManageInfo.manageType,e)},calculateRoomPrice(e=-1){switch(this.roomManageInfo.manageType){case"reserve":if(-1!=e){var o=this.roomOrderList[e];o.leaveData=Object(n["h"])("next",o.startData,o.night),this.$set(this.roomOrderList,e,o),this.getReserveRoomTypeList(0,o.startData,o.leaveData)}for(var t=0,i=0;i<this.roomOrderList.length;i++)t+=this.roomOrderList[i].night*this.roomOrderList[i].price;this.roomReserveInfo.roomTotalPrice=Math.round(100*Number(t))/100,this.roomReserveInfo.orderTotalMoney=this.roomReserveInfo.roomTotalPrice;break;case"DirectLive":if(-1!=e){o=this.livePersonList[e];o.leaveData=Object(n["h"])("next",o.startData,o.night),this.$set(this.livePersonList,e,o),this.getLiveRoomTypeList(0,o.startData,o.leaveData)}for(t=0,i=0;i<this.livePersonList.length;i++)t+=this.livePersonList[i].night*this.livePersonList[i].price;this.roomLiveInfo.roomTotalPrice=Math.round(100*Number(t))/100,this.roomLiveInfo.orderTotalMoney=this.roomLiveInfo.roomTotalPrice;break;case"CheckLive":break;case"exitRoom":break;case"orderDetail":break;default:}this.calculatePayAndNeedMoney()},calculatePayAndNeedMoney(){for(var e=0,o=0,t=0,i=0,a=0,s=0,r=0;r<this.orderReserveTable.length;r++)2==this.orderReserveTable[r].income?("收押金"!=this.orderReserveTable[r].moneyTypeName&&(e+=this.orderReserveTable[r].money),"收房费"==this.orderReserveTable[r].moneyTypeName?a+=this.orderReserveTable[r].money:"收押金"==this.orderReserveTable[r].moneyTypeName&&(o+=this.orderReserveTable[r].money)):1==this.orderReserveTable[r].income?s+=this.orderReserveTable[r].money:("退押金"!=this.orderReserveTable[r].moneyTypeName&&(t+=this.orderReserveTable[r].money),"退房费"!=this.orderReserveTable[r].moneyTypeName&&"退押金"!=this.orderReserveTable[r].moneyTypeName&&(i+=this.orderReserveTable[r].money),"退押金"==this.orderReserveTable[r].moneyTypeName&&(o-=this.orderReserveTable[r].money));switch(this.roomManageInfo.manageType){case"reserve":this.roomReserveInfo.orderTotalMoney=this.roomReserveInfo.roomTotalPrice+e+s-a-i,this.roomReserveInfo.receiveMoney=e-t,this.roomReserveInfo.roomDepositMoney=o,this.roomReserveInfo.needMoney=this.roomReserveInfo.orderTotalMoney-this.roomReserveInfo.receiveMoney;break;case"DirectLive":this.roomLiveInfo.orderTotalMoney=this.roomLiveInfo.roomTotalPrice+e+s-a-i,this.roomLiveInfo.receiveMoney=e-t,this.roomLiveInfo.roomDepositMoney=o,this.roomLiveInfo.needMoney=this.roomLiveInfo.orderTotalMoney-this.roomLiveInfo.receiveMoney;break;case"CheckLive":break;case"exitRoom":this.roomLiveInfo.orderTotalMoney=this.roomLiveInfo.roomTotalPrice+e+s-a-i,this.roomLiveInfo.receiveMoney=e-t,this.roomLiveInfo.roomDepositMoney=o,this.roomLiveInfo.needMoney=this.roomLiveInfo.orderTotalMoney-this.roomLiveInfo.receiveMoney,this.dialogRoomDetail&&(this.orderRoomDetail.orderTotalMoney=this.roomLiveInfo.orderTotalMoney,this.orderRoomDetail.receiveMoney=this.roomLiveInfo.receiveMoney,this.orderRoomDetail.roomDepositMoney=o,this.orderRoomDetail.needMoney=this.roomLiveInfo.needMoney);break;case"orderDetail":this.orderRoomDetail.orderTotalMoney=this.orderRoomDetail.roomTotalPrice+e+s-a-i,this.orderRoomDetail.receiveMoney=e-t,this.orderRoomDetail.roomDepositMoney=o,this.orderRoomDetail.needMoney=this.orderRoomDetail.orderTotalMoney-this.orderRoomDetail.receiveMoney;break;default:}this.getMoneyDayList(this.roomManageInfo.manageType)},changeReserveEnterData(e){switch(this.roomManageInfo.manageType){case"reserve":var o=this.roomOrderList[e];Object(n["i"])(o.startData,o.leaveData)<0?o.leaveData=Object(n["h"])("next",o.startData,o.night):o.night=Object(n["i"])(o.startData,o.leaveData),this.$set(this.roomOrderList,e,o),this.getReserveRoomTypeList(e,o.startData,o.leaveData);break;case"DirectLive":o=this.livePersonList[e];Object(n["i"])(o.startData,o.leaveData)<0?o.leaveData=Object(n["h"])("next",o.startData,o.night):o.night=Object(n["i"])(o.startData,o.leaveData);var t=o.retentionTime.substring(11);o.retentionTime=o.startData+" "+t,this.$set(this.livePersonList,e,o),this.getLiveRoomTypeList(e,o.startData,o.leaveData);break;case"CheckLive":break;case"exitRoom":break;case"orderDetail":break;default:}this.changeDayRoomPriceVal(this.roomManageInfo.manageType,e)},changeReserveLeaveData(e){switch(this.roomManageInfo.manageType){case"reserve":var o=this.roomOrderList[e];Object(n["i"])(o.startData,o.leaveData)<0?o.leaveData=Object(n["h"])("next",o.startData,o.night):o.night=Object(n["i"])(o.startData,o.leaveData),this.$set(this.roomOrderList,e,o),this.getReserveRoomTypeList(e,o.startData,o.leaveData);break;case"DirectLive":o=this.livePersonList[e];Object(n["i"])(o.startData,o.leaveData)<0?o.leaveData=Object(n["h"])("next",o.startData,o.night):o.night=Object(n["i"])(o.startData,o.leaveData),this.$set(this.livePersonList,e,o),this.getLiveRoomTypeList(e,o.startData,o.leaveData);break;case"CheckLive":break;case"exitRoom":break;case"orderDetail":break;default:}this.changeDayRoomPriceVal(this.roomManageInfo.manageType,e)},changeReserveNoRoom(){var e=this.noRoomReserveInfo;Object(n["i"])(e.startData,e.leaveData)<0?e.leaveData=Object(n["h"])("next",e.startData,e.night):e.night=Object(n["i"])(e.startData,e.leaveData),this.noRoomReserveInfo=e,this.changeNoRoomTypeVal()},calculateNoRoomPrice(){this.noRoomReserveInfo.leaveData=Object(n["h"])("next",this.noRoomReserveInfo.startData,this.noRoomReserveInfo.night),this.noRoomReserveInfo.roomTotalPrice=Math.round(100*Number(this.noRoomReserveInfo.night*this.noRoomReserveInfo.price*this.noRoomReserveInfo.roomCount))/100},saveReserveIncomeInfo(){var e=(new Date).valueOf(),o=Object(n["g"])(e),t=localStorage["user"]&&""!=localStorage["user"]?JSON.parse(localStorage["user"]).username:"-",i=[],a=[],s=[],r=[],l="",c="",m="",d="",h="",p="";switch(this.roomManageInfo.manageType){case"reserve":l=this.roomReserveInfo.incomeMoneyType,c=this.roomReserveInfo.incomeAddtionMoneyType,m=this.roomReserveInfo.incomeReceiveType,d=this.roomReserveInfo.incomePayType,h=this.roomReserveInfo.incomeMoney,p=this.roomReserveInfo.payNo,this.roomReserveInfo.payNo="";break;case"DirectLive":l=this.roomLiveInfo.incomeMoneyType,c=this.roomLiveInfo.incomeAddtionMoneyType,m=this.roomLiveInfo.incomeReceiveType,d=this.roomLiveInfo.incomePayType,h=this.roomLiveInfo.incomeMoney,p=this.roomLiveInfo.payNo,this.roomLiveInfo.payNo="";break;case"CheckLive":break;case"exitRoom":break;case"orderDetail":break;default:}if("me"==this.roomManageInfo.from){for(var y=0;y<this.incomeFeeTypeList.length;y++)this.incomeFeeTypeList[y].feeTypeId==l&&(i=this.incomeFeeTypeList[y]);if(i.feeTypeId==this.otherFeeTypeVal)for(y=0;y<this.incomeAddtionFeeList.length;y++)this.incomeAddtionFeeList[y].detailFeeTypeId==c&&(a=this.incomeAddtionFeeList[y]);for(y=0;y<this.incomeOrPayList.length;y++)this.incomeOrPayList[y].val==m&&(s=this.incomeOrPayList[y]);for(y=0;y<this.incomePayTypeList.length;y++)this.incomePayTypeList[y].dailyDetailPayTypeId==d&&(r=this.incomePayTypeList[y]);this.orderReserveTable.push({indexNum:0,moneyType:i.feeTypeId,moneyChildType:i.feeTypeId==this.otherFeeTypeVal?a.detailFeeTypeId:"",moneyTypeName:i.feeTypeId==this.otherFeeTypeVal?a.feeName:i.feeTypeName,moneyTypeChildName:i.feeTypeId==this.otherFeeTypeVal?a.feeName:"",income:s.val,incomeName:s.text,payType:r.dailyDetailPayTypeId,payTypeName:r.info,money:h,roomName:this.roomLimitTypeList[0].dailyRoomName||"-",roomDailyRoomId:this.roomLimitTypeList[0].dailyRoomId||"",roomDailyRentalId:this.roomLimitTypeList[0].dailyRentalId,roomDailyDetailTypeId:i.feeTypeId,operatorTime:o,operatorName:t,payNo:p,operate:"",label:this.reserveLabel.newVal}),this.settleAccount.newVal="",this.reserveLabel.newVal="",this.calculatePayAndNeedMoney(),this.insertAddtionPay()}else this.saveOrderIncome("DirectLive")},saveOrderIncome(e){var o="";this.settleAccount.newVal="";var t={};switch(e){case"reserve":break;case"DirectLive":o="/api/daily/order/income",t.dailyRentalId=this.realRoomSearchInfo.projectId,t.dailyOrderId=this.roomLiveInfo.dailyOrderId,t.dailyRoomId=this.roomLiveInfo.incomeChoiceRoom,t.info=this.reserveLabel.newVal,t.dailyDetailTypeId=this.roomLiveInfo.incomeMoneyType==this.otherFeeTypeVal?this.roomLiveInfo.incomeAddtionMoneyType:"",t.dailyDetailParentTypeId=this.roomLiveInfo.incomeMoneyType,t.amount=this.roomLiveInfo.incomeMoney,t.payType=this.roomLiveInfo.incomePayType,t.payNo=this.roomLiveInfo.payNo,t.status=this.roomLiveInfo.incomeReceiveType,this.$http.post(o,t).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"添加成功!",type:"success"}),this.roomLiveInfo.payNo="",this.getRealRoomTable(),this.enterOrderDetailMode(t.dailyOrderId))}).catch(function(e){console.log(e)});break;case"CheckLive":break;case"exitRoom":break;case"orderDetail":o="/api/daily/order/income",t.dailyRentalId=this.realRoomSearchInfo.projectId,t.dailyOrderId=this.orderRoomDetail.dailyOrderId,t.dailyRoomId=this.orderRoomDetail.incomeChoiceRoom,t.info=this.reserveLabel.newVal,t.dailyDetailTypeId=this.orderRoomDetail.incomeMoneyType==this.otherFeeTypeVal?this.orderRoomDetail.incomeAddtionMoneyType:"",t.dailyDetailParentTypeId=this.orderRoomDetail.incomeMoneyType,t.amount=this.orderRoomDetail.incomeMoney,t.payType=this.orderRoomDetail.incomePayType,t.payNo=this.orderRoomDetail.payNo,t.status=this.orderRoomDetail.incomeReceiveType,this.$http.post(o,t).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"添加成功!",type:"success"}),this.orderRoomDetail.payNo="",this.getRealRoomTable(),this.enterOrderDetailMode(t.dailyOrderId))}).catch(function(e){console.log(e)});break;default:}},deleteOrderRoom(e){this.$confirm("是否删除该数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$http.post("/api/daily/order/detailDelete",{dailyOrderDetailId:e.dailyDetailId,info:e.label}).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({type:"success",message:"删除成功!"}),this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId))}).catch(function(e){console.log(e)})}).catch(()=>{})},enterEditRoomOrder(e){switch(e){case"reserve":break;case"DirectLive":break;case"CheckLive":this.enterRoomManage(this.roomManageInfo,"CheckLive","orderDetail");break;case"exitRoom":this.enterRoomManage(this.roomManageInfo,"exitRoom","orderDetail");break;case"orderDetail":this.enterRoomManage(this.roomManageInfo,"DirectLive","orderDetail");break;default:}},showTableReserveLabel(e){this.reserveLabel.isInsert=!1,this.reserveLabel.index=e.indexNum||0,this.reserveLabel.dailyOrderDetailId=e.dailyDetailId,this.reserveLabel.dailyOrderId=e.dailyOrderId,this.reserveLabel.newVal=e.label,this.dialogReserveLabel=!0},deleteTableReserve(e){if("me"==this.roomManageInfo.from){for(var o=0;o<this.orderReserveTable.length;o++)this.orderReserveTable[o].indexNum==e.indexNum&&this.orderReserveTable.splice(o,1);this.calculatePayAndNeedMoney()}else this.deleteOrderRoom(e)},getReserveTableMoney(e){if("DirectLive"==this.roomManageInfo.manageType&&"me"!=this.roomManageInfo.from)this.getReceiveMoney(e);else{for(var o=0;o<this.orderReserveTable.length;o++)if(this.orderReserveTable[o].indexNum==e.indexNum){e=this.orderReserveTable[o];e.income="2",e.incomeName="已收",this.$set(this.orderReserveTable,"i",e)}this.calculatePayAndNeedMoney()}},getOrderRoomTableDetail(e){this.$http.get("/api/daily/order/findOrder",{params:{dailyOrderId:e}}).then(o=>{var t=o.data;if(0==t.errorCode){this.orderReserveTable=[],this.roomLimitTypeList=[],this.orderRoomDetail.dailyOrderId=e,this.orderRoomDetail.orderNo=t.data.orderNo,this.orderRoomDetail.dailyOrderSourceId=t.data.dailyOrderSourceId,this.orderRoomDetail.dailyOrderSourceName=t.data.dailyOrderSourceName||"-";for(var i=t.data.details||[],a=0;a<i.length;a++)this.orderReserveTable.push({indexNum:a,moneyType:"收押金"==i[a].name?"2":"",moneyTypeName:i[a].name,income:1==i[a].status.val?i[a].status.val:1==i[a].income.val?2:3,incomeName:i[a].status.text,payType:i[a].payType,payTypeName:i[a].payName,money:i[a].amount,roomName:i[a].dailyRoomName,roomDailyTypeName:i[a].dailyRoomTypeName,roomDailyRoomId:i[a].dailyRoomId,roomDailyRentalId:i[a].dailyRentalId,roomDailyDetailTypeId:i[a].dailyDetailTypeId,operatorTime:i[a].updateTime&&""!=i[a].updateTime?i[a].updateTime.substring(0,10):"-",operatorName:i[a].createrName||"-",operate:"",dailyDetailId:i[a].dailyDetailId,dailyOrderId:i[a].dailyOrderId,refundAmount:i[a].refundAmount,label:i[a].info});this.calculatePayAndNeedMoney()}}).catch(function(e){console.log(e)})},getReceiveMoney(e){this.receiveMoneyInfo.dailyOrderDetailId=e.dailyDetailId,this.receiveMoneyInfo.dailyOrderId=e.dailyOrderId,this.receiveMoneyInfo.payType=e.payType||(this.incomePayTypeList.length>0?this.incomePayTypeList[0].dailyDetailPayTypeId:""),this.receiveMoneyInfo.money=e.money||0,this.receiveMoneyInfo.label="",this.dialogReceiveMoney=!0},comfirmSubmitReceiveMoney(){this.$http.post("/api/daily/order/paid",{dailyOrderDetailId:this.receiveMoneyInfo.dailyOrderDetailId,info:this.receiveMoneyInfo.label,payType:this.receiveMoneyInfo.payType}).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({type:"success",message:"收款成功!"}),this.dialogReceiveMoney=!1,this.getOrderRoomTableDetail(this.receiveMoneyInfo.dailyOrderId))}).catch(function(e){console.log(e)})},getBackMoney(e){this.exitMoneyInfo.refundDetailId=e.dailyDetailId,this.exitMoneyInfo.dailyOrderId=e.dailyOrderId,this.exitMoneyInfo.money=e.money||0,this.exitMoneyInfo.payType=e.payType||(this.incomePayTypeList.length>0?this.incomePayTypeList[0].dailyDetailPayTypeId:""),this.exitMoneyInfo.status="2",this.exitMoneyInfo.label="",this.dialogExitMoney=!0},comfirmSubmitExitMoney(){this.$http.post("/api/daily/order/refund",{refundDetailId:this.exitMoneyInfo.refundDetailId,info:this.exitMoneyInfo.label,amount:this.exitMoneyInfo.money,payType:this.exitMoneyInfo.payType,status:this.exitMoneyInfo.status}).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({type:"success",message:"退款成功!"}),this.dialogExitMoney=!1,this.getRealRoomTable(),this.getOrderRoomTableDetail(this.exitMoneyInfo.dailyOrderId))}).catch(function(e){console.log(e)})},saveDialogSettleAccounts(){switch(this.settleAccount.type){case"reserve":this.roomReserveInfo.payNo=this.settleAccount.newVal;break;case"DirectLive":this.roomLiveInfo.payNo=this.settleAccount.newVal;break;case"orderDetail":this.orderRoomDetail.payNo=this.settleAccount.newVal;break;default:}this.dialogReserveSettleAccounts=!1},saveDialogReserveLabel(){this.reserveLabel.isInsert?this.dialogReserveLabel=!1:"reserve"!=this.roomManageInfo.manageType&&("DirectLive"!=this.roomManageInfo.manageTypeName||"me"!=this.roomManageInfo.from)||this.dialogRoomStatusList?this.$http.post("/api/daily/order/detailInfo",{dailyOrderDetailId:this.reserveLabel.dailyOrderDetailId,info:this.reserveLabel.newVal}).then(e=>{var o=e.data;0==o.errorCode&&(this.dialogReserveLabel=!1,this.getOrderRoomTableDetail(this.reserveLabel.dailyOrderId))}).catch(function(e){console.log(e)}):(this.orderReserveTable[this.reserveLabel.index].label=this.reserveLabel.newVal,this.dialogReserveLabel=!1)},comfirmSubmitReserve(){if(""==this.roomReserveInfo.name||void 0==this.roomReserveInfo.name)return this.$message({type:"error",message:"姓名不能为空!"});if(""==this.roomReserveInfo.phone||void 0==this.roomReserveInfo.phone)return this.$message({type:"error",message:"手机号码不能为空!"});if(""==this.roomReserveInfo.cardNo||void 0==this.roomReserveInfo.cardNo)return this.$message({type:"error",message:"证件号码不能为空!"});for(var e=[],o=[],t=0;t<this.roomOrderList.length;t++){for(var i=[],a=0;a<this.roomOrderList[t].priceDataList.length;a++)i.push({time:this.roomOrderList[t].priceDataList[a].date,price:"handle"==this.roomOrderList[t].priceSpecs?this.roomOrderList[t].price:this.roomOrderList[t].priceDataList[a].price});var s="";for(a=0;a<this.roomPriceTypeList.length;a++)this.roomPriceTypeList[a].dailySalesChanelId==this.roomOrderList[t].priceSpecs&&(s=this.roomPriceTypeList[a].chanelName);e.push({startDate:this.roomOrderList[t].startData,retentionTime:this.roomOrderList[t].retentionTime,endDate:this.roomOrderList[t].leaveData,dailyRoomTypeId:this.roomOrderList[t].roomTypeId,roomNum:this.roomOrderList[t].night,customers:[{name:this.roomReserveInfo.name,tel:this.roomReserveInfo.phone,cardType:this.roomReserveInfo.cardType,cardNo:this.roomReserveInfo.cardNo}],roomStatus:"2",priceSpecs:"handle"==this.roomOrderList[t].priceSpecs?"-1":this.roomOrderList[t].priceSpecs,priceSpecsName:s,dailyRoomId:this.roomOrderList[t].roomType,prices:i})}for(t=0;t<this.orderReserveTable.length;t++)o.push({dailyRentalId:this.orderReserveTable[t].roomDailyRentalId,dailyRoomId:this.orderReserveTable[t].roomDailyRoomId,dailyDetailParentTypeId:this.orderReserveTable[t].roomDailyDetailTypeId,dailyDetailTypeId:this.orderReserveTable[t].roomDailyDetailTypeId==this.otherFeeTypeVal?this.orderReserveTable[t].moneyChildType:"",amount:this.orderReserveTable[t].money,payType:this.orderReserveTable[t].payType,payNo:this.orderReserveTable[t].payNo,info:this.orderReserveTable[t].label,status:this.orderReserveTable[t].income});var r={dailyRentalId:this.realRoomSearchInfo.projectId,sourceId:this.roomReserveInfo.origin,info:this.roomReserveInfo.label,rooms:e,incomes:o};this.$http.post("/api/daily/order/create",r).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"预定成功!",type:"success"}),this.dialogInsertReserve=!1,this.getRealRoomTable(),this.geRoomOrderNumList())}).catch(function(e){console.log(e)})},insertNewRoomList(){for(var e=0;e<this.roomTypeList.length;e++)this.roomTypeList[e].dailyRoomId==this.roomManageInfo.dailyRoomId&&this.roomTypeList[e].dailyRoomTypeId;this.livePersonList.push({persons:[{name:"",phone:"",cardType:this.livePersonList[0].persons[0].cardType,cardNo:""}],startData:this.livePersonList[this.livePersonList.length-1].startData,leaveData:this.livePersonList[this.livePersonList.length-1].leaveData,night:this.livePersonList[this.livePersonList.length-1].night,roomType:this.livePersonList[this.livePersonList.length-1].roomType,optionRooms:this.livePersonList[this.livePersonList.length-1].optionRooms,priceSpecs:this.livePersonList[this.livePersonList.length-1].priceSpecs,priceSpecsList:this.livePersonList[this.livePersonList.length-1].priceSpecsList,roomTypeId:this.livePersonList[this.livePersonList.length-1].roomTypeId,roomStatus:this.livePersonList[this.livePersonList.length-1].roomStatus,price:this.livePersonList[this.livePersonList.length-1].price,priceDataList:this.livePersonList[this.livePersonList.length-1].priceDataList}),this.changeRoomTypeVal()},removeNewRoomList(e){this.livePersonList.length>1&&(this.livePersonList.splice(e,1),this.changeRoomTypeVal())},dialogShowRoomPerson(e,o,t){this.personShow.List=o,this.personShow.from=e,this.personShow.index=t,this.dialogAddRoomPerson=!0},dialogHideRoomPerson(){for(var e=0;e<this.personShow.List.length;e++){if(""==this.personShow.List[e].name||void 0==this.personShow.List[e].name)return this.$message({type:"error",message:"入住人姓名不能为空!"});if(""==this.personShow.List[e].phone||void 0==this.personShow.List[e].phone)return this.$message({type:"error",message:"入住人手机号码不能为空!"});if(""==this.personShow.List[e].cardNo||void 0==this.personShow.List[e].cardNo)return this.$message({type:"error",message:"入住人证件号码不能为空!"})}switch(this.personShow.from){case"dialogInsertLive":this.livePersonList[this.personShow.index].persons=this.personShow.List;break;default:}this.dialogAddRoomPerson=!1},insertPersonDialog(){this.personShow.List.push({name:"",phone:"",cardType:this.personShow.List[0].cardType,cardNo:""})},changeAddtionPayType(e){var o=!0;switch(this.settleAccount.type=e,e){case"reserve":for(var t=0;t<this.incomePayTypeList.length;t++)this.roomReserveInfo.incomePayType==this.incomePayTypeList[t].dailyDetailPayTypeId&&(o=!1,this.roomReserveInfo.showPayNo=!(!this.incomePayTypeList[t].type||2!=this.incomePayTypeList[t].type.val));o||(this.roomReserveInfo.payNo="");break;case"DirectLive":for(t=0;t<this.incomePayTypeList.length;t++)this.roomLiveInfo.incomePayType==this.incomePayTypeList[t].dailyDetailPayTypeId&&(o=!1,this.roomLiveInfo.showPayNo=!(!this.incomePayTypeList[t].type||2!=this.incomePayTypeList[t].type.val));o||(this.roomLiveInfo.payNo="");break;case"orderDetail":for(t=0;t<this.incomePayTypeList.length;t++)this.orderRoomDetail.incomePayType==this.incomePayTypeList[t].dailyDetailPayTypeId&&(o=!1,this.orderRoomDetail.showPayNo=!(!this.incomePayTypeList[t].type||2!=this.incomePayTypeList[t].type.val));o||(this.orderRoomDetail.payNo="");break;default:}},deletePersonDialog(e){this.personShow.List.length>1&&this.personShow.List.splice(e,1)},closeDialogInsertLive(){this.dialogRoomDetail&&(this.roomManageInfo.manageType="orderDetail"),this.dialogInsertLive=!1},closeDialogExitRoom(){this.dialogRoomDetail&&(this.roomManageInfo.manageType="orderDetail"),this.dialogExitRoom=!1},comfirmSubmitDirectLive(){for(var e=[],o=[],t=0;t<this.livePersonList.length;t++){for(var i=[],a=[],s=0;s<this.livePersonList[t].priceDataList.length;s++)i.push({time:this.livePersonList[t].priceDataList[s].date,price:"handle"==this.livePersonList[t].priceSpecs?this.livePersonList[t].price:this.livePersonList[t].priceDataList[s].price});for(s=0;s<this.livePersonList[t].persons.length;s++){if(""==this.livePersonList[t].persons[s].name||void 0==this.livePersonList[t].persons[s].name)return this.$message({type:"error",message:"姓名不能为空!"});if(""==this.livePersonList[t].persons[s].phone||void 0==this.livePersonList[t].persons[s].phone)return this.$message({type:"error",message:"手机号码不能为空!"});if(""==this.livePersonList[t].persons[s].cardNo||void 0==this.livePersonList[t].persons[s].cardNo)return this.$message({type:"error",message:"证件号码不能为空!"});a.push({name:this.livePersonList[t].persons[s].name,tel:this.livePersonList[t].persons[s].phone,cardType:this.livePersonList[t].persons[s].cardType,cardNo:this.livePersonList[t].persons[s].cardNo})}if("CheckLive"!=this.roomManageInfo.manageType||"CheckLive"==this.roomManageInfo.manageType&&this.livePersonList[t].checked){var r="";"noRoomReserve"==this.roomManageInfo.manageType?r="1":"reserve"==this.roomManageInfo.manageType?r="2":"DirectLive"==this.roomManageInfo.manageType&&"me"==this.roomManageInfo.from&&(r="3");var n="办理入住"==this.roomManageInfo.manageTypeName?"3":this.livePersonList[t].roomStatus||r,l="";for(s=0;s<this.roomPriceTypeList.length;s++)this.roomPriceTypeList[s].dailySalesChanelId==this.livePersonList[t].priceSpecs&&(l=this.roomPriceTypeList[s].chanelName);"DirectLive"==this.roomManageInfo.manageType&&"distributeDetail"==this.roomManageInfo.from?(n="2",e.push({startDate:this.livePersonList[t].startData,retentionTime:this.livePersonList[t].retentionTime,endDate:this.livePersonList[t].leaveData,dailyRoomTypeId:this.livePersonList[t].roomTypeId,dailyRoomId:this.livePersonList[t].roomType,roomNum:this.livePersonList[t].night,customers:a,roomStatus:n,priceSpecs:"handle"==this.livePersonList[t].priceSpecs?"-1":this.livePersonList[t].priceSpecs,priceSpecsName:l,prices:i})):e.push({startDate:this.livePersonList[t].startData,endDate:this.livePersonList[t].leaveData,dailyRoomTypeId:this.livePersonList[t].roomTypeId,dailyRoomId:this.livePersonList[t].roomType,roomNum:this.livePersonList[t].night,customers:a,roomStatus:n,priceSpecs:"handle"==this.livePersonList[t].priceSpecs?"-1":this.livePersonList[t].priceSpecs,priceSpecsName:l,prices:i})}}for(t=0;t<this.orderReserveTable.length;t++)o.push({dailyRentalId:this.orderReserveTable[t].roomDailyRentalId,dailyRoomId:this.orderReserveTable[t].roomDailyRoomId,dailyDetailParentTypeId:this.orderReserveTable[t].roomDailyDetailTypeId,dailyDetailTypeId:this.orderReserveTable[t].roomDailyDetailTypeId==this.otherFeeTypeVal?this.orderReserveTable[t].moneyChildType:"",amount:this.orderReserveTable[t].money,payType:this.orderReserveTable[t].payType,payNo:this.orderReserveTable[t].payNo,info:this.orderReserveTable[t].label,status:this.orderReserveTable[t].income});var c={dailyRentalId:this.realRoomSearchInfo.projectId,sourceId:this.roomLiveInfo.origin,info:this.roomLiveInfo.label,rooms:e,incomes:o},m="",d="";"me"==this.roomManageInfo.from||"CheckLive"==this.roomManageInfo.manageType&&"orderDetail"==this.roomManageInfo.from||"DirectLive"==this.roomManageInfo.manageType&&this.dialogRoomStatusList?(m="/api/daily/order/create",d="入住成功!"):(m="/api/daily/order/update",c.dailyOrderId=this.roomLiveInfo.dailyOrderId,d="修改成功!"),"办理入住"==this.roomManageInfo.manageTypeName&&(m="/api/daily/order/checkin",c.dailyOrderId=this.roomLiveInfo.dailyOrderId,d="入住成功!"),"分配房间"==this.roomManageInfo.manageTypeName&&(m="/api/daily/order/assigne",c.dailyOrderId=this.roomLiveInfo.dailyOrderId,d="入住成功!"),this.$http.post(m,c).then(e=>{var o=e.data;if(0==o.errorCode){this.$message({message:d,type:"success"});var t=!0;this.dialogRoomDetail||(t=!1),this.dialogInsertReserve=!1,this.dialogInsertLive=!1,t&&(this.roomManageInfo.manageType="orderDetail",this.enterRoomManage(this.roomManageInfo,"orderDetail")),this.getRealRoomTable(),this.geRoomOrderNumList(),this.dialogRoomStatusList&&(this.dialogRoomDetail=!1,this.getOrderNumTable(this.roomOrderInfo.type))}}).catch(function(e){console.log(e)})},handleTableCurrentChange(e){this.roomManageInfo=e,this.roomManageInfo.to="",this.enterOrderDetailMode(e.dailyOrderId)},comfirmSubmitCancelDistribute(){this.$http.post("/api/daily/order/unassigned",{dailyOrderId:this.orderRoomDetail.dailyOrderId}).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"取消成功!",type:"success"}),this.dialogCancelDistribute=!1,this.enterOrderDetailMode(this.orderRoomDetail.dailyOrderId),this.getRealRoomTable(),this.geRoomOrderNumList())}).catch(function(e){console.log(e)})},cancelRoomOrder(){this.dialogCancelOrder=!0,this.orderBackMoneyTable=[],this.cancelOrder.money="",this.cancelOrder.payType="",this.cancelOrder.label="",this.cancelOrder.reason="";for(var e=0;e<this.orderReserveTable.length;e++)2==this.orderReserveTable[e].income&&this.orderBackMoneyTable.push(this.orderReserveTable[e]);this.getCancelOrderReasonList()},comfirmSubmitCancelOrder(){this.$http.post("/api/daily/order/close",{dailyOrderId:this.orderRoomDetail.dailyOrderId,info:this.cancelOrder.label,closedId:this.cancelOrder.reason}).then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"取消成功!",type:"success"}),this.dialogCancelOrder=!1,this.dialogRoomDetail=!1,this.getRealRoomTable(),this.geRoomOrderNumList(),this.dialogRoomStatusList&&(this.dialogRoomDetail=!1,this.getOrderNumTable(this.roomOrderInfo.type)))})},getCancelOrderReasonList(){this.$http.get("/api/daily/order/public/findClosedTypies").then(e=>{var o=e.data;0==o.errorCode&&(this.cancelOrderReasonList=o.data||[],this.cancelOrderReasonList.length>0&&(this.cancelOrder.reason=this.cancelOrderReasonList[0].dailyOrderClosedId))}).catch(function(e){console.log(e)})},changeExitPersonChoice(e){var o=this.exitPersonList[e];this.$set(this.exitPersonList,e,o)},enterDistributeRoom(){this.enterRoomManage(this.roomManageInfo,"DirectLive","distributeDetail")},comfirmClearAndExitRoom(){for(var e=[],o=0;o<this.exitPersonList.length;o++)this.exitPersonList[o].isChecked&&e.push(this.exitPersonList[o].dailyOrderRoomId);if(0==e.length)return this.$message({message:"请选择要退的房间!",type:"error"});var t=this.roomExitInfo.depositDeduct?this.roomLiveInfo.needMoney-this.roomLiveInfo.roomDepositMoney>=0?"需补交":"需退回":this.roomLiveInfo.needMoney>=0?"需补交":"需退回",i=this.roomExitInfo.depositDeduct?Math.abs(this.roomLiveInfo.needMoney-this.roomLiveInfo.roomDepositMoney||"0"):Math.abs(this.roomLiveInfo.needMoney||"0");this.$confirm(`当前订单<span style="color: #ff0000;">${t}${i}元</span>，是否结账退房`,"提示",{dangerouslyUseHTMLString:!0,distinguishCancelAndClose:!0,confirmButtonText:"结账退房",cancelButtonText:"取消"}).then(()=>{this.$http.post("/api/daily/order/checkout",{dailyOrderId:this.roomLiveInfo.dailyOrderId,sourceId:this.roomLiveInfo.origin,info:this.roomLiveInfo.label,orderRoomIds:e,depositDeduct:this.roomExitInfo.depositDeduct?"1":"2"}).then(e=>{var o=e.data;if(0==o.errorCode){this.$message({message:"退房成功!",type:"success"});var t=!0;this.dialogRoomDetail||(t=!1),this.searchRealRoomTable(),t&&("exitLive"==this.roomManageInfo.to&&this.getOrderNumTable(this.roomOrderInfo.type),"exitLive"!=this.roomManageInfo.to&&this.enterRoomManage(this.roomManageInfo,"orderDetail")),this.dialogRoomStatusList&&(this.dialogRoomDetail=!1,this.getOrderNumTable(this.roomOrderInfo.type)),this.dialogExitRoom=!1}})}).catch(e=>{})},enterRoomOperate(e){this.roomManageInfo=e,"待分房"==this.roomOrderInfo.name?this.roomManageInfo.to="distributeRoom":"今日预到"==this.roomOrderInfo.name?this.roomManageInfo.to="compareLive":"NOSHOW"==this.roomOrderInfo.name?e.roomStatus&&1==e.roomStatus.val?this.roomManageInfo.to="distributeRoom":e.roomStatus&&2==e.roomStatus.val&&(this.roomManageInfo.to="compareLive"):this.roomManageInfo.to="exitLive",this.enterOrderDetailMode(e.dailyOrderId)},openDialogSettleAccounts(){this.settleAccount.originVal=this.settleAccount.newVal,this.dialogReserveSettleAccounts=!0},closeDialogSettleAccounts(){this.settleAccount.newVal=this.settleAccount.originVal,this.dialogReserveSettleAccounts=!1},openDialogReserveLabel(){this.reserveLabel.originVal=this.reserveLabel.newVal,this.reserveLabel.isInsert=!0,this.dialogReserveLabel=!0},closeDialogReserveLabel(){this.reserveLabel.newVal=this.reserveLabel.originVal,this.dialogReserveLabel=!1},openDialogLabel(){this.allLable.originVal=this.allLable.newVal,this.dialogLabel=!0},closeDialogLabel(){this.allLable.newVal=this.allLable.originVal,this.dialogLabel=!1},changeAccountType(e){this.dailyAccount.accountType=e,this.getMoneyTypeList()},getMoneyTypeList(){this.$http.get("/api/daily/setting/getChargeFeeTypeList",{params:{income:"income"==this.dailyAccount.accountType?"1":"2"}}).then(e=>{var o=e.data;0==o.errorCode&&(this.moneyTypeList=o.data||[])}).catch(function(e){console.log(e)})},comfirmSubmitDailyAccount(){return void 0==this.dailyAccount.projectId||""==this.dailyAccount.projectId?this.$message({message:"请选择楼盘!",type:"error"}):void 0==this.dailyAccount.money||""==this.dailyAccount.money?this.$message({message:"请输入金额!",type:"error"}):void 0==this.dailyAccount.date||""==this.dailyAccount.date?this.$message({message:"请选择日期!",type:"error"}):void 0==this.dailyAccount.moneyType||""==this.dailyAccount.moneyType?this.$message({message:"请选择费用类型!",type:"error"}):void 0==this.dailyAccount.payType||""==this.dailyAccount.payType?this.$message({message:"请选择支付方式!",type:"error"}):void this.$http.post("/api/daily/order/createBookKeeping",{dailyDetailTypeId:this.dailyAccount.moneyType,dailyRentalId:this.dailyAccount.projectId,amount:this.dailyAccount.money,payType:this.dailyAccount.payType,info:this.dailyAccount.label,status:"2",time:this.dailyAccount.date}).then(e=>{var o=e.data;0==o.errorCode&&(this.dialogDailyAccount=!1,this.$alert('您可以在<span style="color: #02cab0;">"财务报表-日租记账"</span>中查看数据！',"记账成功",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",callback:e=>{}}))})},getHandleOverStatus(){this.$http.get("/api/daily/setting/findLastClassRecord").then(e=>{var o=e.data;0==o.errorCode&&(void 0==o.data||""==o.data?0==this.projectList.length?this.$http.get("/api/daily/order/getRentalList").then(e=>{var o=e.data;0==o.errorCode&&(this.projectList=o.data||[],this.projectList.length>0&&(this.handleOverInfo.projectId=this.projectList[0].dailyRentalId,this.getHandleOverList(this.handleOverInfo.projectId)))}).catch(function(e){console.log(e)}):(setTimeout(()=>{location.reload()},800),this.$message({message:"当前班次已失效!",type:"error"})):(this.handleOverInfo.orderName=o.data.className||"",this.handleOverInfo.user=o.data.sysUserName||"",this.handleOverInfo.classId=o.data.classId,this.handleOverInfo.duringStartTime=o.data.classStartTime||"-",this.handleOverInfo.duringEndTime=o.data.classEndTime||"-",this.handleOverInfo.saleStartData=o.data.startTime&&o.data.startTime.length>0?o.data.startTime.substring(0,10):"-",this.handleOverInfo.saleEndData=o.data.endTime&&o.data.endTime.length>0?o.data.endTime.substring(0,10):"-",0==this.projectList.length?(this.getRoomSortList(),this.getProjectList()):this.getFinalAggregateTable()))}).catch(function(e){console.log(e)})},getHandleOverList(e){this.$http.get("/api/daily/setting/getClassesList",{params:{rentalId:e}}).then(e=>{var o=e.data;0==o.errorCode&&(this.handleOverList=o.data||[],this.dialogChoiceFlightSelection=!0)}).catch(function(e){console.log(e)})},getFinalAggregateTable(){this.$http.get("/api/daily/order/findDetailGroupPayTypeForClass").then(e=>{var o=e.data;if(0==o.errorCode){this.finalAggregateTable=o.data.content||[];var t=0,i=0,a=0;if(this.finalAggregateTable.length>0)for(var s=0;s<this.finalAggregateTable.length;s++)t+=this.finalAggregateTable[s].incomeTotal,i+=this.finalAggregateTable[s].payoutTotal,a+=this.finalAggregateTable[s].total;this.finalAggregateTable.push({incomeTotal:Number(t).toFixed(2),payoutTotal:Number(i).toFixed(2),total:Number(a).toFixed(2)}),this.dialogHandOver=!0}}).catch(function(e){console.log(e)})},changeProjectHandleOver(){setTimeout(()=>{this.getHandleOverList(this.handleOverInfo.projectId)},60)},openDialogRemainTime(e,o){this.dialogRoomRemainTime=!0,this.remainTime.type=e,this.remainTime.index=o,this.remainTime.originVal=this.remainTime.newVal="distributeDetail"==e?this.livePersonList[o].retentionTime||this.currentData+" 12:00:00":this.remainTime.newVal},closeDialogRemainTime(){this.dialogRoomRemainTime=!1,this.remainTime.newVal=this.remainTime.originVal},comfirmChoiceRemainTime(){"noRoomReserve"==this.remainTime.type?this.noRoomReserveInfo.retentionTime=this.remainTime.newVal:"reserve"==this.remainTime.type?this.roomOrderList[this.remainTime.index].retentionTime=this.remainTime.newVal:this.livePersonList[this.remainTime.index].retentionTime=this.remainTime.newVal,this.dialogRoomRemainTime=!1},choiceHandleTime(e){this.$http.post("/api/daily/setting/class/set",{classId:this.handleOverList[e].classId}).then(o=>{var t=o.data;0==t.errorCode&&(this.handleOverInfo.orderName=this.handleOverList[e].className||"-",this.handleOverInfo.classId=this.handleOverList[e].classId||"-",this.handleOverInfo.duringStartTime=this.handleOverList[e].beginTime,this.handleOverInfo.duringEndTime=this.handleOverList[e].endTime,this.getRoomSortList(),this.getProjectList(this.handleOverInfo.projectId),this.dialogChoiceFlightSelection=!1)}).catch(function(e){console.log(e)})},exitHandleOver(){this.$http.post("/api/daily/setting/completeClassRecord").then(e=>{var o=e.data;0==o.errorCode&&(this.$message({message:"交班成功!",type:"success"}),setTimeout(()=>{this.dialogHandOver=!1},1e3))}).catch(function(e){console.log(e)})},exportHandleOver(){var e="./api/daily/order/findDetailGroupPayTypeForClassExport";window.open(e)},showDialogHandOver(){this.getHandleOverStatus()},handleTableDeviceInsert(e){this.dialogVisibleInsertDevice=!0,this.deviceInsertInfo.deviceNo="",this.deviceInsertInfo.deviceName="",this.deviceInsertInfo.deviceModel="",this.deviceInsertInfo.roomId=e.dailyRoomId,this.getDeviceProjectList(),this.getDeviceBrandList()},changDeviceChoiceTabVal(){setTimeout(()=>{this.getDeviceBrandList()},30)},getDeviceProjectList(){this.$http.get("/api/deviceDeploy/getOrgList").then(e=>{var o=e.data;if(0==o.errorCode&&(this.deviceProjectList=[],this.deviceOriginProjectList=o.data||[],this.deviceOriginProjectList.length>0)){for(var t=0;t<this.deviceOriginProjectList.length;t++){var i=this.deviceOriginProjectList[t];2==i.orgType&&this.deviceProjectList.push(i)}this.deviceProjectList.length>0?(this.deviceInsertInfo.orgId=this.realRoomSearchInfo.projectId||this.deviceProjectList[0].orgId,this.deviceInsertInfo.orgType=this.deviceProjectList[0].orgType,this.getDeviceRoomList()):this.deviceInsertInfo.orgId=""}}).catch(function(e){console.log(e)})},changeDevieProjectVal(){this.getDeviceRoomList()},getDeviceRoomList(){this.$http.get("/api/room/getRoomByOrg",{params:{orgId:this.deviceInsertInfo.orgId,orgType:this.deviceInsertInfo.orgType}}).then(e=>{var o=e.data;0==o.errorCode&&(this.deviceRoomList=o.data||[])}).catch(function(e){console.log(e)})},getDeviceBrandList(){this.$http.get("/api/deviceDeploy/getDeviceCategoryList",{params:{name:"",deviceType:"electronic"==this.deviceInsertInfo.type?1:"water"==this.deviceInsertInfo.type?2:0}}).then(e=>{var o=e.data;0==o.errorCode&&(this.deviceBrandList=o.data||[],this.deviceBrandList.length>0&&(this.deviceInsertInfo.brandId=this.deviceBrandList[0].deviceCategotyId))}).catch(function(e){console.log(e)})},comfirmSubmitInsertDevice(){return""==this.deviceInsertInfo.orgId||void 0==this.deviceInsertInfo.orgId?this.$message({message:"请选择项目！",type:"error"}):""==this.deviceInsertInfo.roomId||void 0==this.deviceInsertInfo.roomId?this.$message({message:"请选择房间号！",type:"error"}):""==this.deviceInsertInfo.brandId||void 0==this.deviceInsertInfo.brandId?this.$message({message:"请选择品牌！",type:"error"}):""==this.deviceInsertInfo.deviceNo||void 0==this.deviceInsertInfo.deviceNo?this.$message({message:"请输入设备序列号！",type:"error"}):""==this.deviceInsertInfo.deviceName||void 0==this.deviceInsertInfo.deviceName?this.$message({message:"请输入设备名称！",type:"error"}):""==this.deviceInsertInfo.deviceModel||void 0==this.deviceInsertInfo.deviceModel?this.$message({message:"请输入设备型号！",type:"error"}):void this.$http.post("/api/deviceDeploy/addDevice",{orgId:this.deviceInsertInfo.orgId,orgType:this.deviceInsertInfo.orgType,deviceCategoryId:this.deviceInsertInfo.brandId,roomId:this.deviceInsertInfo.roomId,deviceNo:this.deviceInsertInfo.deviceNo,deviceName:this.deviceInsertInfo.deviceName,deviceModel:this.deviceInsertInfo.deviceModel}).then(e=>{var o=e.data;0==o.errorCode&&setTimeout(()=>{this.$message({message:"新增成功！",type:"success"}),this.dialogVisibleInsertDevice=!1},1e3)}).catch(function(e){console.log(e)})},getMoneyDayList(e){var o=!1;switch(this.moneyChoiceDayList=[],e){case"reserve":this.roomReserveInfo.rentMoneyDay="";for(var t=0;t<this.roomOrderList.length;t++)this.roomReserveInfo.incomeChoiceRoom==this.roomOrderList[t].roomType&&(this.moneyDayInfo.startData=this.roomOrderList[t].startData,this.moneyDayInfo.endData=this.roomOrderList[t].leaveData,this.moneyDayInfo.roomPrice=this.roomOrderList[t].price,this.moneyDayInfo.dayCount=this.roomOrderList[t].night,o=!0);if(o){for(t=1;t<=this.moneyDayInfo.dayCount;t++)this.moneyChoiceDayList.push({text:t+"天",val:t});this.moneyChoiceDayList.push({text:"手动",val:"handle"}),this.roomReserveInfo.rentMoneyDay=this.moneyChoiceDayList[0].val,this.roomReserveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.moneyChoiceDayList[0].val,this.roomReserveInfo.moneyCanEidt=!1}break;case"DirectLive":this.roomLiveInfo.rentMoneyDay="";for(t=0;t<this.livePersonList.length;t++)this.roomLiveInfo.incomeChoiceRoom==this.livePersonList[t].roomType&&(this.moneyDayInfo.startData=this.livePersonList[t].startData,this.moneyDayInfo.endData=this.livePersonList[t].leaveData,this.moneyDayInfo.roomPrice=this.livePersonList[t].price,this.moneyDayInfo.dayCount=this.livePersonList[t].night,o=!0);if(o){for(t=1;t<=this.moneyDayInfo.dayCount;t++)this.moneyChoiceDayList.push({text:t+"天",val:t});this.moneyChoiceDayList.push({text:"手动",val:"handle"}),this.roomLiveInfo.rentMoneyDay=this.moneyChoiceDayList[0].val,this.roomLiveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.moneyChoiceDayList[0].val,this.roomLiveInfo.moneyCanEidt=!1}break;case"CheckLive":break;case"exitRoom":this.roomLiveInfo.rentMoneyDay="";for(t=0;t<this.exitPersonList.length;t++)this.roomLiveInfo.incomeChoiceRoom==this.exitPersonList[t].dailyRoomId&&(this.moneyDayInfo.startData=this.exitPersonList[t].startDate,this.moneyDayInfo.endData=this.exitPersonList[t].endDate,this.moneyDayInfo.roomPrice=this.exitPersonList[t].roomAmount/this.exitPersonList[t].nights,this.moneyDayInfo.dayCount=this.exitPersonList[t].nights,o=!0);if(o){for(t=1;t<=this.moneyDayInfo.dayCount;t++)this.moneyChoiceDayList.push({text:t+"天",val:t});this.moneyChoiceDayList.push({text:"手动",val:"handle"}),this.roomLiveInfo.rentMoneyDay=this.moneyChoiceDayList[0].val,this.roomLiveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.moneyChoiceDayList[0].val,this.roomLiveInfo.moneyCanEidt=!1}break;case"orderDetail":this.orderRoomDetail.rentMoneyDay="";for(t=0;t<this.orderPersonList.length;t++)this.orderRoomDetail.incomeChoiceRoom==this.orderPersonList[t].dailyRoomId&&(this.moneyDayInfo.startData=this.orderPersonList[t].startDate,this.moneyDayInfo.endData=this.orderPersonList[t].endDate,this.moneyDayInfo.roomPrice=this.orderPersonList[t].roomAmount/this.orderPersonList[t].nights,this.moneyDayInfo.dayCount=this.orderPersonList[t].nights,o=!0);if(o){for(t=1;t<=this.moneyDayInfo.dayCount;t++)this.moneyChoiceDayList.push({text:t+"天",val:t});this.moneyChoiceDayList.push({text:"手动",val:"handle"}),this.orderRoomDetail.rentMoneyDay=this.moneyChoiceDayList[0].val,this.orderRoomDetail.incomeMoney=this.moneyDayInfo.roomPrice*this.moneyChoiceDayList[0].val,this.orderRoomDetail.moneyCanEidt=!1}break;default:}},changeMoneyDayVal(e){switch(e){case"reserve":this.roomReserveInfo.rentMoneyDay&&"handle"!=this.roomReserveInfo.rentMoneyDay?(this.roomReserveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.roomReserveInfo.rentMoneyDay,this.roomReserveInfo.moneyCanEidt=!1):this.roomReserveInfo.moneyCanEidt=!0;break;case"DirectLive":this.roomLiveInfo.rentMoneyDay&&"handle"!=this.roomLiveInfo.rentMoneyDay?(this.roomLiveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.roomLiveInfo.rentMoneyDay,this.roomLiveInfo.moneyCanEidt=!1):this.roomLiveInfo.moneyCanEidt=!0;break;case"CheckLive":break;case"exitRoom":this.roomLiveInfo.rentMoneyDay&&"handle"!=this.roomLiveInfo.rentMoneyDay?(this.roomLiveInfo.incomeMoney=this.moneyDayInfo.roomPrice*this.roomLiveInfo.rentMoneyDay,this.roomLiveInfo.moneyCanEidt=!1):this.roomLiveInfo.moneyCanEidt=!0;break;case"orderDetail":this.orderRoomDetail.rentMoneyDay&&"handle"!=this.orderRoomDetail.rentMoneyDay?(this.orderRoomDetail.incomeMoney=this.moneyDayInfo.roomPrice*this.orderRoomDetail.rentMoneyDay,this.orderRoomDetail.moneyCanEidt=!1):this.orderRoomDetail.moneyCanEidt=!0;break;default:}},doPrintHandleOver(){this.$print(this.$refs.print)}}},c=l,m=(t("f3dd"),t("6691")),d=Object(m["a"])(c,i,a,!1,null,null,null);o["default"]=d.exports},fffe:function(e,o,t){"use strict";var i=t("0b8b"),a=t.n(i);a.a}}]);
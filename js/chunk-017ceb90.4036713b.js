(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-017ceb90"],{"0ac2":function(e,t,a){"use strict";var s=a("3a5b"),l=a.n(s);l.a},"3a5b":function(e,t,a){},d712:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-setting"},[a("div",{staticClass:"search-list"},[a("el-row",[a("el-col",{attrs:{span:5}},[a("el-col",{attrs:{span:6}},[e._v("员工信息")]),a("el-col",{attrs:{span:18}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入姓名、手机号",clearable:""},model:{value:e.sStaffInfo,callback:function(t){e.sStaffInfo=t},expression:"sStaffInfo"}})],1)],1),a("el-col",{staticClass:"disp-right pr-10",attrs:{span:19}},[a("el-button",{staticClass:"el-button el-button--primary",on:{click:e.getSysUserPage}},[e._v("查询")]),a("el-button",{staticClass:"el-button el-button--primary",on:{click:e.addUseradmin}},[e._v("添加员工")])],1)],1)],1),a("div",{staticClass:"content-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"cell-click":e.cellclick}},[a("el-table-column",{attrs:{prop:"employeeName",align:"center",label:"用户姓名"}}),a("el-table-column",{attrs:{prop:"phone",align:"center",label:"手机号"}}),a("el-table-column",{attrs:{prop:"roleName",align:"center",label:"角色"}}),a("el-table-column",{attrs:{prop:"createTime",align:"center",label:"添加时间"}}),a("el-table-column",{attrs:{prop:"createbyName",align:"center",label:"创建人"}}),a("el-table-column",{attrs:{prop:"sysUserStatusEnum.text",align:"center",label:"是否禁用"}}),a("el-table-column",{attrs:{prop:"address",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.state?a("span",{staticClass:"greenFont tabOperteBtn"},[e._v("禁用")]):e._e(),1==t.row.state?a("span",{staticClass:"greenFont tabOperteBtn",on:{click:e.startUsing}},[e._v("启用")]):e._e(),a("span",{staticClass:"greenFont tabOperteBtn",on:{click:e.deleStaff}},[e._v("删除")]),a("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(t){return e.editStaffInfo()}}},[e._v("编辑")]),a("span",{staticClass:"greenFont tabOperteBtn"},[e._v("重置密码")]),a("span",{staticClass:"greenFont tabOperteBtn",on:{click:e.userAlterPwdConfromInitData}},[e._v("修改")])]}}])})],1)],1),a("div",{staticClass:"el-page"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40,50],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.dialogVisible,expression:"dialogVisible"}],staticClass:"my-puple"},[a("el-dialog",{attrs:{title:"编辑",visible:e.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"660px","before-close":e.closeActivePuple},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-row",[a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("姓名")]),a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入姓名",clearable:""},model:{value:e.redactData.employeeName,callback:function(t){e.$set(e.redactData,"employeeName",t)},expression:"redactData.employeeName"}})],1)],1),a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("手机号")]),a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入手机号",clearable:""},model:{value:e.redactData.phone,callback:function(t){e.$set(e.redactData,"phone",t)},expression:"redactData.phone"}})],1)],1),a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("角色")]),a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择角色"},model:{value:e.redactData.roleId,callback:function(t){e.$set(e.redactData,"roleId",t)},expression:"redactData.roleId"}},e._l(e.aAddStaffRole,function(e){return a("el-option",{key:e.roleId,attrs:{label:e.name,value:e.roleId}})}),1)],1)],1),a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("是否禁用")]),a("el-col",{attrs:{span:12}},[a("el-radio-group",{attrs:{disabled:""},model:{value:e.iIfBisable,callback:function(t){e.iIfBisable=t},expression:"iIfBisable"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1),a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("头像")]),a("el-col",{attrs:{span:12}},[a("el-row",[a("el-upload",{attrs:{action:"","before-upload":e.beforeupload,accept:"image",multiple:!1,"show-file-list":!1}},[a("div",{staticClass:"input-pic-box"},[a("el-button",{attrs:{type:"primary"}},[e._v("上传图片(只能上传1张，支持png.jpg，尺寸400*300)")])],1)])],1),e.redactData.headimgUrl?a("div",{staticStyle:{display:"inline-block",position:"relative"}},[a("i",{staticClass:"el-icon-close",staticStyle:{position:"absolute",top:"4px",right:"-10px",display:"inline-block"},on:{click:function(t){return e.removeUploadImgOrigin("edit")}}}),a("img",{staticStyle:{"border-radius":"50%","margin-top":"10px"},attrs:{src:e.redactData.headimgUrl,alt:"",width:"120",height:"120"}})]):e._e()],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.alter}},[e._v("确 定")]),a("el-button",{staticClass:"greenBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)],1)],1),a("div",{staticClass:"my-puple "},[a("el-dialog",{attrs:{title:"重置密码",visible:e.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a tr-10",staticStyle:{"text-align":"right","line-height":"40px"},attrs:{span:6}},[e._v("密码")]),a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入新密码",clearable:""},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.resetUserPwd}},[e._v("确 定")])],1)],1)],1),e.dialogVisibleupdeta?a("div",{staticClass:"my-puple"},[a("el-dialog",{attrs:{title:"修改密码",visible:e.dialogVisibleupdeta,width:"30%"},on:{"update:visible":function(t){e.dialogVisibleupdeta=t}}},[a("el-row",{staticClass:"each-item",staticStyle:{"margin-bottom":"10px"}},[a("el-col",{staticClass:"is-required-a tr-10",staticStyle:{"text-align":"right","line-height":"40px"},attrs:{span:6}},[e._v("原密码")]),a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"password",placeholder:"请输入新密码",clearable:""},model:{value:e.oldpwd3,callback:function(t){e.oldpwd3=t},expression:"oldpwd3"}})],1)],1),a("el-row",{staticClass:"each-item",staticStyle:{"margin-bottom":"10px"}},[a("el-col",{staticClass:"is-required-a tr-10",staticStyle:{"text-align":"right","line-height":"40px"},attrs:{span:6}},[e._v("新密码")]),a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"password",placeholder:"请输入新密码",clearable:""},model:{value:e.pwd2,callback:function(t){e.pwd2=t},expression:"pwd2"}})],1)],1),a("el-row",{staticClass:"each-item",staticStyle:{"margin-bottom":"10px"}},[a("el-col",{staticClass:"is-required-a tr-10",staticStyle:{"text-align":"right","line-height":"40px"},attrs:{span:6}},[e._v("确认密码")]),a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"password",placeholder:"请输入新密码",clearable:""},model:{value:e.pwd1,callback:function(t){e.pwd1=t},expression:"pwd1"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.UpUserPwd}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.dialogVisibleupdeta=!1}}},[e._v("取 消")])],1)],1)],1):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.dialogVisibleAdd,expression:"dialogVisibleAdd"}],staticClass:"my-puple"},[a("el-dialog",{attrs:{title:"添加员工",visible:e.dialogVisibleAdd,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"660px"},on:{"update:visible":function(t){e.dialogVisibleAdd=t}}},[a("el-row",[a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("姓名")]),a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入姓名",clearable:""},model:{value:e.sAddStaffName,callback:function(t){e.sAddStaffName=t},expression:"sAddStaffName"}})],1)],1),a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("手机号")]),a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入手机号",clearable:""},model:{value:e.sStaffInfophone,callback:function(t){e.sStaffInfophone=t},expression:"sStaffInfophone"}})],1)],1),a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("用户密码")]),a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入密码例如:1aaa1",type:"password"},model:{value:e.sStaffPwd,callback:function(t){e.sStaffPwd=t},expression:"sStaffPwd"}})],1)],1),a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("角色")]),a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择角色"},model:{value:e.sAddStaffRoleValue,callback:function(t){e.sAddStaffRoleValue=t},expression:"sAddStaffRoleValue"}},e._l(e.aAddStaffRole,function(e){return a("el-option",{key:e.roleId,attrs:{label:e.name,value:e.roleId}})}),1)],1)],1),a("el-row",{staticClass:"each-item"},[a("el-col",{staticClass:"is-required-a",attrs:{span:8}},[e._v("头像")]),a("el-col",{attrs:{span:12}},[a("el-row",[a("el-upload",{attrs:{action:"","before-upload":e.beforeupload,accept:"image",multiple:!1,"show-file-list":!1}},[a("div",{staticClass:"input-pic-box"},[a("el-button",{attrs:{type:"primary"}},[e._v("上传图片(只能上传1张，支持png.jpg，尺寸400*300)")])],1)])],1),e.redactData.headimgUrl?a("div",{staticStyle:{display:"inline-block",position:"relative"}},[a("i",{staticClass:"el-icon-close",staticStyle:{position:"absolute",top:"4px",right:"-10px",display:"inline-block"},on:{click:function(t){return e.removeUploadImgOrigin("add")}}}),a("img",{staticStyle:{"border-radius":"50%","margin-top":"10px"},attrs:{src:e.redactData.headimgUrl,alt:"",width:"120",height:"120"}})]):e._e()],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addStaff}},[e._v("确 定")]),a("el-button",{staticClass:"greenBtn",on:{click:function(t){e.dialogVisibleAdd=!1}}},[e._v("取 消")])],1)],1)],1)])},l=[],i=a("90b9"),r=a("729c"),o={name:"user-setting",data(){return{pwd2:"",pwd1:"",oldpwd3:"",dialogVisibleupdeta:!1,newPassword:"",centerDialogVisible:!1,iLoginPwd:"",dialogVisibleAdd:!1,sStaffInfo:"",sAddStaffName:"",sStaffInfophone:18626487953,aAddStaffRole:[{label:"一级",value:1},{label:"二级",value:2}],sAddStaffRoleValue:"",headImgUrlId:"",sStaffPwd:"",iIfBisable:0,userId:"",redactData:{},pageSize:10,sUploadImgUrl:{thumb_2:""},total:0,value:"",value1:[],tableData:[],currentPage:1,dialogVisible:!1,form:{name:""},param:""}},created(){this.init()},mounted(){},methods:{userAlterPwdConfromInitData(){this.oldpwd3="",this.pwd2="",this.pwd1="",this.dialogVisibleupdeta=!0},removeUploadImgOrigin(e){this.redactData.headimgUrl=""},UpUserPwd(){try{let t=this;if(t.pwd2.length<=0||t.pwd1.length<=0||t.oldpwd3.length<=0)return void t.$message({message:"三项密码不能为空",type:"warning"});if(t.pwd1!=t.pwd2)return void t.$message({message:"两次密码输入不一致",type:"warning"});let a={userId:t.redactData.userId,oldPassword:t.oldpwd3,newPassword:t.pwd1,newPasswordConfirm:t.pwd2};Object(r["C"])(a).then(e=>{e.data.result?(t.$message({message:e.data.message,type:"success"}),t.dialogVisibleupdeta=!1,t.getSysUserPage()):t.$message.error(e.data.message)})}catch(e){console.log(e)}},startUsing(){let e={userId:this.userId};try{Object(r["D"])(e).then(e=>{0===e.data.errorCode&&(this.$message({message:"启用成功",type:"success"}),this.getSysUserPage())})}catch(t){}},alter(){if(!this.redactData.employeeName)return void this.$message({message:"姓名不能为空",type:"warning"});if(!Object(i["c"])(this.redactData.phone))return void this.$message({message:"手机号格式不正确",type:"warning"});if(!this.redactData.headimgUrl)return void this.$message({message:"头像不能为空",type:"warning"});let e={userId:this.userId,employeeName:this.redactData.employeeName,phone:this.redactData.phone,roleId:this.redactData.roleId};this.headImgUrlId&&(e.headImgUrlId=this.headImgUrlId);try{Object(r["B"])(e).then(e=>{0===e.data.errorCode&&(this.$message({message:"编辑成功",type:"success"}),this.getSysUserPage(),this.dialogVisible=!1)})}catch(t){}},getSysUserView(){let e=this,t={userId:e.userId};return Object(r["yb"])(t)},getAllSysRole(){try{Object(r["R"])().then(e=>{this.aAddStaffRole=e.data.data})}catch(e){}},disableSysUser(){this.$confirm("此操作将永久禁用员工, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e={userId:this.userId};Object(r["u"])(e).then(e=>{0===e.data.errorCode?this.$message({message:"禁用成功",type:"success"}):this.$message({message:"禁用失败",type:"success"}),this.getSysUserPage()})}).catch(()=>{})},async cellclick(e,t,a,s){if(this.redactData=JSON.parse(JSON.stringify(e)),this.iIfBisable=e.sysUserStatusEnum.val,this.sAddStaffRoleValue=e.roleId?e.roleId:"",this.userId=e.userId,"禁用"===s.target.innerText)this.disableSysUser();else if("删除"===s.target.innerText)this.deleStaff();else if("编辑"===s.target.innerText){this.headImgUrlId="";let e=await this.getSysUserView();e.data.data.imgFile?this.redactData.headimgUrl=JSON.parse(JSON.stringify(e.data.data.imgFile.thumb_2)):(this.redactData.headimgUrl="",this.headImgUrlId=""),this.editStaffInfo()}else"启用"===s.target.innerText?this.startUsing():"重置密码"===s.target.innerText&&(this.newPassword="",this.centerDialogVisible=!0)},deleStaff(){this.$confirm("此操作将永久删除该员工, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e={userId:this.userId};Object(r["q"])(e).then(e=>{0===e.data.errorCode?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败",type:"success"}),this.getSysUserPage()})}).catch(()=>{})},resetUserPwd(){if(!Object(i["d"])(this.newPassword))return this.$message({message:"新密码格式不正确",type:"warning"}),!1;let e={userId:this.userId,newPassword:this.newPassword};Object(r["Hb"])(e).then(e=>{0===e.data.errorCode&&(this.centerDialogVisible=!1,this.$message({message:"重置成功",type:"success"}))})},addUseradmin(){this.redactData.headimgUrl="",this.dialogVisibleAdd=!0,this.sStaffInfophone="",this.sAddStaffName="",this.sAddStaffRoleValue="",this.sUploadImgUrl={},this.sUploadImgUrl.thumb_2=""},addStaffJudge(){return this.sAddStaffName?Object(i["c"])(this.sStaffInfophone)?Object(i["d"])(this.sStaffPwd)?this.sAddStaffRoleValue?!!this.headImgUrlId||(this.$message({message:"头像不能为空",type:"warning"}),!1):(this.$message({message:"角色不能为空",type:"warning"}),!1):(this.$message({message:"用户密码格式不正确",type:"warning"}),!1):(this.$message({message:"手机号格式不正确",type:"warning"}),!1):(this.$message({message:"姓名不能为空",type:"warning"}),!1)},addStaff(){try{if(!this.addStaffJudge())return;this.iIfBisable=0;let t={employeeName:this.sAddStaffName,password:this.sStaffPwd,headImgUrlId:this.headImgUrlId,phone:this.sStaffInfophone,roleId:this.sAddStaffRoleValue};Object(r["i"])(t).then(e=>{e.data.result?(this.$message({showClose:!0,message:"新增成功",type:"success"}),this.getSysUserPage(),this.dialogVisibleAdd=!1):this.$message({showClose:!0,message:e.data.message,type:"warning"})})}catch(e){}},beforeupload(e){console.log(e);const t=e.size/1024/1024<=3;if(!t)return this.$message({message:"上传图片大小不能超过 3MB!",type:"error"});this.param=new FormData,this.param.append("file",e,e.name);var a=this.form.name;this.param.append("message",a),Object(r["Qb"])(this.param).then(e=>{e.data.result?(this.redactData.headimgUrl=e.data.data.thumb_1,this.sUploadImgUrl=e.data.data,this.headImgUrlId=e.data.data.id):this.$message({showClose:!0,message:e.data.message,type:"warning"})}).catch(e=>{})},editStaffInfo(){this.sAddStaffRoleValue=this.redactData.roleId,this.iIfBisable=this.redactData.state,this.dialogVisible=!0},getSysUserPage(){let e={currentPage:this.currentPage,pageSize:this.pageSize,nameOrPhone:Object(i["m"])(this.sStaffInfo)};try{Object(r["xb"])(e).then(e=>{this.tableData=JSON.parse(JSON.stringify(e.data.data.content)),this.total=e.data.data.total})}catch(t){console.log(t)}},init(){this.getSysUserPage(),this.getAllSysRole()},handleSizeChange(e){this.currentPage=1,this.pageSize=e,this.getSysUserPage(),console.log(`每页 ${e} 条1`)},handleCurrentChange(e){this.currentPage=e,this.getSysUserPage(),console.log(`当前页: ${e}`)},closeActivePuple(){this.dialogVisible=!1}}},n=o,d=(a("0ac2"),a("6691")),c=Object(d["a"])(n,s,l,!1,null,null,null);t["default"]=c.exports}}]);
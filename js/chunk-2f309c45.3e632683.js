(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f309c45"],{"274c":function(e,t,r){},8544:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"reserve-management"},[r("div",{staticClass:"header-condition"},e._l(e.statusList,function(t,s){return r("span",{key:s,class:{"is-active":e.reserveInfo.status==t.val},on:{click:function(r){return e.choiceSearchRoomStatus(t)}}},[e._v(e._s(t.text||"")+"("+e._s(t.count||0)+")")])}),0),r("div",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("reserveTable"),expression:"$authority.indexOf('reserveTable') != '-1'"}],staticClass:"search-list"},[r("el-row",[r("el-col",{attrs:{span:24}},[e._e(),r("el-col",{attrs:{span:6}},[r("el-col",{staticClass:"tr-10",attrs:{span:6}},[e._v("\n                        项目\n                    ")]),r("el-col",{attrs:{span:14}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.searchChangeProject},model:{value:e.reserveInfo.project,callback:function(t){e.$set(e.reserveInfo,"project",t)},expression:"reserveInfo.project"}},e._l(e.projectList,function(e){return r("el-option",{key:e.orgId,attrs:{label:e.orgName,value:e.orgId}})}),1)],1)],1),r("el-col",{attrs:{span:6}},[r("el-col",{staticClass:"tr-10",attrs:{span:6}},[e._v("\n                        房号\n                    ")]),r("el-col",{attrs:{span:14}},[r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reserveInfo.roomNum,callback:function(t){e.$set(e.reserveInfo,"roomNum",t)},expression:"reserveInfo.roomNum"}},e._l(e.roomList,function(e){return r("el-option",{key:e.roomId,attrs:{label:e.roomName,value:e.roomId}})}),1)],1)],1),r("el-col",{attrs:{span:6}},[r("el-col",{staticClass:"tr-10",attrs:{span:6}},[e._v("\n                        户型\n                    ")]),r("el-col",{attrs:{span:14}},[r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reserveInfo.doorType,callback:function(t){e.$set(e.reserveInfo,"doorType",t)},expression:"reserveInfo.doorType"}},e._l(e.apartmentList,function(e){return r("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1)],1),r("el-col",{attrs:{span:6}},[r("el-col",{staticClass:"tr-10",attrs:{span:6}},[e._v("\n                        预定时间\n                    ")]),r("el-col",{attrs:{span:14}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","default-time":["00:00:00","23:59:59"],"end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.reserveInfo.reserveTime,callback:function(t){e.$set(e.reserveInfo,"reserveTime",t)},expression:"reserveInfo.reserveTime"}})],1)],1)],1),r("el-col",{attrs:{span:24}},[r("el-col",{attrs:{span:6}},[r("el-col",{staticClass:"tr-10",attrs:{span:6}},[e._v("\n                        付款方式\n                    ")]),r("el-col",{attrs:{span:14}},[r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reserveInfo.payWay,callback:function(t){e.$set(e.reserveInfo,"payWay",t)},expression:"reserveInfo.payWay"}},e._l(e.roomDeliveryMethod,function(e){return r("el-option",{key:e.val,attrs:{label:e.text,value:e.val}})}),1)],1)],1),r("el-col",{attrs:{span:6}},[r("el-col",{staticClass:"tr-10",staticStyle:{height:"60px",overflow:"hidden"},attrs:{span:6}},[e._v("\n                        承租人信息\n                    ")]),r("el-col",{attrs:{span:14}},[r("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入承租人名称、租客/居住姓名/手机",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getReserveTable(t)}},model:{value:e.reserveInfo.rentPerson,callback:function(t){e.$set(e.reserveInfo,"rentPerson",t)},expression:"reserveInfo.rentPerson"}})],1)],1),r("el-col",{attrs:{span:6,offset:6}},[r("el-col",{staticClass:"disp-right",attrs:{span:20}},[r("el-button",{staticClass:"el-button el-button--primary",on:{click:e.getReserveTable}},[e._v("查询")]),"-1"!=e.$authority.indexOf("reserveExport")?r("el-button",{staticClass:"greenBtn",on:{click:e.exportSearchList}},[e._v("导出")]):e._e()],1)],1)],1)],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:"-1"!=e.$authority.indexOf("reserveTable"),expression:"$authority.indexOf('reserveTable') != '-1'"}],staticClass:"content-table"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.reserveTableData,border:""}},[r("el-table-column",{attrs:{prop:"indexNum",align:"center",label:"序号",width:"80"}}),r("el-table-column",{attrs:{prop:"statusName",align:"center",label:"状态"}}),r("el-table-column",{attrs:{prop:"cityName",align:"center",label:"城市"}}),r("el-table-column",{attrs:{prop:"orgName",align:"center",label:"项目"}}),r("el-table-column",{attrs:{prop:"roomName",align:"center",label:"房号"}}),r("el-table-column",{attrs:{prop:"houseType",align:"center",label:"户型"}}),r("el-table-column",{attrs:{prop:"name",align:"center",label:"联系人"}}),r("el-table-column",{attrs:{prop:"phone",align:"center",label:"住户电话"}}),r("el-table-column",{attrs:{prop:"price",align:"center",label:"租金"}}),r("el-table-column",{attrs:{prop:"deposit",align:"center",label:"押金"}}),r("el-table-column",{attrs:{prop:"reservePrice",align:"center",label:"定金"}}),r("el-table-column",{attrs:{prop:"loseTime",align:"center",label:"定金失效时间"}}),r("el-table-column",{attrs:{prop:"expectTime",align:"center",label:"预计签约时间"}}),r("el-table-column",{attrs:{prop:"createTime",align:"center",label:"预约时间"}}),r("el-table-column",{attrs:{prop:"operator",align:"center",width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status&&"-1"!=e.$authority.indexOf("reserveSigning")?r("span",{staticClass:"greenFont tabOperteBtn",on:{click:function(r){return e.enterCustomerSigning(t.row)}}},[e._v("签约")]):e._e()]}}])})],1)],1),r("div",{staticClass:"el-page"},[r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},a=[],o=r("90b9"),i={name:"reserve-management",data(){return{currentPage:1,reserveInfo:{status:"-1",city:"",project:"",roomNum:"",doorType:"",reserveTime:[],payWay:"",rentPerson:""},cityList:[],projectList:[],roomList:[],apartmentList:[],roomDeliveryMethod:[],statusList:[],currentPage:1,pageSize:10,total:10,reserveTableData:[]}},created(){this.getStoreDataList(),this.getPeojectList(),this.getRoomDeliveryMethod()},watch:{"$store.getters.getRoomNumList"(){this.roomList=this.$store.getters.getRoomNumList||[]},"$store.getters.gettaCity"(){this.cityList=this.$store.getters.gettaCity||[]},"$store.getters.getApartmentLis"(){this.apartmentList=this.$store.getters.getApartmentList||[]},"$store.getters.getStoreEdit.count"(){"project"==this.$store.getters.getStoreEdit.which?this.changeCityChoice():"contract"==this.$store.getters.getStoreEdit.which&&(this.getStatusList(),this.getReserveTable())}},mounted(){},methods:{handleSizeChange(e){this.pageSize=e,this.currentPage=1,this.getReserveTable()},handleCurrentChange(e){this.currentPage=e,this.getReserveTable()},getStoreDataList(){this.cityList=this.$store.getters.gettaCity||[],this.roomList=this.$store.getters.getRoomNumList||[],this.apartmentList=this.$store.getters.getApartmentList||[]},changeCityChoice(){this.reserveInfo.project="",""!=this.reserveInfo.city?this.getPeojectList():this.projectList=[]},getPeojectList(){this.$http.get("/api/reserve/getOrgList").then(e=>{var t=e.data;if(0==t.errorCode){if(this.projectList=t.data||[],this.projectList.length>0){this.projectList.unshift({orgName:"全部",orgId:""}),this.reserveInfo.project=this.projectList[0].orgId;var r=`orgId=${this.reserveInfo.project}&orgType=1`;this.$store.dispatch("getRoomNum",r)}this.getReserveTable(),this.getStatusList()}}).catch(function(e){console.log(e)})},getStatusList(){this.projectList.length>0&&this.$http.get("/api/reserve/status",{params:{orgId:this.reserveInfo.project}}).then(e=>{var t=e.data;0==t.errorCode&&(this.statusList=t.data||[])}).catch(function(e){console.log(e)})},searchChangeProject(){this.reserveInfo.roomNum="";var e=`orgId=${this.reserveInfo.project}&orgType=1`;this.$store.dispatch("getRoomNum",e),this.getStatusList(),this.getReserveTable()},choiceSearchRoomStatus(e){this.reserveInfo.status=e.val,this.currentPage=1,this.getReserveTable()},getRoomDeliveryMethod(){this.$http.get("/api/room/getRoomDeliveryMethod").then(e=>{var t=e.data;0==t.errorCode&&(this.roomDeliveryMethod=t.data)}).catch(function(e){console.log(e)})},exportSearchList(){var e=2==this.reserveInfo.reserveTime.length?this.reserveInfo.reserveTime[0]:"",t=2==this.reserveInfo.reserveTime.length?this.reserveInfo.reserveTime[1]:"",r=this.reserveInfo.rentPerson,s=`./api/reserve/export?cityId=${this.reserveInfo.city}&orgId=${this.reserveInfo.project}&roomId=${this.reserveInfo.roomNum}\n            &roomStructureId=${this.reserveInfo.doorType}&reserveTimeStart=${e}&reserveTimeEnd=${t}\n            &deliveryMethod=${this.reserveInfo.payWay}&status=${this.reserveInfo.status}\n            &nameOrPhone=${r}&currentPage=${this.currentPage}&pageSize=${this.pageSize}`;window.open(s)},getReserveTable(){if(0==this.projectList.length)return this.total=0,void(this.reserveTableData=[]);var e={cityId:this.reserveInfo.city,orgId:this.reserveInfo.project,roomId:this.reserveInfo.roomNum,roomStructureId:this.reserveInfo.doorType,reserveTimeStart:this.reserveInfo.reserveTime&&2==this.reserveInfo.reserveTime.length?this.reserveInfo.reserveTime[0]:"",reserveTimeEnd:this.reserveInfo.reserveTime&&2==this.reserveInfo.reserveTime.length?this.reserveInfo.reserveTime[1]:"",deliveryMethod:this.reserveInfo.payWay,nameOrPhone:Object(o["m"])(this.reserveInfo.rentPerson),status:this.reserveInfo.status,currentPage:this.currentPage,pageSize:this.pageSize};this.$http.get("/api/reserve/page",{params:e}).then(e=>{var t=e.data;if(0==t.errorCode){this.reserveTableData=t.data.content,this.total=t.data.total;for(var r=0;r<this.reserveTableData.length;r++)""!=this.reserveTableData[r].loseTime&&(this.reserveTableData[r].loseTime=this.reserveTableData[r].loseTime.substring(0,10)),""!=this.reserveTableData[r].expectTime&&(this.reserveTableData[r].expectTime=this.reserveTableData[r].expectTime.substring(0,10)),""!=this.reserveTableData[r].createTime&&(this.reserveTableData[r].createTime=this.reserveTableData[r].createTime.substring(0,10)),this.reserveTableData[r].indexNum=Number(this.pageSize)*Number(this.currentPage-1)+Number(1+r)}}).catch(function(e){console.log(e)})},enterCustomerSigning(e){this.$store.commit("setContractMode",{mode:"insert",count:1,contractId:"",roomId:e.roomId,reserveId:e.roomReserveId})}}},n=i,l=(r("c05c"),r("6691")),c=Object(l["a"])(n,s,a,!1,null,null,null);t["default"]=c.exports},c05c:function(e,t,r){"use strict";var s=r("274c"),a=r.n(s);a.a}}]);